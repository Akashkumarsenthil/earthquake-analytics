[0m07:34:42.381217 [info ] [Thread-1 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m07:34:42.383826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m07:34:42.384297 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:34:42.388333 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:34:42.389113 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:34:42.391111 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:34:42.392273 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:34:42.392663 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:42.393054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:42.433418 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m07:34:42.435421 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m07:34:42.606160 [info ] [Thread-4 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.87s]
[0m07:34:42.608009 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:34:42.608813 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:34:42.609621 [info ] [Thread-4 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m07:34:42.610835 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m07:34:42.611560 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:34:42.618872 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:34:42.620176 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:34:42.622821 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:34:42.624207 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:34:42.624721 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:42.625264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:34:42.776904 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m07:34:42.781398 [debug] [Thread-3 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m07:34:42.916798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m07:34:42.921110 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m07:34:42.993423 [info ] [Thread-3 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.66s]
[0m07:34:42.995700 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:34:42.996569 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:34:42.997325 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m07:34:42.998252 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m07:34:42.998906 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:34:43.005021 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:34:43.009036 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:34:43.012898 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:34:43.014501 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:34:43.015105 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:43.015631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:34:43.276038 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m07:34:43.282705 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m07:34:43.458434 [info ] [Thread-4 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.85s]
[0m07:34:43.463275 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:34:43.465711 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:34:43.467584 [info ] [Thread-4 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m07:34:43.470402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m07:34:43.471435 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:34:43.480304 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:34:43.482168 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:34:43.485461 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:34:43.487116 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:34:43.487706 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:43.488293 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:34:43.698892 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.405 seconds
[0m07:34:43.702832 [debug] [Thread-2 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m07:34:43.847924 [info ] [Thread-1 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 1.46s]
[0m07:34:43.851888 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:34:43.929910 [info ] [Thread-2 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 1.65s]
[0m07:34:43.933831 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:34:44.068226 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.052 seconds
[0m07:34:44.073715 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m07:34:44.254519 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.26s]
[0m07:34:44.258911 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:34:44.378853 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m07:34:44.384812 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m07:34:44.559746 [info ] [Thread-4 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.09s]
[0m07:34:44.563054 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:34:44.570701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:44.571274 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m07:34:44.571662 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f' was properly closed.
[0m07:34:44.571997 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m07:34:44.572320 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m07:34:44.572954 [info ] [MainThread]: 
[0m07:34:44.574054 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 7.51 seconds (7.51s).
[0m07:34:44.577322 [debug] [MainThread]: Command end result
[0m07:34:44.721581 [info ] [MainThread]: 
[0m07:34:44.722754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:34:44.723211 [info ] [MainThread]: 
[0m07:34:44.723789 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m07:34:44.725557 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.899655, "process_user_time": 4.632367, "process_kernel_time": 1.98226, "process_mem_max_rss": "268868", "process_out_blocks": "2223", "process_in_blocks": "0"}
[0m07:34:44.726127 [debug] [MainThread]: Command `dbt test` succeeded at 07:34:44.726039 after 8.90 seconds
[0m07:34:44.726595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86a06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda288ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd98b0b30>]}
[0m07:34:44.726964 [debug] [MainThread]: Flushing usage events
[0m07:34:50.046140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb2f4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffba1f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb001880>]}


============================== 07:34:50.066182 | 0f79693b-b4c9-48dd-8a74-5e71f9a8fa87 ==============================
[0m07:34:50.066182 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:34:50.068965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:34:51.956649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd90d2570>]}
[0m07:34:52.028983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb005c10>]}
[0m07:34:52.030662 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:38:21.669006 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:38:21.879423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:21.880559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:21.959656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8367950>]}
[0m07:38:22.162744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e21b50>]}
[0m07:38:22.164032 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m07:38:22.165396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e42000>]}
[0m07:38:22.170272 [info ] [MainThread]: 
[0m07:38:22.172265 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:38:22.182767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m07:38:22.213474 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m07:38:22.214540 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m07:38:22.215468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:23.721592 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.506 seconds
[0m07:38:23.726006 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m07:38:23.911515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m07:38:23.927321 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m07:38:23.928190 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m07:38:23.928868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:24.394980 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.466 seconds
[0m07:38:24.402354 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m07:38:24.590842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd87c8770>]}
[0m07:38:24.593054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:38:24.594832 [info ] [MainThread]: 
[0m07:38:24.609342 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m07:38:24.610574 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m07:38:24.612105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m07:38:24.612646 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m07:38:24.621418 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m07:38:24.622602 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m07:38:24.651069 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m07:38:24.654691 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m07:38:24.655303 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m07:38:24.655964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:25.318135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m07:38:25.357385 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m07:38:25.547292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd832cad0>]}
[0m07:38:25.548986 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m07:38:25.551479 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m07:38:25.554155 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m07:38:25.555195 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m07:38:25.556344 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m07:38:25.556956 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m07:38:25.569205 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m07:38:25.570605 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m07:38:25.599444 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:25.599914 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m07:38:25.600339 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:38:31.663825 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.061 seconds
[0m07:38:31.696579 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:31.697400 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m07:38:32.049151 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.351 seconds
[0m07:38:32.063685 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:32.064866 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m07:38:32.244451 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.178 seconds
[0m07:38:32.274002 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:32.274736 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m07:38:32.693111 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.415 seconds
[0m07:38:32.696763 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:32.697159 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m07:38:32.822240 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.125 seconds
[0m07:38:32.834350 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:38:32.854166 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m07:38:32.855984 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:32.856303 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m07:38:32.996463 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m07:38:32.997377 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:32.998287 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m07:38:34.740082 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.740 seconds
[0m07:38:34.742249 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:34.743379 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m07:38:40.761104 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.016 seconds
[0m07:38:40.775329 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m07:38:40.781790 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:38:40.782232 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m07:38:41.025223 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m07:38:41.032285 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m07:38:41.223722 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd816aa20>]}
[0m07:38:41.227204 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 15.67s]
[0m07:38:41.233665 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m07:38:41.237754 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m07:38:41.239060 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m07:38:41.240441 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m07:38:41.241290 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m07:38:41.242135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m07:38:41.243161 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m07:38:41.244214 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m07:38:41.245023 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m07:38:41.245954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m07:38:41.246771 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m07:38:41.253497 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m07:38:41.254084 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m07:38:41.254629 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m07:38:41.258392 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m07:38:41.263662 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m07:38:41.264846 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m07:38:41.269874 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:41.270476 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m07:38:41.270949 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m07:38:41.271368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:38:41.277420 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m07:38:41.289710 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m07:38:41.293794 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m07:38:41.295352 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m07:38:41.297420 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m07:38:41.297783 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m07:38:41.298283 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m07:38:41.298712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:41.299061 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:38:41.926019 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m07:38:41.934672 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:41.935923 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m07:38:42.082452 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.145 seconds
[0m07:38:42.093713 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:42.094995 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m07:38:42.210224 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.114 seconds
[0m07:38:42.219374 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:42.220361 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m07:38:42.337596 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.116 seconds
[0m07:38:42.348611 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:42.349743 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m07:38:42.450045 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.099 seconds
[0m07:38:42.465282 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:38:42.469132 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m07:38:42.473294 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:42.473965 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m07:38:42.497029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.198 seconds
[0m07:38:42.502012 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m07:38:42.695818 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m07:38:42.697717 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:42.699545 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m07:38:42.712678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3475f40>]}
[0m07:38:42.714275 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.47s]
[0m07:38:42.716618 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m07:38:42.937782 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.639 seconds
[0m07:38:42.939888 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m07:38:43.105284 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3428440>]}
[0m07:38:43.107927 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 1.86s]
[0m07:38:43.111914 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m07:38:44.009002 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.308 seconds
[0m07:38:44.010053 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:44.010638 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m07:38:44.410933 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m07:38:44.422112 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m07:38:44.424407 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:38:44.425299 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m07:38:44.643124 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m07:38:44.649043 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m07:38:44.810457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f79693b-b4c9-48dd-8a74-5e71f9a8fa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2ba0e90>]}
[0m07:38:44.813074 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.57s]
[0m07:38:44.816294 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m07:38:44.820148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:44.820908 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m07:38:44.821465 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m07:38:44.822017 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m07:38:44.822515 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m07:38:44.823883 [info ] [MainThread]: 
[0m07:38:44.825081 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 22.65 seconds (22.65s).
[0m07:38:44.827850 [debug] [MainThread]: Command end result
[0m07:38:44.866035 [info ] [MainThread]: 
[0m07:38:44.866808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:38:44.867151 [info ] [MainThread]: 
[0m07:38:44.867722 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:38:44.870010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.304392, "process_user_time": 6.52672, "process_kernel_time": 2.001567, "process_mem_max_rss": "267396", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m07:38:44.870848 [debug] [MainThread]: Command `dbt run` succeeded at 07:38:44.870716 after 25.31 seconds
[0m07:38:44.871421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb182450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec030b0>]}
[0m07:38:44.871768 [debug] [MainThread]: Flushing usage events
[0m07:38:48.045150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafcfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb3ade20>]}


============================== 07:38:48.053588 | f484e3b9-a12c-4a40-85c9-1aafc619ebaf ==============================
[0m07:38:48.053588 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:38:48.054642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:38:48.888660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f484e3b9-a12c-4a40-85c9-1aafc619ebaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81b2570>]}
[0m07:38:48.923384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f484e3b9-a12c-4a40-85c9-1aafc619ebaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86f8ec0>]}
[0m07:38:48.924065 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:38:48.936738 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:38:49.032087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:49.032593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:49.067836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f484e3b9-a12c-4a40-85c9-1aafc619ebaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e87f50>]}
[0m07:38:49.168592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f484e3b9-a12c-4a40-85c9-1aafc619ebaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da0b00>]}
[0m07:38:49.169195 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m07:38:49.170069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f484e3b9-a12c-4a40-85c9-1aafc619ebaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d875f0>]}
[0m07:38:49.172611 [info ] [MainThread]: 
[0m07:38:49.173415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:38:49.178022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m07:38:49.193290 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m07:38:49.193697 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m07:38:49.194071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:50.642662 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.448 seconds
[0m07:38:50.645354 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m07:38:50.856500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f484e3b9-a12c-4a40-85c9-1aafc619ebaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ea61b0>]}
[0m07:38:50.857503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:38:50.858573 [info ] [MainThread]: 
[0m07:38:50.871219 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:38:50.871856 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:38:50.872363 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:38:50.873009 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m07:38:50.873626 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:38:50.874083 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m07:38:50.874601 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m07:38:50.875241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m07:38:50.875729 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m07:38:50.876435 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m07:38:50.877026 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m07:38:50.877531 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:38:50.878108 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m07:38:50.878555 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:38:50.879017 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:38:50.893422 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:38:50.893152 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m07:38:50.896760 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m07:38:50.899912 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m07:38:50.903338 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m07:38:50.904718 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:38:50.905069 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:38:50.921896 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m07:38:50.922252 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:38:50.922612 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m07:38:50.922994 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:38:50.924555 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m07:38:50.926327 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m07:38:50.926860 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m07:38:50.927528 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m07:38:50.927955 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m07:38:50.928338 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m07:38:50.928743 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:38:50.929279 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m07:38:50.929758 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m07:38:50.930078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:50.931032 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m07:38:50.931811 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m07:38:50.933354 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:38:50.933867 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:38:51.501566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m07:38:51.512416 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m07:38:51.554837 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m07:38:51.556502 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m07:38:51.578461 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m07:38:51.579954 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m07:39:17.202557 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 26.33s]
[0m07:39:17.203834 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:39:17.204400 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:39:17.204967 [info ] [Thread-1 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m07:39:17.205499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m07:39:17.205880 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:39:17.210540 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m07:39:17.211533 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:39:17.213588 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m07:39:17.214646 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m07:39:17.215068 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m07:39:17.215509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:17.239412 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 26.36s]
[0m07:39:17.240075 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:39:17.240503 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:39:17.240893 [info ] [Thread-2 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m07:39:17.241551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m07:39:17.241957 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:39:17.246964 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m07:39:17.247961 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:39:17.249809 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m07:39:17.251239 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m07:39:17.251647 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m07:39:17.252005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:39:17.794731 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m07:39:17.796967 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m07:39:17.958421 [info ] [Thread-2 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.72s]
[0m07:39:17.959592 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:39:17.960059 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:39:17.960491 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m07:39:17.961011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m07:39:17.961349 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:39:17.965382 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m07:39:17.966721 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:39:17.968863 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m07:39:17.969966 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m07:39:17.970355 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m07:39:17.970661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:39:18.456775 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m07:39:18.463887 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m07:39:18.651610 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.69s]
[0m07:39:18.652831 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:39:18.653321 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:39:18.653777 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m07:39:18.654270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m07:39:18.654711 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:39:18.658327 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m07:39:18.659190 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:39:18.661079 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m07:39:18.661973 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m07:39:18.662308 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m07:39:18.662598 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:39:18.770628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.555 seconds
[0m07:39:18.772820 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m07:39:18.969390 [info ] [Thread-1 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 1.76s]
[0m07:39:18.973303 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:39:18.974620 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:39:18.975589 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m07:39:18.977116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m07:39:18.978028 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:39:18.986318 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m07:39:18.992436 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:39:18.995828 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m07:39:18.997347 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m07:39:18.997882 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m07:39:18.998445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:19.673660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m07:39:19.675572 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m07:39:19.677701 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.015 seconds
[0m07:39:19.679443 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m07:39:19.854430 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.20s]
[0m07:39:19.858601 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:39:19.860276 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:39:19.861226 [info ] [Thread-2 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m07:39:19.863111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m07:39:19.864073 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:39:19.873299 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m07:39:19.874960 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:39:19.878207 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m07:39:19.880082 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m07:39:19.880620 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m07:39:19.881150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:39:19.886176 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.91s]
[0m07:39:19.887952 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:39:19.888552 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:39:19.889077 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m07:39:19.889938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m07:39:19.890893 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:39:19.895224 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m07:39:19.896253 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:39:19.898557 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m07:39:19.899562 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m07:39:19.899945 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m07:39:19.900316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:20.477840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m07:39:20.481476 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m07:39:20.488999 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m07:39:20.494698 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m07:39:20.688134 [info ] [Thread-2 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.82s]
[0m07:39:20.690800 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.80s]
[0m07:39:20.693159 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:39:20.694235 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:39:20.695340 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:39:20.696478 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:39:20.697396 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m07:39:20.699313 [info ] [Thread-1 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m07:39:20.700343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m07:39:20.701130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m07:39:20.701773 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:39:20.702449 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:39:20.709951 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m07:39:20.715835 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m07:39:20.717326 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:39:20.717756 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:39:20.720735 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m07:39:20.723129 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m07:39:20.724362 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m07:39:20.724772 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m07:39:20.725391 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m07:39:20.725726 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:39:20.726139 [debug] [Thread-1 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m07:39:20.728116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:21.286333 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m07:39:21.289811 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m07:39:21.292356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m07:39:21.295154 [debug] [Thread-1 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m07:39:22.225838 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 1.52s]
[0m07:39:22.228920 [info ] [Thread-1 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 1.53s]
[0m07:39:22.230696 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:39:22.231941 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:39:22.233036 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:39:22.234009 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:39:22.234798 [info ] [Thread-2 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m07:39:22.235739 [info ] [Thread-1 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m07:39:22.236600 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m07:39:22.237333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m07:39:22.238095 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:39:22.238826 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:39:22.249193 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m07:39:22.253600 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:39:22.254918 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:39:22.255375 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:39:22.259514 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m07:39:22.261742 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:39:22.263116 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m07:39:22.263845 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:39:22.264249 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:39:22.264713 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m07:39:22.265188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:39:22.265589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:22.742704 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m07:39:22.749382 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m07:39:22.924651 [info ] [Thread-2 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.69s]
[0m07:39:22.926508 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:39:22.927390 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:39:22.928193 [info ] [Thread-2 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m07:39:22.929194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m07:39:22.929877 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:39:22.936202 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:39:22.937555 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:39:22.940568 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:39:22.942131 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:39:22.942608 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m07:39:22.943038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:39:23.310650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.045 seconds
[0m07:39:23.316033 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m07:39:23.513604 [info ] [Thread-1 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 1.28s]
[0m07:39:23.517281 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:39:23.518698 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:39:23.520026 [info ] [Thread-1 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m07:39:23.524364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m07:39:23.525937 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:39:23.533687 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:39:23.535353 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:39:23.538673 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:39:23.540566 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:39:23.541237 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:39:23.541809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:25.062204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.520 seconds
[0m07:39:25.068298 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m07:39:25.265217 [info ] [Thread-1 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.74s]
[0m07:39:25.266999 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:39:25.267539 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:39:25.268003 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m07:39:25.268586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m07:39:25.268926 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:39:25.273372 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:39:25.274251 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:39:25.276003 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:39:25.277073 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:39:25.277470 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:39:25.277822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:26.247037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m07:39:26.252789 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m07:39:26.424652 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.16s]
[0m07:39:26.426239 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:39:32.117254 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 41.24s]
[0m07:39:32.118706 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:39:33.167202 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 17.728 seconds
[0m07:39:33.169676 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m07:39:33.333672 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 42.46s]
[0m07:39:33.335852 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:39:39.899893 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 16.957 seconds
[0m07:39:39.904756 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m07:39:40.123324 [info ] [Thread-2 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 17.19s]
[0m07:39:40.127186 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:39:40.135231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:40.136719 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m07:39:40.137653 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m07:39:40.138430 [debug] [MainThread]: Connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c' was properly closed.
[0m07:39:40.139235 [debug] [MainThread]: Connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec' was properly closed.
[0m07:39:40.140613 [info ] [MainThread]: 
[0m07:39:40.141985 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 50.97 seconds (50.97s).
[0m07:39:40.147159 [debug] [MainThread]: Command end result
[0m07:39:40.278887 [info ] [MainThread]: 
[0m07:39:40.279657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:39:40.279987 [info ] [MainThread]: 
[0m07:39:40.280500 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m07:39:40.281972 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 27.773533, "process_user_time": 4.724702, "process_kernel_time": 1.963172, "process_mem_max_rss": "271540", "process_out_blocks": "2223", "process_in_blocks": "0"}
[0m07:39:40.282466 [debug] [MainThread]: Command `dbt test` succeeded at 07:39:40.282383 after 27.77 seconds
[0m07:39:40.282852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86fdf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd854f230>]}
[0m07:39:40.283183 [debug] [MainThread]: Flushing usage events
[0m07:52:55.255326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb0dcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b8a40>]}


============================== 07:52:55.263802 | 6ee15327-9dd9-40d6-bbd6-e3905343f86d ==============================
[0m07:52:55.263802 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:52:55.264582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:52:56.029900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8361df0>]}
[0m07:52:56.060428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8948ec0>]}
[0m07:52:56.061057 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:52:56.073520 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:52:56.156155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:52:56.156672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:52:56.184499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd808bf20>]}
[0m07:52:56.251802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e89670>]}
[0m07:52:56.252267 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m07:52:56.252958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd830dc10>]}
[0m07:52:56.254951 [info ] [MainThread]: 
[0m07:52:56.255806 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:52:56.259529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m07:52:56.269810 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m07:52:56.270119 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m07:52:56.270414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:52:57.291795 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.020 seconds
[0m07:52:57.298372 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m07:52:57.476354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m07:52:57.495391 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m07:52:57.496357 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m07:52:57.497028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:52:58.052580 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.555 seconds
[0m07:52:58.059460 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m07:52:58.242067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1af8c0>]}
[0m07:52:58.244403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:52:58.247679 [info ] [MainThread]: 
[0m07:52:58.265924 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m07:52:58.267253 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m07:52:58.268692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m07:52:58.269304 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m07:52:58.278802 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m07:52:58.279985 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m07:52:58.304598 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m07:52:58.307394 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m07:52:58.307912 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m07:52:58.308418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:52:59.100635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m07:52:59.139391 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m07:52:59.314841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398f50>]}
[0m07:52:59.317226 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.04s]
[0m07:52:59.319753 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m07:52:59.323112 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m07:52:59.325227 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m07:52:59.327014 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m07:52:59.327858 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m07:52:59.341434 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m07:52:59.342909 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m07:52:59.374496 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:52:59.375062 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m07:52:59.375495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:53:01.883493 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.507 seconds
[0m07:53:01.902418 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:01.903488 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m07:53:02.024327 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.120 seconds
[0m07:53:02.032256 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:02.033045 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m07:53:02.157253 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.123 seconds
[0m07:53:02.185450 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:02.186289 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m07:53:02.353092 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.166 seconds
[0m07:53:02.361087 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:02.361934 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m07:53:02.491089 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.128 seconds
[0m07:53:02.500014 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:53:02.518264 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m07:53:02.519879 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:02.520202 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m07:53:02.703618 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m07:53:02.704867 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:02.706051 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m07:53:05.024578 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.317 seconds
[0m07:53:05.027413 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:05.028416 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m07:53:05.528640 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m07:53:05.544407 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m07:53:05.552998 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m07:53:05.553594 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m07:53:05.736180 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m07:53:05.740663 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m07:53:06.015117 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86a0380>]}
[0m07:53:06.017932 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 6.69s]
[0m07:53:06.020064 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m07:53:06.023039 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m07:53:06.024219 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m07:53:06.025063 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m07:53:06.025963 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m07:53:06.027219 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m07:53:06.029116 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m07:53:06.030507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m07:53:06.031687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m07:53:06.032738 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m07:53:06.033553 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m07:53:06.034328 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m07:53:06.035047 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m07:53:06.041836 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m07:53:06.045994 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m07:53:06.051385 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m07:53:06.053317 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m07:53:06.053837 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m07:53:06.054238 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m07:53:06.074070 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m07:53:06.076204 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m07:53:06.080410 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:06.081175 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m07:53:06.081690 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:53:06.083450 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m07:53:06.086035 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m07:53:06.087560 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m07:53:06.088024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:53:06.086793 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m07:53:06.089463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:06.771609 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m07:53:06.780725 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:06.781889 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m07:53:06.896271 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.113 seconds
[0m07:53:06.904740 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:06.905549 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m07:53:07.020333 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.114 seconds
[0m07:53:07.031905 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:07.033069 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m07:53:07.198459 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.164 seconds
[0m07:53:07.208951 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:07.210035 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m07:53:07.341602 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.130 seconds
[0m07:53:07.355133 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:53:07.359819 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m07:53:07.364655 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:07.365388 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m07:53:07.407486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.318 seconds
[0m07:53:07.411551 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m07:53:07.481511 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m07:53:07.486655 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:07.487971 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m07:53:07.570817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34d9be0>]}
[0m07:53:07.573372 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.54s]
[0m07:53:07.575125 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m07:53:07.978783 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.890 seconds
[0m07:53:07.985081 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m07:53:08.150007 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd348df70>]}
[0m07:53:08.151853 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.12s]
[0m07:53:08.153490 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m07:53:08.867011 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.378 seconds
[0m07:53:08.867569 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:08.867976 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m07:53:09.181880 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.313 seconds
[0m07:53:09.190343 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m07:53:09.192322 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m07:53:09.193136 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m07:53:09.415803 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m07:53:09.422323 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m07:53:09.613864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee15327-9dd9-40d6-bbd6-e3905343f86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabed340>]}
[0m07:53:09.616479 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.58s]
[0m07:53:09.618506 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m07:53:09.622636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:09.623521 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m07:53:09.624213 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m07:53:09.624754 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m07:53:09.625275 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m07:53:09.626703 [info ] [MainThread]: 
[0m07:53:09.627714 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 13.37 seconds (13.37s).
[0m07:53:09.630937 [debug] [MainThread]: Command end result
[0m07:53:09.669013 [info ] [MainThread]: 
[0m07:53:09.669809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:53:09.670358 [info ] [MainThread]: 
[0m07:53:09.670988 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:53:09.672746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.459326, "process_user_time": 4.204815, "process_kernel_time": 1.897893, "process_mem_max_rss": "267748", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m07:53:09.673340 [debug] [MainThread]: Command `dbt run` succeeded at 07:53:09.673230 after 14.46 seconds
[0m07:53:09.673767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda26f560>]}
[0m07:53:09.674105 [debug] [MainThread]: Flushing usage events
[0m07:53:13.702701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb933740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb953da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf7fd70>]}


============================== 07:53:13.711283 | 7efa6e08-411c-45a7-9375-db22fea1c644 ==============================
[0m07:53:13.711283 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:53:13.712184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m07:53:14.471284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7efa6e08-411c-45a7-9375-db22fea1c644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa8d6210>]}
[0m07:53:14.504662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7efa6e08-411c-45a7-9375-db22fea1c644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86a13a0>]}
[0m07:53:14.505344 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:53:14.517336 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:53:14.602409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:14.602828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:14.639240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7efa6e08-411c-45a7-9375-db22fea1c644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd82073b0>]}
[0m07:53:14.761589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7efa6e08-411c-45a7-9375-db22fea1c644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da05f0>]}
[0m07:53:14.762322 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m07:53:14.763338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7efa6e08-411c-45a7-9375-db22fea1c644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8060f20>]}
[0m07:53:14.766334 [info ] [MainThread]: 
[0m07:53:14.767286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:53:14.773529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m07:53:14.789367 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m07:53:14.789853 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m07:53:14.790239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:16.045707 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.255 seconds
[0m07:53:16.053786 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m07:53:16.258060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7efa6e08-411c-45a7-9375-db22fea1c644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabc96a0>]}
[0m07:53:16.260269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:53:16.262195 [info ] [MainThread]: 
[0m07:53:16.277514 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:53:16.278354 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:53:16.279018 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:53:16.279761 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m07:53:16.280490 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:53:16.281018 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m07:53:16.281667 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m07:53:16.282499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m07:53:16.283095 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m07:53:16.283932 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m07:53:16.284602 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m07:53:16.285137 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:53:16.285827 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m07:53:16.286400 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:53:16.286908 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:53:16.301838 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m07:53:16.302236 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:53:16.305451 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m07:53:16.308682 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m07:53:16.312780 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m07:53:16.313651 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:53:16.328618 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m07:53:16.328971 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:53:16.329370 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:53:16.331051 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m07:53:16.331406 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:53:16.332994 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m07:53:16.334659 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m07:53:16.335243 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m07:53:16.335908 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m07:53:16.336374 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m07:53:16.336825 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m07:53:16.337357 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m07:53:16.337861 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m07:53:16.338208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:16.338507 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:53:16.338839 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m07:53:16.339190 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m07:53:16.341019 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:53:16.342118 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:53:16.809577 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m07:53:16.837798 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m07:53:16.841090 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m07:53:16.844671 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m07:53:16.860830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m07:53:16.863774 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m07:53:16.913954 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m07:53:16.915894 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m07:53:16.992395 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.71s]
[0m07:53:16.994083 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m07:53:16.995469 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:53:16.996266 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m07:53:16.997070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m07:53:16.998069 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.71s]
[0m07:53:16.998648 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:53:16.999455 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m07:53:17.004499 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m07:53:17.005122 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:53:17.005819 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m07:53:17.006497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m07:53:17.006969 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:53:17.011241 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m07:53:17.011755 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:53:17.014637 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m07:53:17.015440 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:53:17.016249 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.73s]
[0m07:53:17.019476 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m07:53:17.020181 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m07:53:17.020717 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m07:53:17.021271 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m07:53:17.021721 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:53:17.022125 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:53:17.022595 [info ] [Thread-1 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m07:53:17.023273 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m07:53:17.024875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m07:53:17.025477 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m07:53:17.025903 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:53:17.026311 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:53:17.029626 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m07:53:17.031729 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:53:17.033719 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m07:53:17.034634 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m07:53:17.034975 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m07:53:17.035315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:17.081932 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.80s]
[0m07:53:17.082889 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m07:53:17.083364 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:53:17.083775 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m07:53:17.084299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m07:53:17.084681 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:53:17.088291 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m07:53:17.089872 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:53:17.092090 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m07:53:17.093499 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m07:53:17.093877 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m07:53:17.094231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:53:18.520169 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.493 seconds
[0m07:53:18.526764 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m07:53:18.555321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.519 seconds
[0m07:53:18.561612 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m07:53:18.648214 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.553 seconds
[0m07:53:18.654920 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m07:53:18.686130 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 1.68s]
[0m07:53:18.689895 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m07:53:18.691066 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:53:18.691916 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m07:53:18.693264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m07:53:18.693992 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:53:18.701365 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m07:53:18.703202 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:53:18.706272 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m07:53:18.707825 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m07:53:18.708436 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m07:53:18.708915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:53:18.752624 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 1.73s]
[0m07:53:18.755633 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m07:53:18.756775 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:53:18.757754 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m07:53:18.759032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m07:53:18.759703 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:53:18.764757 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m07:53:18.768616 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:53:18.772173 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m07:53:18.777846 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m07:53:18.778462 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m07:53:18.778963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:18.817028 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.73s]
[0m07:53:18.818039 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m07:53:18.818520 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:53:18.818926 [info ] [Thread-2 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m07:53:18.819524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m07:53:18.819950 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:53:18.823596 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m07:53:18.824493 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:53:18.827431 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m07:53:18.828409 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m07:53:18.828817 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m07:53:18.829181 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:53:18.945505 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m07:53:18.947705 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m07:53:19.114393 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 2.12s]
[0m07:53:19.116106 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m07:53:19.116968 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:53:19.117714 [info ] [Thread-3 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m07:53:19.118731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m07:53:19.119427 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:53:19.125083 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m07:53:19.126452 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:53:19.129173 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m07:53:19.130540 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m07:53:19.131083 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m07:53:19.131557 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:53:19.165862 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m07:53:19.168444 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m07:53:19.299040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m07:53:19.302774 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m07:53:19.318548 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m07:53:19.320845 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m07:53:19.337838 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.64s]
[0m07:53:19.338982 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m07:53:19.339560 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:53:19.340044 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m07:53:19.340752 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m07:53:19.341234 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:53:19.345681 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m07:53:19.347602 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:53:19.349983 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m07:53:19.351319 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m07:53:19.351748 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m07:53:19.352160 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:53:19.459521 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.70s]
[0m07:53:19.461223 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m07:53:19.461932 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:53:19.462548 [info ] [Thread-1 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m07:53:19.463546 [info ] [Thread-2 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.64s]
[0m07:53:19.464204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m07:53:19.465001 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m07:53:19.465581 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:53:19.466208 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:53:19.473031 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m07:53:19.473557 [info ] [Thread-2 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m07:53:19.474451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m07:53:19.474941 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:53:19.478632 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:53:19.479240 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:53:19.481379 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m07:53:19.481944 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:53:19.484109 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:53:19.485015 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m07:53:19.485417 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:19.485763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:19.487030 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m07:53:19.487864 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:19.488416 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:53:19.608051 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m07:53:19.610880 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m07:53:19.776111 [info ] [Thread-3 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.66s]
[0m07:53:19.778068 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m07:53:19.779137 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:53:19.780777 [info ] [Thread-3 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m07:53:19.782176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m07:53:19.782886 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:53:19.789866 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:53:19.791292 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:53:19.794017 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:53:19.795491 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m07:53:19.797783 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m07:53:19.800015 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m07:53:19.800856 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:19.801511 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:53:19.886138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m07:53:19.888621 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m07:53:19.997185 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.66s]
[0m07:53:19.998700 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m07:53:19.999422 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:53:20.000024 [info ] [Thread-4 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m07:53:20.000874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m07:53:20.001387 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:53:20.006139 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:53:20.007530 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:53:20.012017 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:53:20.014263 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m07:53:20.014721 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:20.015234 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:53:20.036090 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m07:53:20.038173 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m07:53:20.072520 [info ] [Thread-1 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.61s]
[0m07:53:20.073499 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m07:53:20.073992 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:53:20.074458 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m07:53:20.075183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m07:53:20.075734 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:53:20.079920 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:53:20.081031 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:53:20.083225 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:53:20.084547 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m07:53:20.084939 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:20.085303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:20.402722 [info ] [Thread-2 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.93s]
[0m07:53:20.406425 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m07:53:20.479260 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m07:53:20.483571 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m07:53:20.637675 [info ] [Thread-3 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.85s]
[0m07:53:20.641339 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m07:53:20.725904 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m07:53:20.731861 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m07:53:20.802799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m07:53:20.807626 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m07:53:20.917193 [info ] [Thread-4 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.92s]
[0m07:53:20.918395 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m07:53:21.015233 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.94s]
[0m07:53:21.018062 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m07:53:21.022727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:21.023551 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m07:53:21.024192 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m07:53:21.024771 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m07:53:21.025369 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m07:53:21.026213 [info ] [MainThread]: 
[0m07:53:21.027317 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m07:53:21.031459 [debug] [MainThread]: Command end result
[0m07:53:21.105451 [info ] [MainThread]: 
[0m07:53:21.106247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:53:21.106545 [info ] [MainThread]: 
[0m07:53:21.106925 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m07:53:21.108076 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.4467964, "process_user_time": 4.287672, "process_kernel_time": 1.908751, "process_mem_max_rss": "269216", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m07:53:21.108549 [debug] [MainThread]: Command `dbt test` succeeded at 07:53:21.108466 after 7.45 seconds
[0m07:53:21.108899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb933740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86f9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7edf70>]}
[0m07:53:21.109213 [debug] [MainThread]: Flushing usage events
[0m08:09:54.085160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb6fdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78f5c0>]}


============================== 08:09:54.093817 | 0e6df212-596d-4aa1-940a-cd890a36a0d8 ==============================
[0m08:09:54.093817 [info ] [MainThread]: Running with dbt=1.8.8
[0m08:09:54.094622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:09:54.862413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabaa570>]}
[0m08:09:54.891670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839f7a0>]}
[0m08:09:54.892292 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:09:54.904056 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m08:09:54.986814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:09:54.987249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:09:55.014527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8fc4f20>]}
[0m08:09:55.079854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e89550>]}
[0m08:09:55.080379 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m08:09:55.080986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbaf2810>]}
[0m08:09:55.083193 [info ] [MainThread]: 
[0m08:09:55.083797 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:09:55.087382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m08:09:55.097906 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m08:09:55.098280 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m08:09:55.098602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:56.260405 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.161 seconds
[0m08:09:56.264886 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m08:09:56.505419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m08:09:56.524175 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m08:09:56.524879 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m08:09:56.525427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:09:57.791033 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.265 seconds
[0m08:09:57.795387 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m08:09:58.032679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8849a00>]}
[0m08:09:58.033905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:09:58.035669 [info ] [MainThread]: 
[0m08:09:58.050087 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m08:09:58.051067 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m08:09:58.052120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m08:09:58.052646 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m08:09:58.060778 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m08:09:58.062544 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m08:09:58.085647 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m08:09:58.088148 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m08:09:58.088659 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m08:09:58.089149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:09:59.071401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m08:09:59.109977 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m08:09:59.322972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839cd40>]}
[0m08:09:59.325306 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.27s]
[0m08:09:59.327254 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m08:09:59.330252 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m08:09:59.331715 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m08:09:59.333753 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m08:09:59.334823 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m08:09:59.348996 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m08:09:59.351372 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m08:09:59.382435 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:09:59.383000 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m08:09:59.383487 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:10:00.159067 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m08:10:00.172718 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:00.173436 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m08:10:00.334520 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.160 seconds
[0m08:10:00.344075 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:00.344857 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m08:10:14.946986 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 14.601 seconds
[0m08:10:14.970574 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:14.971282 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m08:10:15.123150 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.151 seconds
[0m08:10:15.134909 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:15.135998 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m08:10:17.310923 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 2.173 seconds
[0m08:10:17.339126 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:10:17.368746 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m08:10:17.370849 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:17.371275 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m08:10:17.553239 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m08:10:17.554651 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:17.555603 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m08:10:20.086546 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.529 seconds
[0m08:10:20.088754 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:20.089746 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m08:10:20.479043 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m08:10:20.500809 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m08:10:20.510816 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m08:10:20.511534 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m08:10:20.707856 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m08:10:20.714610 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m08:10:20.967789 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3499d90>]}
[0m08:10:20.969738 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 21.63s]
[0m08:10:20.971935 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m08:10:20.974403 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m08:10:20.975258 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m08:10:20.975985 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m08:10:20.976795 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m08:10:20.977663 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m08:10:20.978701 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m08:10:20.979639 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m08:10:20.980359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m08:10:20.981065 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m08:10:20.981722 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m08:10:20.982327 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m08:10:20.982882 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m08:10:20.987994 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m08:10:20.992349 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m08:10:20.995581 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m08:10:20.996962 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m08:10:20.997441 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m08:10:20.997849 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m08:10:21.020195 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:10:21.020669 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m08:10:21.022569 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m08:10:21.023018 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m08:10:21.023908 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:10:21.025760 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m08:10:21.026834 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m08:10:21.029024 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m08:10:21.029352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:21.029814 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m08:10:21.031373 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:28:38.604062 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m08:28:38.607028 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:38.607476 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m08:28:38.757657 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.150 seconds
[0m08:28:38.761092 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:38.761783 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m08:28:38.988559 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.226 seconds
[0m08:28:38.992551 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:38.993012 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m08:28:39.127485 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.134 seconds
[0m08:28:39.131418 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:39.131941 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m08:28:39.224552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.360 seconds
[0m08:28:39.226730 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m08:28:39.254214 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.122 seconds
[0m08:28:39.257874 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:28:39.259485 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m08:28:39.261679 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:39.262015 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m08:28:41.625742 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.363 seconds
[0m08:28:41.628116 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:41.630017 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m08:28:43.535560 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.903 seconds
[0m08:28:43.537305 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:43.538307 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m08:28:43.977111 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m08:28:43.982769 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m08:28:43.984391 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m08:28:43.985012 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m08:28:44.136173 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m08:28:44.142516 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m08:28:44.379262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd02036b0>]}
[0m08:28:44.382029 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 1103.40s]
[0m08:28:44.384030 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m08:28:55.118247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3307e30>]}
[0m08:28:55.119719 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1114.14s]
[0m08:28:55.120812 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m08:28:55.195197 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 17.329 seconds
[0m08:28:55.197457 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m08:28:55.405288 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6df212-596d-4aa1-940a-cd890a36a0d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3306e10>]}
[0m08:28:55.406833 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 1114.42s]
[0m08:28:55.408174 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m08:28:55.411234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:28:55.411879 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m08:28:55.412441 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m08:28:55.412987 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m08:28:55.413482 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m08:28:55.414403 [info ] [MainThread]: 
[0m08:28:55.414961 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 19 minutes and 0.33 seconds (1140.33s).
[0m08:28:55.417151 [debug] [MainThread]: Command end result
[0m08:28:55.451245 [info ] [MainThread]: 
[0m08:28:55.451988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:28:55.452461 [info ] [MainThread]: 
[0m08:28:55.453070 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:28:55.454679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 44.576283, "process_user_time": 4.304923, "process_kernel_time": 1.954059, "process_mem_max_rss": "271212", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m08:28:55.455278 [debug] [MainThread]: Command `dbt run` succeeded at 08:28:55.455182 after 44.58 seconds
[0m08:28:55.455687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb20ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb20c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb846240>]}
[0m08:28:55.456012 [debug] [MainThread]: Flushing usage events
[0m08:28:59.223254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7f96a0>]}


============================== 08:28:59.239439 | 2992d2b5-20e9-498d-82bb-4b1226220766 ==============================
[0m08:28:59.239439 [info ] [MainThread]: Running with dbt=1.8.8
[0m08:28:59.241550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:29:00.300459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2992d2b5-20e9-498d-82bb-4b1226220766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb990e90>]}
[0m08:29:00.329127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2992d2b5-20e9-498d-82bb-4b1226220766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839ba40>]}
[0m08:29:00.329735 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:29:00.342297 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m08:29:00.425698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:29:00.426145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:29:00.454055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2992d2b5-20e9-498d-82bb-4b1226220766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd809d760>]}
[0m08:29:00.530365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2992d2b5-20e9-498d-82bb-4b1226220766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da0e00>]}
[0m08:29:00.530848 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m08:29:00.531472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2992d2b5-20e9-498d-82bb-4b1226220766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ec3560>]}
[0m08:29:00.533500 [info ] [MainThread]: 
[0m08:29:00.534137 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:29:00.538203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m08:29:00.549595 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m08:29:00.549959 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m08:29:00.550265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:05.805614 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m08:39:05.811332 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m08:39:05.812932 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m08:39:05.813429 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m08:39:05.814774 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: No close available on handle
[0m08:39:05.818449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:05.819159 [debug] [MainThread]: Connection 'list_USER_DB_PLATYPUS_ANALYTICS' was properly closed.
[0m08:39:05.823593 [info ] [MainThread]: 
[0m08:39:05.824810 [info ] [MainThread]: Finished running  in 0 hours 10 minutes and 5.29 seconds (605.29s).
[0m08:39:05.828425 [error] [MainThread]: Encountered an error:
Database Error
  250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m08:39:05.835621 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 17.275871, "process_user_time": 3.690876, "process_kernel_time": 1.876937, "process_mem_max_rss": "261796", "process_out_blocks": "1082", "command_success": false, "process_in_blocks": "0"}
[0m08:39:05.837236 [debug] [MainThread]: Command `dbt test` failed at 08:39:05.836968 after 17.28 seconds
[0m08:39:05.838871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3de7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3eaac90>]}
[0m08:39:05.840487 [debug] [MainThread]: Flushing usage events
[0m08:39:07.083462 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:43:34.872215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaba6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaba6c60>]}


============================== 09:43:34.882201 | 40665118-0bf4-4503-9fc4-382eee468804 ==============================
[0m09:43:34.882201 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:43:34.883278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m09:43:35.692246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40665118-0bf4-4503-9fc4-382eee468804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd848b8f0>]}
[0m09:43:35.721383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40665118-0bf4-4503-9fc4-382eee468804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbcb6090>]}
[0m09:43:35.721993 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:43:35.734721 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:43:35.814791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:35.815247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:35.844005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40665118-0bf4-4503-9fc4-382eee468804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd820bef0>]}
[0m09:43:35.928366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40665118-0bf4-4503-9fc4-382eee468804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da0f20>]}
[0m09:43:35.929005 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m09:43:35.929810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40665118-0bf4-4503-9fc4-382eee468804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd809a8a0>]}
[0m09:43:35.932355 [info ] [MainThread]: 
[0m09:43:35.933602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:43:35.938793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m09:43:35.954129 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m09:43:35.954759 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m09:43:35.955266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:41.212281 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 5.256 seconds
[0m09:43:41.221409 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m09:43:41.408247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40665118-0bf4-4503-9fc4-382eee468804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da12e0>]}
[0m09:43:41.409805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:43:41.412646 [info ] [MainThread]: 
[0m09:43:41.425324 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m09:43:41.425965 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m09:43:41.426515 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m09:43:41.427126 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m09:43:41.427752 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m09:43:41.428256 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m09:43:41.428875 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m09:43:41.429560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m09:43:41.430072 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m09:43:41.430749 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m09:43:41.431346 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m09:43:41.431802 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m09:43:41.432358 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m09:43:41.432825 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m09:43:41.433240 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m09:43:41.446819 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m09:43:41.449166 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m09:43:41.452259 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m09:43:41.455363 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m09:43:41.458859 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m09:43:41.460204 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m09:43:41.460556 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m09:43:41.473086 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m09:43:41.473430 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m09:43:41.477507 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m09:43:41.478473 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m09:43:41.480136 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m09:43:41.481808 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m09:43:41.483225 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m09:43:41.483726 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m09:43:41.484096 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m09:43:41.484690 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m09:43:41.484983 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m09:43:41.485454 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m09:43:41.485769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:41.486096 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m09:43:41.486415 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:43:41.486758 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m09:43:41.487806 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:43:41.490005 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:43:42.131780 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m09:43:42.145162 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m09:43:42.148025 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m09:43:42.150222 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m09:43:42.324609 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.89s]
[0m09:43:42.327156 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m09:43:42.328554 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m09:43:42.330107 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m09:43:42.332447 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m09:43:42.333561 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m09:43:42.335265 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.90s]
[0m09:43:42.340485 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m09:43:42.341094 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m09:43:42.341790 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m09:43:42.342347 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m09:43:42.343213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m09:43:42.343601 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m09:43:42.343952 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m09:43:42.345949 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m09:43:42.348999 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m09:43:42.350235 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m09:43:42.350627 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m09:43:42.350975 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m09:43:42.353891 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m09:43:42.354508 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:43:42.357422 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m09:43:42.357881 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m09:43:42.360625 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:43:42.499949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.014 seconds
[0m09:43:42.504221 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m09:43:42.602242 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.116 seconds
[0m09:43:42.603997 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m09:43:42.784236 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 1.35s]
[0m09:43:42.784920 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m09:43:42.785739 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m09:43:42.786194 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m09:43:42.786796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m09:43:42.787484 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 1.36s]
[0m09:43:42.787866 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m09:43:42.788416 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m09:43:42.791819 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m09:43:42.792851 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m09:43:42.793269 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m09:43:42.795172 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m09:43:42.795589 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m09:43:42.796951 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m09:43:42.797678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m09:43:42.799881 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m09:43:42.800327 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m09:43:42.803499 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m09:43:42.804346 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m09:43:42.804737 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m09:43:42.805134 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m09:43:42.805436 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:43:42.807374 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m09:43:42.809758 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m09:43:42.810144 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m09:43:42.810499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:42.827049 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m09:43:42.828752 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m09:43:42.979136 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.64s]
[0m09:43:42.981253 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m09:43:42.984029 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m09:43:42.990315 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m09:43:42.994292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m09:43:42.995516 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m09:43:43.004866 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m09:43:43.009212 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m09:43:43.010097 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.68s]
[0m09:43:43.012385 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m09:43:43.013024 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m09:43:43.013670 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m09:43:43.014112 [info ] [Thread-3 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m09:43:43.014709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m09:43:43.015131 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m09:43:43.018564 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m09:43:43.019219 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m09:43:43.019730 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m09:43:43.020085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:43:43.021729 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m09:43:43.023770 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m09:43:43.024769 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m09:43:43.025182 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m09:43:43.025665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:43:43.365110 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m09:43:43.371580 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m09:43:44.156603 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 1.37s]
[0m09:43:44.157374 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m09:43:44.157915 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m09:43:44.158358 [info ] [Thread-2 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m09:43:44.158993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m09:43:44.159386 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m09:43:44.163746 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m09:43:44.164632 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m09:43:44.166267 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m09:43:44.167091 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m09:43:44.167404 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m09:43:44.167723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:43:44.203769 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.178 seconds
[0m09:43:44.205426 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m09:43:44.262246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.452 seconds
[0m09:43:44.264126 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m09:43:44.448490 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.65s]
[0m09:43:44.451496 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m09:43:44.453031 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m09:43:44.454297 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m09:43:44.456154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m09:43:44.457233 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m09:43:44.466552 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m09:43:44.468652 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m09:43:44.472266 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m09:43:44.474043 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m09:43:44.474716 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m09:43:44.475390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:44.590940 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.570 seconds
[0m09:43:44.596002 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m09:43:44.775537 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 1.78s]
[0m09:43:44.777854 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m09:43:44.778763 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m09:43:44.779573 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m09:43:44.780804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m09:43:44.781596 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m09:43:44.788398 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m09:43:44.790930 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m09:43:44.794018 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m09:43:44.795533 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m09:43:44.796063 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m09:43:44.796551 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:43:45.776892 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m09:43:45.783485 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m09:43:45.794947 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.627 seconds
[0m09:43:45.799247 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m09:43:45.832193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.357 seconds
[0m09:43:45.835790 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m09:43:45.966410 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 1.18s]
[0m09:43:45.968939 [info ] [Thread-2 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 1.81s]
[0m09:43:45.971017 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m09:43:45.972338 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m09:43:45.973475 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m09:43:45.974529 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m09:43:45.975512 [info ] [Thread-4 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m09:43:45.976828 [info ] [Thread-2 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m09:43:45.978194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m09:43:45.979434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m09:43:45.980380 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m09:43:45.981198 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m09:43:45.992141 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m09:43:45.997066 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m09:43:45.998759 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m09:43:45.999258 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m09:43:46.001963 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m09:43:46.004094 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 1.55s]
[0m09:43:46.006753 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m09:43:46.007716 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m09:43:46.008517 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m09:43:46.009205 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m09:43:46.010144 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m09:43:46.010642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m09:43:46.011198 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m09:43:46.011971 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m09:43:46.012410 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m09:43:46.012858 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:43:46.013337 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:43:46.017039 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m09:43:46.018526 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:43:46.020626 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m09:43:46.023880 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m09:43:46.025319 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m09:43:46.025774 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m09:43:46.026234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:46.441253 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m09:43:46.445679 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m09:43:46.637542 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m09:43:46.640973 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m09:43:46.869424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m09:43:46.874567 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m09:43:47.087326 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 1.08s]
[0m09:43:47.090990 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m09:43:47.092485 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m09:43:47.093666 [info ] [Thread-1 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m09:43:47.095538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m09:43:47.096559 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m09:43:47.105214 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m09:43:47.107148 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m09:43:47.110783 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m09:43:47.112887 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m09:43:47.113565 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:43:47.114160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:49.926167 [info ] [Thread-3 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 6.91s]
[0m09:43:49.929559 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m09:43:49.931868 [info ] [Thread-2 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 3.95s]
[0m09:43:49.933239 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m09:43:49.934838 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m09:43:49.935858 [info ] [Thread-3 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m09:43:49.938194 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m09:43:49.939611 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m09:43:49.947244 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m09:43:49.949049 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m09:43:49.952360 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m09:43:49.954234 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m09:43:49.954929 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:43:49.955598 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:43:49.976819 [info ] [Thread-4 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 4.00s]
[0m09:43:49.978535 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:20:45.464841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf81ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf83a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf80350>]}


============================== 10:20:45.477023 | 3f436acf-27c1-4a10-9f7a-372b1e229b17 ==============================
[0m10:20:45.477023 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:20:45.477976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:45.852941 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 16.912 seconds
[0m10:20:45.857408 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m10:20:45.912998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 19.813 seconds
[0m10:20:45.916667 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m10:20:46.082804 [info ] [Thread-1 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 2218.99s]
[0m10:20:46.086224 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:20:46.087539 [info ] [Thread-3 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 2216.15s]
[0m10:20:46.089127 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:20:46.093206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:46.093852 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m10:20:46.094426 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m10:20:46.094976 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m10:20:46.095495 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6' was properly closed.
[0m10:20:46.096293 [info ] [MainThread]: 
[0m10:20:46.097415 [info ] [MainThread]: Finished running 18 data tests in 0 hours 37 minutes and 10.16 seconds (2230.16s).
[0m10:20:46.102476 [debug] [MainThread]: Command end result
[0m10:20:46.260060 [info ] [MainThread]: 
[0m10:20:46.261621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:46.262314 [info ] [MainThread]: 
[0m10:20:46.263222 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m10:20:46.265773 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 32.45148, "process_user_time": 5.476254, "process_kernel_time": 1.990047, "process_mem_max_rss": "270320", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m10:20:46.266734 [debug] [MainThread]: Command `dbt test` succeeded at 10:20:46.266568 after 32.45 seconds
[0m10:20:46.267544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1a4dd0>]}
[0m10:20:46.268417 [debug] [MainThread]: Flushing usage events
[0m10:20:46.998323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe03c85c0>]}
[0m10:20:47.092156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd830fb90>]}
[0m10:20:47.094145 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:20:47.128813 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:20:47.338959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:47.339955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:47.374339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd820b800>]}
[0m10:20:47.450101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e89610>]}
[0m10:20:47.450784 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m10:20:47.451308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8475a00>]}
[0m10:20:47.453310 [info ] [MainThread]: 
[0m10:20:47.453946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:20:47.457751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m10:20:47.469839 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m10:20:47.470319 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m10:20:47.470598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:48.490969 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.020 seconds
[0m10:20:48.495556 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m10:20:48.663826 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m10:20:48.682614 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m10:20:48.683403 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m10:20:48.684139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:51.728619 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 3.044 seconds
[0m10:20:51.740967 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m10:20:51.948373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd349b590>]}
[0m10:20:51.951353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:20:51.952762 [info ] [MainThread]: 
[0m10:20:51.979097 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m10:20:51.980350 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m10:20:51.981963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m10:20:51.982469 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m10:20:51.991876 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m10:20:51.993011 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m10:20:52.016990 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m10:20:52.019792 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m10:20:52.020621 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m10:20:52.021072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:52.804698 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m10:20:52.839647 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m10:20:53.032588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd349bad0>]}
[0m10:20:53.034349 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.05s]
[0m10:20:53.037822 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m10:20:53.040225 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m10:20:53.041627 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m10:20:53.043154 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m10:20:53.043778 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m10:20:53.056490 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m10:20:53.058006 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m10:20:53.093756 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:53.094369 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m10:20:53.094925 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:20:53.948011 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m10:20:53.956999 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:53.957522 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:20:54.092595 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.134 seconds
[0m10:20:54.102085 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:54.102969 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m10:20:54.224033 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.120 seconds
[0m10:20:54.254272 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:54.255058 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:20:54.393788 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.138 seconds
[0m10:20:54.404077 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:54.405095 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m10:20:54.539002 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.133 seconds
[0m10:20:54.560415 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:20:54.588047 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m10:20:54.589926 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:54.590317 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m10:20:54.753536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m10:20:54.754942 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:54.755893 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m10:20:57.433856 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.676 seconds
[0m10:20:57.435722 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:57.436631 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m10:20:57.774449 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m10:20:57.791373 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:20:57.800255 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:20:57.800898 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m10:20:57.960178 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m10:20:57.964164 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m10:20:58.151663 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2a17cb0>]}
[0m10:20:58.154006 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 5.11s]
[0m10:20:58.156962 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m10:20:58.159747 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m10:20:58.160799 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m10:20:58.161706 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m10:20:58.162756 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m10:20:58.164638 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m10:20:58.166061 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m10:20:58.167516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m10:20:58.168570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m10:20:58.169640 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m10:20:58.170452 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m10:20:58.171262 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m10:20:58.172036 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m10:20:58.178383 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m10:20:58.183419 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:20:58.187332 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m10:20:58.189102 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m10:20:58.189643 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m10:20:58.190122 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m10:20:58.213593 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:20:58.209697 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:20:58.215831 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m10:20:58.216332 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m10:20:58.217148 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:58.218796 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:20:58.219344 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m10:20:58.220433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:58.223096 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m10:20:58.224201 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m10:20:58.224845 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:20:59.625738 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.408 seconds
[0m10:20:59.633166 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:20:59.634317 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:20:59.790921 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.155 seconds
[0m10:20:59.802520 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:20:59.803967 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m10:21:00.396135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.175 seconds
[0m10:21:00.403254 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m10:21:00.880003 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 1.075 seconds
[0m10:21:00.886444 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:21:00.887074 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:21:00.985658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2a656a0>]}
[0m10:21:00.987698 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.82s]
[0m10:21:00.991614 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m10:21:01.006199 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.118 seconds
[0m10:21:01.014122 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:21:01.015050 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m10:21:01.124221 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.108 seconds
[0m10:21:01.132796 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:21:01.135805 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m10:21:01.139515 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:21:01.140051 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m10:21:01.294375 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m10:21:01.297957 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:21:01.299257 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m10:21:02.835888 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.535 seconds
[0m10:21:02.837724 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:21:02.838618 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m10:21:03.343561 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m10:21:03.352524 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:21:03.355276 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:21:03.356210 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m10:21:03.502484 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m10:21:03.504349 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m10:21:03.738507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f436acf-27c1-4a10-9f7a-372b1e229b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2af6f90>]}
[0m10:21:03.739303 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 5.57s]
[0m10:21:03.740645 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m10:44:38.751858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb756f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc595250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb755e20>]}


============================== 10:44:38.762091 | 891b90b6-cd89-4ecf-8995-6fc3d72ce26f ==============================
[0m10:44:38.762091 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:44:38.763103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m10:44:40.099530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8ad1f70>]}
[0m10:44:40.133331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1718e0>]}
[0m10:44:40.134265 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:44:40.148233 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:44:40.242991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:40.243588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:40.275274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd80560f0>]}
[0m10:44:40.358104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ea5790>]}
[0m10:44:40.358725 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m10:44:40.359143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb97c080>]}
[0m10:44:40.361402 [info ] [MainThread]: 
[0m10:44:40.362340 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:44:40.366353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m10:44:40.378812 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m10:44:40.379301 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m10:44:40.379678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:41.484401 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.104 seconds
[0m10:44:41.488642 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m10:44:41.694231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m10:44:41.701113 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m10:44:41.701528 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m10:44:41.701824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:42.253028 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.551 seconds
[0m10:44:42.255214 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m10:44:42.447584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ebc0b0>]}
[0m10:44:42.449258 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:42.451265 [info ] [MainThread]: 
[0m10:44:42.461059 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m10:44:42.461741 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m10:44:42.462617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m10:44:42.463035 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m10:44:42.469579 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m10:44:42.470511 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m10:44:42.495137 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m10:44:42.498204 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m10:44:42.498779 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m10:44:42.499316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:44.414583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.915 seconds
[0m10:44:44.442261 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m10:44:44.628290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd83990a0>]}
[0m10:44:44.629127 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 2.16s]
[0m10:44:44.630001 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m10:44:44.631014 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m10:44:44.631680 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m10:44:44.632339 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m10:44:44.632750 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m10:44:44.639765 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m10:44:44.640769 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m10:44:44.666264 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:44.666798 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m10:44:44.667206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:44:45.441807 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m10:44:45.458057 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:45.458618 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:44:45.582771 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.124 seconds
[0m10:44:45.592948 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:45.594189 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m10:44:45.701198 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.106 seconds
[0m10:44:45.716392 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:45.716915 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:44:45.835766 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.118 seconds
[0m10:44:45.844622 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:45.845624 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m10:44:46.006643 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.160 seconds
[0m10:44:46.025240 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:44:46.045702 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m10:44:46.047573 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:46.047994 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m10:44:46.233361 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m10:44:46.235269 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:46.236730 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m10:44:47.579408 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.341 seconds
[0m10:44:47.581619 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:47.582791 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m10:44:47.968153 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m10:44:47.986584 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:44:47.995747 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:44:47.997148 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m10:44:48.239656 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m10:44:48.246913 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m10:44:48.636250 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd83990a0>]}
[0m10:44:48.638368 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 4.00s]
[0m10:44:48.640472 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m10:44:48.643720 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m10:44:48.645223 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m10:44:48.646456 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m10:44:48.647820 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m10:44:48.649062 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m10:44:48.649886 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m10:44:48.650564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m10:44:48.651100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m10:44:48.651694 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m10:44:48.652172 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m10:44:48.652580 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m10:44:48.653011 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m10:44:48.656663 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m10:44:48.659309 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:44:48.662878 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m10:44:48.664045 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m10:44:48.664403 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m10:44:48.668197 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:48.668541 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m10:44:48.681339 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m10:44:48.687339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:48.686864 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m10:44:48.684645 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:44:48.690796 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:44:48.691308 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m10:44:48.693852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:48.693540 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m10:44:48.695753 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m10:44:48.696433 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:44:49.810036 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.123 seconds
[0m10:44:49.812499 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:49.812938 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:44:49.968459 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.155 seconds
[0m10:44:49.975757 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:49.976636 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m10:44:50.146347 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.168 seconds
[0m10:44:50.160349 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:50.162016 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:44:50.418500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.724 seconds
[0m10:44:50.430394 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.267 seconds
[0m10:44:50.431971 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m10:44:50.440610 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:50.442994 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m10:44:50.594255 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.150 seconds
[0m10:44:50.602715 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:44:50.605905 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m10:44:50.609347 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:50.610029 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m10:44:50.774395 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m10:44:50.777096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3dca2d0>]}
[0m10:44:50.782209 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.13s]
[0m10:44:50.780320 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:50.785640 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m10:44:50.784046 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m10:44:50.779380 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.083 seconds
[0m10:44:50.793171 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m10:44:51.029179 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3db9580>]}
[0m10:44:51.030515 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.38s]
[0m10:44:51.031807 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m10:44:51.933218 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.146 seconds
[0m10:44:51.934568 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:51.935586 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m10:44:52.521636 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m10:44:52.533516 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:44:52.536286 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:44:52.538151 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m10:44:52.698977 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m10:44:52.703720 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m10:44:52.978950 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891b90b6-cd89-4ecf-8995-6fc3d72ce26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b07020>]}
[0m10:44:52.980481 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 4.33s]
[0m10:44:52.982036 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m10:44:52.985052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:52.985982 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m10:44:52.986675 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m10:44:52.987305 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m10:44:52.987936 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m10:44:52.988998 [info ] [MainThread]: 
[0m10:44:52.989782 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 12.63 seconds (12.63s).
[0m10:44:52.992251 [debug] [MainThread]: Command end result
[0m10:44:53.016368 [info ] [MainThread]: 
[0m10:44:53.016861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:53.017407 [info ] [MainThread]: 
[0m10:44:53.017822 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:44:53.019161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.311018, "process_user_time": 5.00624, "process_kernel_time": 1.570011, "process_mem_max_rss": "268188", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m10:44:53.019726 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:53.019599 after 14.31 seconds
[0m10:44:53.020138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd97c28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1dbb00>]}
[0m10:44:53.020457 [debug] [MainThread]: Flushing usage events
[0m10:44:56.667217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb0078f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb3d6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b87a0>]}


============================== 10:44:56.675706 | 46f3e351-b0d2-4428-a137-2ee69667de6e ==============================
[0m10:44:56.675706 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:44:56.676462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:44:57.447305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46f3e351-b0d2-4428-a137-2ee69667de6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffac1e990>]}
[0m10:44:57.476640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46f3e351-b0d2-4428-a137-2ee69667de6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe7ea20>]}
[0m10:44:57.477227 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:44:57.488531 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:44:57.563853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:57.564261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:57.591966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f3e351-b0d2-4428-a137-2ee69667de6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8226330>]}
[0m10:44:57.666266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f3e351-b0d2-4428-a137-2ee69667de6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d39640>]}
[0m10:44:57.666745 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m10:44:57.667047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f3e351-b0d2-4428-a137-2ee69667de6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8197e00>]}
[0m10:44:57.669033 [info ] [MainThread]: 
[0m10:44:57.669590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:44:57.673294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m10:44:57.685108 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m10:44:57.685433 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m10:44:57.685751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:58.760272 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.074 seconds
[0m10:44:58.764517 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m10:44:58.964057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f3e351-b0d2-4428-a137-2ee69667de6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5ad100>]}
[0m10:44:58.966239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:58.967883 [info ] [MainThread]: 
[0m10:44:58.985793 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:44:58.986736 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:44:58.987442 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:44:58.988307 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m10:44:58.989036 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:44:58.989613 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m10:44:58.990706 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m10:44:58.991693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m10:44:58.992438 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m10:44:58.993258 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m10:44:58.993991 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m10:44:58.994511 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:44:58.995090 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m10:44:58.995549 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:44:58.996057 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:44:59.012474 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m10:44:59.012852 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:44:59.016315 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m10:44:59.019337 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m10:44:59.023105 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m10:44:59.023976 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:44:59.038946 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m10:44:59.039553 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:44:59.039913 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:44:59.041509 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m10:44:59.041800 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:44:59.043436 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m10:44:59.044159 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m10:44:59.045837 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m10:44:59.046524 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m10:44:59.046896 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m10:44:59.047382 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m10:44:59.047991 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m10:44:59.048268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:59.048760 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m10:44:59.049040 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:44:59.049338 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m10:44:59.050959 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m10:44:59.052652 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:44:59.053164 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:44:59.511992 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m10:44:59.537809 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m10:44:59.541132 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m10:44:59.544816 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m10:44:59.573857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m10:44:59.577049 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m10:44:59.627778 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m10:44:59.631165 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m10:44:59.712787 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.72s]
[0m10:44:59.714587 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:44:59.715246 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:44:59.715825 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m10:44:59.716946 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.72s]
[0m10:44:59.717428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m10:44:59.718165 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:44:59.718641 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:44:59.719219 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:44:59.723336 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m10:44:59.723787 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m10:44:59.724391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m10:44:59.724803 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:44:59.728351 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m10:44:59.728925 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:44:59.730974 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m10:44:59.732033 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:44:59.734923 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m10:44:59.735582 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.74s]
[0m10:44:59.736268 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:44:59.736914 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m10:44:59.737292 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:44:59.737766 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m10:44:59.738181 [info ] [Thread-1 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m10:44:59.738801 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m10:44:59.739135 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:59.739496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m10:44:59.739829 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m10:44:59.741450 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:44:59.741887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:59.745206 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m10:44:59.747576 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:44:59.749603 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m10:44:59.750827 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m10:44:59.751226 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m10:44:59.751551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:59.787865 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.79s]
[0m10:44:59.788508 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:44:59.788933 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:44:59.789319 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m10:44:59.789737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m10:44:59.790132 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:44:59.793411 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m10:44:59.794154 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:44:59.795980 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m10:44:59.796946 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m10:44:59.797261 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m10:44:59.797553 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:00.199180 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m10:45:00.201813 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m10:45:00.255489 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m10:45:00.258356 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m10:45:00.384567 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.66s]
[0m10:45:00.387970 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:45:00.389415 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:00.390539 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m10:45:00.391924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m10:45:00.392938 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:00.401089 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m10:45:00.402832 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:00.406618 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m10:45:00.408399 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m10:45:00.409040 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m10:45:00.409569 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:00.456161 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m10:45:00.468519 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m10:45:00.576600 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.86s]
[0m10:45:00.577786 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:45:00.578285 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:00.578914 [info ] [Thread-3 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m10:45:00.579673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m10:45:00.580100 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:00.585231 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m10:45:00.586378 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:00.588729 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m10:45:00.590088 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m10:45:00.590622 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m10:45:00.592788 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:00.711403 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.92s]
[0m10:45:00.712574 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:45:00.713276 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:00.713914 [info ] [Thread-2 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m10:45:00.714623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m10:45:00.715199 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:00.721357 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m10:45:00.722502 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:00.724923 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m10:45:00.726021 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m10:45:00.726416 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m10:45:00.726785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:00.786615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.035 seconds
[0m10:45:00.788884 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m10:45:01.024322 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m10:45:01.027918 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m10:45:01.099724 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 1.36s]
[0m10:45:01.100595 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:45:01.101084 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:01.101585 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m10:45:01.102425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m10:45:01.102981 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:01.107488 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m10:45:01.108611 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:01.111515 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m10:45:01.112794 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m10:45:01.113281 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m10:45:01.113793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:01.431774 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 1.04s]
[0m10:45:01.437743 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:01.438900 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:01.440055 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m10:45:01.441363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m10:45:01.442283 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:01.449603 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m10:45:01.451469 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:01.454527 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m10:45:01.456020 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m10:45:01.456676 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m10:45:01.457437 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:01.846511 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m10:45:01.849200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m10:45:01.850884 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.258 seconds
[0m10:45:01.854773 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m10:45:01.857837 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m10:45:01.860358 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m10:45:02.177629 [info ] [Thread-3 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 1.60s]
[0m10:45:02.179986 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 1.08s]
[0m10:45:02.181448 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:02.182749 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:02.183970 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:02.184921 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:02.186779 [info ] [Thread-3 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m10:45:02.187861 [info ] [Thread-1 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m10:45:02.189348 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m10:45:02.190820 [info ] [Thread-2 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 1.48s]
[0m10:45:02.191594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m10:45:02.192250 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:02.193098 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:02.193709 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:02.202794 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m10:45:02.203442 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:02.207981 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m10:45:02.208686 [info ] [Thread-2 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m10:45:02.209571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m10:45:02.210163 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:02.210627 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:02.214441 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m10:45:02.214899 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:02.218172 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m10:45:02.220372 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m10:45:02.221152 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:02.223296 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m10:45:02.224190 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m10:45:02.224614 [debug] [Thread-3 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:02.225067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:02.225761 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m10:45:02.228061 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m10:45:02.228426 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:02.228793 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:02.229152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:02.229445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:02.315219 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m10:45:02.317431 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m10:45:02.494393 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 1.05s]
[0m10:45:02.495020 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:02.495392 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:02.495730 [info ] [Thread-4 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m10:45:02.496086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m10:45:02.496369 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:02.499451 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m10:45:02.500117 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:02.501739 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m10:45:02.502739 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m10:45:02.503047 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:02.503317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:02.711706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m10:45:02.713462 [debug] [Thread-3 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m10:45:02.733137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m10:45:02.734689 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m10:45:02.791219 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m10:45:02.795868 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m10:45:02.896709 [info ] [Thread-1 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.70s]
[0m10:45:02.899237 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:02.900910 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:02.902086 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m10:45:02.904109 [info ] [Thread-3 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.71s]
[0m10:45:02.905190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m10:45:02.906430 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:02.907283 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:02.912808 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m10:45:02.913655 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:02.915485 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m10:45:02.916372 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m10:45:02.916696 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:02.916994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:02.985468 [info ] [Thread-2 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.78s]
[0m10:45:02.988026 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:03.309055 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m10:45:03.313233 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m10:45:03.578413 [info ] [Thread-4 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.08s]
[0m10:45:03.580125 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:03.685710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m10:45:03.690254 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m10:45:03.948068 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.04s]
[0m10:45:03.950019 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:03.954099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:03.954958 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m10:45:03.955582 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m10:45:03.956211 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6' was properly closed.
[0m10:45:03.956890 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m10:45:03.957733 [info ] [MainThread]: 
[0m10:45:03.958492 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m10:45:03.962236 [debug] [MainThread]: Command end result
[0m10:45:04.023409 [info ] [MainThread]: 
[0m10:45:04.023880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:04.024173 [info ] [MainThread]: 
[0m10:45:04.024536 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m10:45:04.025963 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.4012184, "process_user_time": 4.416947, "process_kernel_time": 1.861262, "process_mem_max_rss": "268528", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m10:45:04.026394 [debug] [MainThread]: Command `dbt test` succeeded at 10:45:04.026318 after 7.40 seconds
[0m10:45:04.026715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5ad100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa85dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd83e87a0>]}
[0m10:45:04.027009 [debug] [MainThread]: Flushing usage events
[0m10:45:09.024671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb391ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffdaa26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb8413a0>]}


============================== 10:45:09.033258 | 9f3cddee-6541-4b72-965b-312c97232471 ==============================
[0m10:45:09.033258 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:45:09.034037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m10:45:09.911465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8981df0>]}
[0m10:45:09.952688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8367800>]}
[0m10:45:09.953864 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:45:09.969946 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:45:10.072023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:10.074459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:10.106327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd80894f0>]}
[0m10:45:10.188785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e888c0>]}
[0m10:45:10.189511 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m10:45:10.189940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bd910>]}
[0m10:45:10.192304 [info ] [MainThread]: 
[0m10:45:10.193137 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:45:10.205797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m10:45:10.217801 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m10:45:10.218206 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m10:45:10.218574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:11.205910 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.987 seconds
[0m10:45:11.210761 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m10:45:11.431579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m10:45:11.449261 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m10:45:11.450143 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m10:45:11.450756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:45:11.925772 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.475 seconds
[0m10:45:11.929028 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m10:45:12.101470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78f710>]}
[0m10:45:12.102768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:12.103559 [info ] [MainThread]: 
[0m10:45:12.116522 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m10:45:12.117469 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m10:45:12.118202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m10:45:12.118782 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m10:45:12.127355 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m10:45:12.128522 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m10:45:12.153582 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m10:45:12.156286 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m10:45:12.156798 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m10:45:12.157290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:12.869353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m10:45:12.892353 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m10:45:13.070754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839ce30>]}
[0m10:45:13.072402 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m10:45:13.074524 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m10:45:13.077574 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m10:45:13.078700 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m10:45:13.079842 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m10:45:13.080615 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m10:45:13.093464 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m10:45:13.094962 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m10:45:13.126345 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:13.126986 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m10:45:13.127453 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:45:13.881259 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m10:45:13.901632 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:13.902991 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:45:14.041700 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.137 seconds
[0m10:45:14.051090 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:14.051930 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m10:45:14.147126 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.094 seconds
[0m10:45:14.172053 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:14.172864 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:45:14.297464 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.123 seconds
[0m10:45:14.306637 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:14.307503 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m10:45:14.424684 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.116 seconds
[0m10:45:14.450445 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:45:14.479185 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m10:45:14.481206 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:14.481622 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m10:45:14.632408 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m10:45:14.633862 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:14.634845 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m10:45:16.050515 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.414 seconds
[0m10:45:16.051640 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:16.052353 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m10:45:16.396480 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m10:45:16.416211 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m10:45:16.425694 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m10:45:16.426335 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m10:45:16.586201 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m10:45:16.590332 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m10:45:16.792784 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5acf20>]}
[0m10:45:16.793773 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 3.71s]
[0m10:45:16.794429 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m10:45:16.795548 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m10:45:16.796047 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m10:45:16.796727 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m10:45:16.797338 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m10:45:16.798132 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m10:45:16.799349 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m10:45:16.800100 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m10:45:16.800656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m10:45:16.801476 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m10:45:16.802097 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m10:45:16.802656 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m10:45:16.803165 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m10:45:16.807878 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m10:45:16.810838 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:45:16.814885 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m10:45:16.816393 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m10:45:16.816854 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m10:45:16.835499 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:16.840090 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:45:16.840595 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m10:45:16.841075 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m10:45:16.841588 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:45:16.843756 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m10:45:16.846385 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m10:45:16.846804 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m10:45:16.847153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:16.850120 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m10:45:16.850541 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m10:45:16.850935 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:45:17.521634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m10:45:17.525809 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:17.526510 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:45:17.664024 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.137 seconds
[0m10:45:17.676444 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:17.678019 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m10:45:17.811719 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.132 seconds
[0m10:45:17.823401 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:17.824692 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:45:17.931382 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.106 seconds
[0m10:45:17.938138 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:17.938940 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m10:45:18.029359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.182 seconds
[0m10:45:18.034001 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m10:45:18.040479 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.101 seconds
[0m10:45:18.047609 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:45:18.050407 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m10:45:18.053568 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:18.054067 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m10:45:18.179486 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m10:45:18.180602 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:18.181759 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m10:45:18.186988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34db260>]}
[0m10:45:18.192092 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.39s]
[0m10:45:18.194060 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m10:45:18.409024 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.558 seconds
[0m10:45:18.411976 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m10:45:18.577281 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd33b70b0>]}
[0m10:45:18.578342 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 1.78s]
[0m10:45:18.579155 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m10:45:19.599328 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.411 seconds
[0m10:45:19.601716 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:19.603411 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m10:45:19.934627 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m10:45:19.941118 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m10:45:19.943004 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m10:45:19.943763 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m10:45:20.126221 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m10:45:20.130289 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m10:45:20.325103 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f3cddee-6541-4b72-965b-312c97232471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd33b6480>]}
[0m10:45:20.325995 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.52s]
[0m10:45:20.326683 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m10:45:20.328290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:20.328594 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m10:45:20.328868 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m10:45:20.329098 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m10:45:20.329311 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m10:45:20.329734 [info ] [MainThread]: 
[0m10:45:20.330035 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 10.14 seconds (10.14s).
[0m10:45:20.331086 [debug] [MainThread]: Command end result
[0m10:45:20.354743 [info ] [MainThread]: 
[0m10:45:20.355199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:20.355522 [info ] [MainThread]: 
[0m10:45:20.356127 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:45:20.357546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.374962, "process_user_time": 4.251839, "process_kernel_time": 1.991124, "process_mem_max_rss": "267712", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m10:45:20.358132 [debug] [MainThread]: Command `dbt run` succeeded at 10:45:20.358035 after 11.38 seconds
[0m10:45:20.358519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb11a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8098fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8099940>]}
[0m10:45:20.358842 [debug] [MainThread]: Flushing usage events
[0m10:45:23.632791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc798b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb6b6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc9880>]}


============================== 10:45:23.641769 | 0017494a-35fb-48f5-8ca3-00b3031e543c ==============================
[0m10:45:23.641769 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:45:23.642568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:45:24.392098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0017494a-35fb-48f5-8ca3-00b3031e543c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8336f00>]}
[0m10:45:24.421541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0017494a-35fb-48f5-8ca3-00b3031e543c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd857cd40>]}
[0m10:45:24.422122 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:45:24.433541 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:45:24.510833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:24.511230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:24.539782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0017494a-35fb-48f5-8ca3-00b3031e543c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8086d20>]}
[0m10:45:24.614140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0017494a-35fb-48f5-8ca3-00b3031e543c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da05f0>]}
[0m10:45:24.614640 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m10:45:24.614976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0017494a-35fb-48f5-8ca3-00b3031e543c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8e45940>]}
[0m10:45:24.617078 [info ] [MainThread]: 
[0m10:45:24.617741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:45:24.621502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m10:45:24.633658 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m10:45:24.634012 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m10:45:24.634326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:25.685603 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.050 seconds
[0m10:45:25.691870 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m10:45:25.910488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0017494a-35fb-48f5-8ca3-00b3031e543c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb391370>]}
[0m10:45:25.912468 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:25.913529 [info ] [MainThread]: 
[0m10:45:25.928529 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:45:25.929241 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:45:25.929911 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:45:25.930662 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m10:45:25.931387 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:45:25.931862 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m10:45:25.932517 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m10:45:25.933489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m10:45:25.934074 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m10:45:25.934892 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m10:45:25.935523 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m10:45:25.936017 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:45:25.936603 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m10:45:25.937058 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:45:25.937481 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:45:25.952933 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m10:45:25.953300 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:45:25.956556 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m10:45:25.959492 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m10:45:25.963201 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m10:45:25.964119 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:45:25.964442 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:45:25.984544 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m10:45:25.984958 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:45:25.987575 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m10:45:25.989559 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m10:45:25.989866 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:45:25.991962 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m10:45:25.992562 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m10:45:25.993068 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m10:45:25.993596 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m10:45:25.994118 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m10:45:25.994503 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m10:45:25.994980 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:45:25.995503 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m10:45:25.995864 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m10:45:25.996196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:25.997833 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m10:45:25.998223 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:45:25.999432 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:45:26.432605 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m10:45:26.452519 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m10:45:26.472476 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m10:45:26.475118 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m10:45:26.546403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m10:45:26.549691 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m10:45:26.569554 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m10:45:26.572602 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m10:45:26.618562 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.68s]
[0m10:45:26.620172 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m10:45:26.621101 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:45:26.622028 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m10:45:26.622944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m10:45:26.623667 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:45:26.630088 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m10:45:26.631554 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:45:26.634519 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m10:45:26.636137 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m10:45:26.636653 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m10:45:26.637123 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:26.649876 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.71s]
[0m10:45:26.650654 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m10:45:26.652584 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:45:26.653133 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m10:45:26.653931 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m10:45:26.654405 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:45:26.658490 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m10:45:26.659445 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:45:26.662728 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m10:45:26.664772 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m10:45:26.665151 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m10:45:26.665537 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:26.734964 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.80s]
[0m10:45:26.736082 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m10:45:26.736593 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:45:26.737074 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m10:45:26.737575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m10:45:26.737960 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:45:26.741655 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m10:45:26.742557 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:45:26.744528 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m10:45:26.745581 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m10:45:26.745980 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m10:45:26.746313 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:26.769796 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.84s]
[0m10:45:26.770488 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m10:45:26.770926 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:45:26.771396 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m10:45:26.771868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m10:45:26.772254 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:45:26.775749 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m10:45:26.776519 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:45:26.778449 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m10:45:26.779309 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m10:45:26.779680 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m10:45:26.780016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:27.105503 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m10:45:27.107402 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m10:45:27.131485 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m10:45:27.133204 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m10:45:27.225262 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m10:45:27.226130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m10:45:27.228208 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m10:45:27.230036 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m10:45:27.274012 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.62s]
[0m10:45:27.274879 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m10:45:27.275464 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:27.275991 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m10:45:27.276587 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m10:45:27.277085 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:27.281630 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m10:45:27.282658 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:27.284954 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m10:45:27.286054 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m10:45:27.286497 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m10:45:27.286882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:27.307385 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.68s]
[0m10:45:27.308141 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m10:45:27.308686 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:27.309214 [info ] [Thread-3 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m10:45:27.309794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m10:45:27.310175 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:27.313943 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m10:45:27.314862 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:27.316971 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m10:45:27.317994 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m10:45:27.318365 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m10:45:27.318715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:27.414486 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.64s]
[0m10:45:27.415458 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m10:45:27.416090 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:27.416657 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m10:45:27.417215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m10:45:27.417720 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:27.422405 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m10:45:27.423409 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:27.426963 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m10:45:27.428020 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m10:45:27.428418 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m10:45:27.428782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:27.478383 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.74s]
[0m10:45:27.479262 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m10:45:27.479909 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:27.480627 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m10:45:27.485470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m10:45:27.488177 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:27.492211 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m10:45:27.493202 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:27.495247 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m10:45:27.496218 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m10:45:27.496613 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m10:45:27.496959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:27.819105 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m10:45:27.825984 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m10:45:27.835559 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m10:45:27.840466 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m10:45:28.000826 [info ] [Thread-3 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.69s]
[0m10:45:28.002143 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m10:45:28.002975 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:28.003733 [info ] [Thread-3 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m10:45:28.004500 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m10:45:28.005118 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:28.010585 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m10:45:28.011662 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:28.014199 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m10:45:28.015412 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m10:45:28.015903 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m10:45:28.016351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:28.019562 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.74s]
[0m10:45:28.020482 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m10:45:28.020990 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:28.021482 [info ] [Thread-4 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m10:45:28.021944 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m10:45:28.022305 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:28.028651 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m10:45:28.029576 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:28.031712 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m10:45:28.032753 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m10:45:28.033124 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:28.033459 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:28.048653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m10:45:28.050642 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m10:45:28.096285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m10:45:28.098218 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m10:45:28.239673 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.75s]
[0m10:45:28.240671 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m10:45:28.241315 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:28.241946 [info ] [Thread-2 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m10:45:28.242613 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m10:45:28.243114 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:28.247743 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m10:45:28.248835 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:28.251334 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m10:45:28.252573 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m10:45:28.252995 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:28.253391 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:28.258867 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.84s]
[0m10:45:28.259550 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m10:45:28.260239 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:28.261057 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m10:45:28.261539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m10:45:28.261940 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:28.266813 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m10:45:28.269258 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:28.273017 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m10:45:28.274136 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m10:45:28.274492 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:28.274815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:28.488590 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m10:45:28.491709 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m10:45:28.494557 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m10:45:28.497722 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m10:45:28.651610 [info ] [Thread-3 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.65s]
[0m10:45:28.653685 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m10:45:28.655359 [info ] [Thread-4 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.63s]
[0m10:45:28.656393 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:28.657540 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m10:45:28.658408 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m10:45:28.659324 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:28.660132 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m10:45:28.660870 [info ] [Thread-4 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m10:45:28.661599 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:28.662260 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m10:45:28.668234 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m10:45:28.668826 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:28.673380 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m10:45:28.674271 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:28.676725 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m10:45:28.677276 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:28.679609 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m10:45:28.680584 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m10:45:28.681001 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:28.681465 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:28.682918 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m10:45:28.684207 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:28.684708 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:28.891327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m10:45:28.897803 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m10:45:28.900699 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m10:45:28.903672 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m10:45:29.047056 [info ] [Thread-2 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.80s]
[0m10:45:29.048198 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m10:45:29.062567 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.80s]
[0m10:45:29.063531 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m10:45:29.399883 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m10:45:29.407634 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m10:45:29.405917 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m10:45:29.411615 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m10:45:29.595180 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.93s]
[0m10:45:29.597540 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m10:45:29.610878 [info ] [Thread-4 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.95s]
[0m10:45:29.612538 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m10:45:29.617102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:29.618060 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m10:45:29.618925 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m10:45:29.619787 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m10:45:29.620506 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m10:45:29.621576 [info ] [MainThread]: 
[0m10:45:29.622247 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m10:45:29.626901 [debug] [MainThread]: Command end result
[0m10:45:29.713433 [info ] [MainThread]: 
[0m10:45:29.713851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:29.714364 [info ] [MainThread]: 
[0m10:45:29.714888 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m10:45:29.715937 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.124976, "process_user_time": 4.219846, "process_kernel_time": 1.841721, "process_mem_max_rss": "269332", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m10:45:29.716319 [debug] [MainThread]: Command `dbt test` succeeded at 10:45:29.716250 after 6.13 seconds
[0m10:45:29.716632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7ee270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb617200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd8d2660>]}
[0m10:45:29.716903 [debug] [MainThread]: Flushing usage events
[0m11:00:02.552171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1afdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcb93020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb2a16d0>]}


============================== 11:00:02.562030 | b5a1b088-954c-4c0d-bbae-1bbcf8b0444b ==============================
[0m11:00:02.562030 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:00:02.563114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:03.359945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8477050>]}
[0m11:00:03.389331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabed400>]}
[0m11:00:03.389925 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:00:03.403081 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:00:03.482574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:03.483046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:03.511368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd809e330>]}
[0m11:00:03.582910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e899d0>]}
[0m11:00:03.583405 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m11:00:03.584108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3eb4200>]}
[0m11:00:03.585882 [info ] [MainThread]: 
[0m11:00:03.586664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:03.590081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m11:00:03.602827 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m11:00:03.603227 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m11:00:03.603560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:04.988948 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.384 seconds
[0m11:00:04.995685 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m11:00:05.203472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m11:00:05.209888 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m11:00:05.210258 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m11:00:05.210588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:06.679431 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.468 seconds
[0m11:00:06.683603 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m11:00:07.475359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3eb4860>]}
[0m11:00:07.477459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:00:07.480005 [info ] [MainThread]: 
[0m11:00:07.496193 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m11:00:07.497243 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m11:00:07.498344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m11:00:07.498980 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m11:00:07.507813 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m11:00:07.509338 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m11:00:07.534254 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m11:00:07.537265 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m11:00:07.537762 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m11:00:07.538255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:08.616598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m11:00:08.642146 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m11:00:08.966210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78fd10>]}
[0m11:00:08.969036 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.46s]
[0m11:00:08.972864 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m11:00:08.976043 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m11:00:08.978123 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m11:00:08.979956 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m11:00:08.980699 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m11:00:08.994291 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m11:00:08.996806 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m11:00:09.027417 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:09.027879 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m11:00:09.028242 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:00:11.361541 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.333 seconds
[0m11:00:11.374772 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:11.375512 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m11:00:11.612412 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.236 seconds
[0m11:00:11.625607 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:11.627019 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m11:00:11.862938 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.234 seconds
[0m11:00:11.891935 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:11.892980 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m11:00:13.350788 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 1.457 seconds
[0m11:00:13.357827 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:13.358521 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m11:00:13.720474 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.361 seconds
[0m11:00:13.748950 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:00:13.777645 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m11:00:13.780333 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:13.780720 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m11:00:14.010860 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m11:00:14.013135 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:14.015120 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m11:00:16.768120 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.751 seconds
[0m11:00:16.770287 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:16.771437 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m11:00:18.197414 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.424 seconds
[0m11:00:18.218601 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m11:00:18.228448 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:00:18.229171 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m11:00:18.811384 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m11:00:18.819139 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m11:00:19.373686 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b19760>]}
[0m11:00:19.376271 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 10.39s]
[0m11:00:19.379944 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m11:00:19.382687 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m11:00:19.384269 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m11:00:19.385718 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m11:00:19.387069 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m11:00:19.388931 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m11:00:19.390076 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m11:00:19.391243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m11:00:19.392191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m11:00:19.393247 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m11:00:19.394065 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m11:00:19.394789 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m11:00:19.395421 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m11:00:19.401414 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m11:00:19.405050 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m11:00:19.409771 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m11:00:19.411703 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m11:00:19.412282 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m11:00:19.417192 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:19.417640 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m11:00:19.436027 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m11:00:19.436505 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m11:00:19.438690 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m11:00:19.439536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:19.440965 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m11:00:19.441976 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m11:00:19.442851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:19.445143 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m11:00:19.446785 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m11:00:19.447276 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:00:20.460717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.021 seconds
[0m11:00:20.470883 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:20.472111 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m11:00:20.620502 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.147 seconds
[0m11:00:20.629780 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:20.630610 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m11:00:20.753811 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.122 seconds
[0m11:00:20.766824 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:20.768176 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m11:00:20.950621 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.181 seconds
[0m11:00:20.956492 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:20.957166 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m11:00:21.187170 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.229 seconds
[0m11:00:21.201127 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:00:21.204609 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m11:00:21.209250 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:21.209930 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m11:00:21.344272 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m11:00:21.345485 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:21.346671 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m11:00:21.584992 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.142 seconds
[0m11:00:21.587465 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m11:00:21.683961 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.236 seconds
[0m11:00:21.687418 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m11:00:21.922424 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b22270>]}
[0m11:00:21.925177 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.53s]
[0m11:00:21.927157 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m11:00:22.290859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b24380>]}
[0m11:00:22.291915 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.90s]
[0m11:00:22.293036 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m11:00:23.317921 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.970 seconds
[0m11:00:23.320019 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:23.321138 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m11:00:23.828603 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m11:00:23.841557 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m11:00:23.844930 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:00:23.845969 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m11:00:24.438941 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m11:00:24.440956 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m11:00:24.644082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a1b088-954c-4c0d-bbae-1bbcf8b0444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0208830>]}
[0m11:00:24.645170 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 5.25s]
[0m11:00:24.646254 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m11:00:24.648111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:24.648561 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m11:00:24.649048 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m11:00:24.649423 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m11:00:24.649781 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m11:00:24.650398 [info ] [MainThread]: 
[0m11:00:24.651097 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 21.06 seconds (21.06s).
[0m11:00:24.652606 [debug] [MainThread]: Command end result
[0m11:00:24.680945 [info ] [MainThread]: 
[0m11:00:24.681775 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:24.682342 [info ] [MainThread]: 
[0m11:00:24.682885 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:00:24.684214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.17369, "process_user_time": 4.16631, "process_kernel_time": 1.876679, "process_mem_max_rss": "268448", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m11:00:24.684669 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:24.684594 after 22.17 seconds
[0m11:00:24.685000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1afdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bce60>]}
[0m11:00:24.685301 [debug] [MainThread]: Flushing usage events
[0m11:00:27.568069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafb61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf78da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafb43e0>]}


============================== 11:00:27.576687 | b4ab0590-51d0-42cf-890f-ce5cb44f5023 ==============================
[0m11:00:27.576687 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:00:27.577704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:28.344423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4ab0590-51d0-42cf-890f-ce5cb44f5023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8d92240>]}
[0m11:00:28.377594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4ab0590-51d0-42cf-890f-ce5cb44f5023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbedb4d0>]}
[0m11:00:28.378429 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:00:28.394842 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:00:28.510339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:28.510831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:28.542401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4ab0590-51d0-42cf-890f-ce5cb44f5023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81ed7f0>]}
[0m11:00:28.623861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4ab0590-51d0-42cf-890f-ce5cb44f5023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d38830>]}
[0m11:00:28.624561 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m11:00:28.625244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4ab0590-51d0-42cf-890f-ce5cb44f5023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1e7e00>]}
[0m11:00:28.627885 [info ] [MainThread]: 
[0m11:00:28.628966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:28.634481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m11:00:28.650581 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m11:00:28.651070 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m11:00:28.651381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:29.785236 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.133 seconds
[0m11:00:29.790483 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m11:00:30.016062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4ab0590-51d0-42cf-890f-ce5cb44f5023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e70e00>]}
[0m11:00:30.017167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:00:30.018021 [info ] [MainThread]: 
[0m11:00:30.027071 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m11:00:30.027600 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m11:00:30.028114 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m11:00:30.028622 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m11:00:30.029110 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m11:00:30.029519 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m11:00:30.030054 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m11:00:30.030624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m11:00:30.031110 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m11:00:30.031826 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m11:00:30.032313 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m11:00:30.032750 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m11:00:30.033226 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m11:00:30.033607 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m11:00:30.033991 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m11:00:30.047261 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m11:00:30.047665 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m11:00:30.050752 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m11:00:30.053601 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m11:00:30.056977 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m11:00:30.059235 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m11:00:30.059553 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m11:00:30.067357 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m11:00:30.073832 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m11:00:30.074154 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m11:00:30.075751 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m11:00:30.077391 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m11:00:30.079102 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m11:00:30.080224 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m11:00:30.080837 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m11:00:30.081243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:30.081788 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m11:00:30.082307 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m11:00:30.083909 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m11:00:30.084213 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m11:00:30.084853 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m11:00:30.085347 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m11:00:30.085761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:00:30.086097 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:00:30.086427 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:00:30.671655 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m11:00:30.695879 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m11:00:30.762427 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m11:00:30.765967 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m11:00:30.856995 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m11:00:30.862976 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m11:00:30.889066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m11:00:30.893147 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m11:00:30.943058 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.91s]
[0m11:00:30.944837 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m11:00:30.945807 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m11:00:30.946673 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m11:00:30.947905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m11:00:30.948546 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m11:00:30.955062 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m11:00:30.956571 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m11:00:30.959439 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m11:00:30.960988 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m11:00:30.961458 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m11:00:30.961923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:30.973356 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.94s]
[0m11:00:30.974683 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m11:00:30.975304 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m11:00:30.975833 [info ] [Thread-2 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m11:00:30.976499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m11:00:30.976922 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m11:00:30.980926 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m11:00:30.981950 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m11:00:30.985052 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m11:00:30.986272 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m11:00:30.986643 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m11:00:30.987030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:31.116838 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 1.09s]
[0m11:00:31.117818 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m11:00:31.118237 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m11:00:31.118591 [info ] [Thread-1 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m11:00:31.119121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m11:00:31.119442 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m11:00:31.122629 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m11:00:31.123511 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m11:00:31.125192 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m11:00:31.126185 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m11:00:31.126567 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m11:00:31.126937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:31.148426 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 1.12s]
[0m11:00:31.149307 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m11:00:31.149695 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m11:00:31.150043 [info ] [Thread-4 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m11:00:31.150482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m11:00:31.150811 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m11:00:31.153817 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m11:00:31.154760 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m11:00:31.156490 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m11:00:31.157785 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m11:00:31.158131 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m11:00:31.158828 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:31.585555 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m11:00:31.591297 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m11:00:31.619725 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m11:00:31.623476 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m11:00:31.788044 [info ] [Thread-2 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.81s]
[0m11:00:31.790034 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m11:00:31.790848 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m11:00:31.791533 [info ] [Thread-2 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m11:00:31.792479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m11:00:31.793020 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m11:00:31.798236 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m11:00:31.799424 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m11:00:31.801903 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m11:00:31.803241 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m11:00:31.803697 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m11:00:31.804195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:31.881897 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.93s]
[0m11:00:31.883379 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m11:00:31.884100 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m11:00:31.884726 [info ] [Thread-3 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m11:00:31.885584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m11:00:31.886183 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m11:00:31.890780 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m11:00:31.891920 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m11:00:31.894354 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m11:00:31.895596 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m11:00:31.896067 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m11:00:31.896504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:32.342298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.215 seconds
[0m11:00:32.348594 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m11:00:32.356109 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.197 seconds
[0m11:00:32.360511 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m11:00:32.405822 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m11:00:32.409958 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m11:00:32.578862 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 1.46s]
[0m11:00:32.581966 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m11:00:32.583295 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m11:00:32.584385 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m11:00:32.585971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m11:00:32.586974 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m11:00:32.597852 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m11:00:32.599725 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m11:00:32.603166 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m11:00:32.605037 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m11:00:32.605809 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m11:00:32.606477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:32.814539 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.918 seconds
[0m11:00:32.817708 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m11:00:33.067411 [info ] [Thread-4 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.92s]
[0m11:00:33.069359 [info ] [Thread-3 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 1.18s]
[0m11:00:33.072326 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m11:00:33.075097 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m11:00:33.077073 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m11:00:33.079045 [info ] [Thread-2 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 1.29s]
[0m11:00:33.080066 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m11:00:33.080990 [info ] [Thread-4 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m11:00:33.082380 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m11:00:33.083206 [info ] [Thread-3 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m11:00:33.084161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m11:00:33.084933 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m11:00:33.085651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m11:00:33.086337 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m11:00:33.086971 [info ] [Thread-2 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m11:00:33.087805 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m11:00:33.093941 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m11:00:33.094579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m11:00:33.099051 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m11:00:33.099758 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m11:00:33.105968 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m11:00:33.106591 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m11:00:33.108944 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m11:00:33.109639 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m11:00:33.110066 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m11:00:33.112106 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m11:00:33.114295 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m11:00:33.115005 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m11:00:33.115582 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m11:00:33.115992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:33.116683 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m11:00:33.117607 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m11:00:33.118472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:33.119360 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m11:00:33.120996 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:33.121344 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:33.307881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m11:00:33.310086 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m11:00:33.787064 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m11:00:33.789821 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m11:00:34.006081 [info ] [Thread-4 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.92s]
[0m11:00:34.008903 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m11:00:34.010496 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m11:00:34.015457 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m11:00:34.017316 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m11:00:34.020920 [info ] [Thread-4 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m11:00:34.023081 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m11:00:34.024063 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m11:00:34.031475 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m11:00:34.037225 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 1.45s]
[0m11:00:34.038310 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m11:00:34.039018 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m11:00:34.039469 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m11:00:34.040010 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m11:00:34.044339 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m11:00:34.044919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m11:00:34.045547 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m11:00:34.049366 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m11:00:34.050413 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m11:00:34.050909 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:34.051311 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:34.052360 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m11:00:34.055210 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m11:00:34.056278 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m11:00:34.056651 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:34.056997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:34.234228 [info ] [Thread-3 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 1.15s]
[0m11:00:34.235579 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m11:00:34.236363 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m11:00:34.237083 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m11:00:34.238024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m11:00:34.238490 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m11:00:34.242760 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m11:00:34.243912 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m11:00:34.246117 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m11:00:34.247320 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m11:00:34.247779 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:34.248160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:34.290951 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.169 seconds
[0m11:00:34.292745 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m11:00:34.531042 [info ] [Thread-2 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 1.44s]
[0m11:00:34.533699 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m11:00:34.534605 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m11:00:34.535343 [info ] [Thread-2 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m11:00:34.537599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m11:00:34.539265 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m11:00:34.544777 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m11:00:34.545805 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m11:00:34.548308 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m11:00:34.549646 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m11:00:34.550142 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:34.550674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:34.735185 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m11:00:34.741132 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m11:00:34.957014 [info ] [Thread-4 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.93s]
[0m11:00:34.960663 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m11:00:34.964480 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m11:00:34.969214 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m11:00:34.994841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m11:00:35.000627 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m11:00:35.195552 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.96s]
[0m11:00:35.198654 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 1.15s]
[0m11:00:35.201040 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m11:00:35.202899 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m11:00:35.335955 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m11:00:35.343216 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m11:00:35.570110 [info ] [Thread-2 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.03s]
[0m11:00:35.572796 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m11:00:35.576591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:35.577281 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m11:00:35.577790 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m11:00:35.578244 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m11:00:35.578678 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m11:00:35.579298 [info ] [MainThread]: 
[0m11:00:35.579870 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m11:00:35.583462 [debug] [MainThread]: Command end result
[0m11:00:35.654801 [info ] [MainThread]: 
[0m11:00:35.655326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:35.655681 [info ] [MainThread]: 
[0m11:00:35.656049 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m11:00:35.657092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.13023, "process_user_time": 4.4234, "process_kernel_time": 1.808276, "process_mem_max_rss": "268332", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m11:00:35.657518 [debug] [MainThread]: Command `dbt test` succeeded at 11:00:35.657448 after 8.13 seconds
[0m11:00:35.657842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbd1fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb682cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb93cd10>]}
[0m11:00:35.658149 [debug] [MainThread]: Flushing usage events
[0m11:22:31.513457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbeafe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffda90ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbeac050>]}


============================== 11:22:31.523335 | 5b8d73a9-6716-4274-8570-300ec7c1fbfb ==============================
[0m11:22:31.523335 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:22:31.524432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:22:32.331494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffac212e0>]}
[0m11:22:32.361559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8337770>]}
[0m11:22:32.362273 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:22:32.374441 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:22:32.452067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:32.452494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:32.479221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd822ecf0>]}
[0m11:22:32.549502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e28a40>]}
[0m11:22:32.549995 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m11:22:32.550714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd9fa51c0>]}
[0m11:22:32.552620 [info ] [MainThread]: 
[0m11:22:32.553350 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:32.556932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m11:22:32.567228 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m11:22:32.567555 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m11:22:32.567870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:33.747667 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.179 seconds
[0m11:22:33.754274 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m11:22:33.959616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m11:22:33.976386 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m11:22:33.977107 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m11:22:33.977655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:34.712153 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.734 seconds
[0m11:22:34.719429 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m11:22:34.908894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7de8a0>]}
[0m11:22:34.909654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:22:34.910408 [info ] [MainThread]: 
[0m11:22:34.919592 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m11:22:34.920291 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m11:22:34.920958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m11:22:34.921424 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m11:22:34.928034 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m11:22:34.929210 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m11:22:34.950089 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m11:22:34.952836 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m11:22:34.953321 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m11:22:34.953776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:35.745273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m11:22:35.783975 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m11:22:35.966306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8334d70>]}
[0m11:22:35.967012 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.04s]
[0m11:22:35.968077 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m11:22:35.969221 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m11:22:35.969770 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m11:22:35.970357 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m11:22:35.970697 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m11:22:35.976994 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m11:22:35.977926 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m11:22:36.000802 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:22:36.001318 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m11:22:36.001786 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:22:38.151619 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.148 seconds
[0m11:22:38.163566 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:22:38.164136 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m11:22:38.335559 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.171 seconds
[0m11:22:38.347656 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:22:38.349035 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m11:22:38.545545 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.195 seconds
[0m11:22:38.565548 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:22:38.566160 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m11:22:38.767702 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.201 seconds
[0m11:22:38.772974 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:22:38.773522 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m11:22:38.918150 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.144 seconds
[0m11:22:38.944560 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:22:38.973802 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m11:22:38.975909 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:22:38.976327 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m11:22:39.136631 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m11:22:39.138432 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:22:39.139658 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m11:40:56.096650 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 32.707 seconds
[0m11:40:56.102023 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:40:56.103787 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m11:40:57.295090 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.190 seconds
[0m11:40:57.325009 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m11:40:57.333869 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m11:40:57.334461 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m11:40:57.633162 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m11:40:57.642002 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m11:40:57.856738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b76c30>]}
[0m11:40:57.863539 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 1101.88s]
[0m11:40:57.867469 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m11:40:57.876619 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m11:40:57.877456 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m11:40:57.878047 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m11:40:57.878630 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m11:40:57.879411 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m11:40:57.879968 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m11:40:57.880723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m11:40:57.881242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m11:40:57.881770 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m11:40:57.882341 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m11:40:57.882782 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m11:40:57.883180 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m11:40:57.887712 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m11:40:57.891992 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m11:40:57.895371 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m11:40:57.896896 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m11:40:57.897387 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m11:40:57.906792 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m11:40:57.920886 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:40:57.923583 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m11:40:57.925978 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m11:40:57.926549 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m11:40:57.927659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:40:57.931001 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m11:40:57.931501 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m11:40:57.934058 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m11:40:57.934469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:57.935199 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m11:40:57.936977 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:40:58.917633 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m11:40:58.925631 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:40:58.926919 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m11:40:59.053384 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.125 seconds
[0m11:40:59.065889 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:40:59.067303 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m11:40:59.228731 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.161 seconds
[0m11:40:59.235454 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:40:59.236209 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m11:40:59.379260 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.142 seconds
[0m11:40:59.392586 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:40:59.393591 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m11:40:59.517477 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.123 seconds
[0m11:40:59.531267 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:40:59.534950 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m11:40:59.538923 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:40:59.539623 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m11:40:59.735965 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m11:40:59.737003 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:40:59.737885 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m11:41:00.237917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.303 seconds
[0m11:41:00.244804 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m11:41:00.431743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd349cdd0>]}
[0m11:41:00.433160 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.55s]
[0m11:41:00.434640 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m11:41:00.711489 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.774 seconds
[0m11:41:00.715003 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m11:41:00.936296 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b50260>]}
[0m11:41:00.937198 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 3.05s]
[0m11:41:00.938191 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m11:41:01.195516 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.456 seconds
[0m11:41:01.197573 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m11:41:01.198903 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m13:19:15.553887 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 16.780 seconds
[0m13:19:15.566002 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m13:19:15.569109 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:19:15.570255 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m13:19:15.792407 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m13:19:15.799400 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m13:19:15.989772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b8d73a9-6716-4274-8570-300ec7c1fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe0a6090>]}
[0m13:19:15.991311 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 5898.11s]
[0m13:19:15.993390 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m13:19:15.997097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:15.997791 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m13:19:15.998294 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m13:19:15.998749 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m13:19:15.999185 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m13:19:16.000383 [info ] [MainThread]: 
[0m13:19:16.001335 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 1 hours 56 minutes and 43.45 seconds (7003.45s).
[0m13:19:16.003320 [debug] [MainThread]: Command end result
[0m13:19:16.040454 [info ] [MainThread]: 
[0m13:19:16.041269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:16.041600 [info ] [MainThread]: 
[0m13:19:16.042166 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:19:16.044246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 62.752365, "process_user_time": 4.293838, "process_kernel_time": 1.967841, "process_mem_max_rss": "269064", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m13:19:16.044964 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:16.044866 after 62.75 seconds
[0m13:19:16.045497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffba906b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb26c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb26ce60>]}
[0m13:19:16.047686 [debug] [MainThread]: Flushing usage events
[0m13:19:18.860797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbb8e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b8170>]}


============================== 13:19:18.870084 | f15220f5-7748-43a8-889f-df07b50fffda ==============================
[0m13:19:18.870084 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:19:18.871173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:19.642965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f15220f5-7748-43a8-889f-df07b50fffda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8671df0>]}
[0m13:19:19.672477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f15220f5-7748-43a8-889f-df07b50fffda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86fcc20>]}
[0m13:19:19.673063 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:19:19.684990 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m13:19:19.759246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:19.759631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:19.785699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f15220f5-7748-43a8-889f-df07b50fffda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e86090>]}
[0m13:19:19.858354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f15220f5-7748-43a8-889f-df07b50fffda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da08c0>]}
[0m13:19:19.858828 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m13:19:19.859572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f15220f5-7748-43a8-889f-df07b50fffda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb965e50>]}
[0m13:19:19.861480 [info ] [MainThread]: 
[0m13:19:19.862074 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:19.866007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m13:19:19.877366 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m13:19:19.877689 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m13:19:19.877989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:21.857471 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.979 seconds
[0m13:19:21.862277 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m13:19:22.096218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f15220f5-7748-43a8-889f-df07b50fffda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd814d0d0>]}
[0m13:19:22.097711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:22.099216 [info ] [MainThread]: 
[0m13:19:22.114292 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m13:19:22.114925 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m13:19:22.115517 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m13:19:22.116183 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m13:19:22.116715 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m13:19:22.117184 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m13:19:22.117740 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m13:19:22.118485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m13:19:22.119069 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m13:19:22.119749 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m13:19:22.120340 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m13:19:22.120830 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m13:19:22.121374 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m13:19:22.121805 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m13:19:22.122267 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m13:19:22.135588 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m13:19:22.137611 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m13:19:22.140963 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m13:19:22.144058 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m13:19:22.147661 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m13:19:22.149048 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m13:19:22.149421 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m13:19:22.157758 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m13:19:22.163531 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m13:19:22.166552 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m13:19:22.166918 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m13:19:22.168584 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m13:19:22.170175 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m13:19:22.171804 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m13:19:22.172245 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m13:19:22.172834 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m13:19:22.173164 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:19:22.173681 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m13:19:22.174196 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m13:19:22.174491 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m13:19:22.175492 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m13:19:22.176466 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m13:19:22.176938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:22.177275 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:19:22.177581 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:19:22.737698 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m13:19:22.766409 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m13:19:22.767956 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m13:19:22.772520 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m13:19:22.806188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m13:19:22.809034 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m13:19:22.961713 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.84s]
[0m13:19:22.965522 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m13:19:22.966622 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m13:19:22.967660 [info ] [Thread-4 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m13:19:22.969046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m13:19:22.969732 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m13:19:22.976507 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m13:19:22.978155 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m13:19:22.981206 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m13:19:22.983630 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m13:19:22.984845 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.87s]
[0m13:19:22.985529 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m13:19:22.986373 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m13:19:22.986932 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:19:22.987591 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m13:19:22.989140 [info ] [Thread-1 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m13:19:22.990734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m13:19:22.991331 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m13:19:22.995806 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m13:19:22.997182 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m13:19:23.000275 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m13:19:23.001554 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m13:19:23.001995 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m13:19:23.002370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:23.156175 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 1.04s]
[0m13:19:23.157234 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m13:19:23.157697 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m13:19:23.158125 [info ] [Thread-3 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m13:19:23.158691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m13:19:23.159078 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m13:19:23.162750 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m13:19:23.163761 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m13:19:23.165677 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m13:19:23.166765 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m13:19:23.167226 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m13:19:23.167612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:19:23.583303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m13:19:23.589212 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m13:19:23.648422 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m13:19:23.653259 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m13:19:23.709123 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.536 seconds
[0m13:19:23.714065 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m13:19:23.753038 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m13:19:23.757581 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m13:19:23.869939 [info ] [Thread-1 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.88s]
[0m13:19:23.872220 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m13:19:23.873536 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m13:19:23.874530 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m13:19:23.876027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m13:19:23.876964 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m13:19:23.885910 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m13:19:23.888956 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 1.77s]
[0m13:19:23.890326 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m13:19:23.891137 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m13:19:23.891955 [info ] [Thread-2 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m13:19:23.893125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m13:19:23.893732 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m13:19:23.894269 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m13:19:23.897444 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m13:19:23.901938 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m13:19:23.904190 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m13:19:23.904680 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m13:19:23.905142 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m13:19:23.907425 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m13:19:23.907879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:23.910555 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m13:19:23.911059 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m13:19:23.911506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:19:23.932205 [info ] [Thread-3 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.77s]
[0m13:19:23.933462 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m13:19:23.934078 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m13:19:23.934948 [info ] [Thread-4 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.97s]
[0m13:19:23.935434 [info ] [Thread-3 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m13:19:23.936116 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m13:19:23.936586 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m13:19:23.937080 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m13:19:23.937517 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m13:19:23.937946 [info ] [Thread-4 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m13:19:23.941714 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m13:19:23.942186 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m13:19:23.942744 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m13:19:23.946120 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m13:19:23.946701 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m13:19:23.948674 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m13:19:23.949172 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m13:19:23.951819 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m13:19:23.952535 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m13:19:23.952887 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m13:19:23.953220 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:19:23.954318 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m13:19:23.955231 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m13:19:23.955664 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:19:24.485602 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m13:19:24.489714 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m13:19:24.554896 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m13:19:24.559693 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m13:19:24.565292 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m13:19:24.569074 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m13:19:24.645636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m13:19:24.649383 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m13:19:24.673460 [info ] [Thread-2 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.78s]
[0m13:19:24.675548 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m13:19:24.676468 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m13:19:24.677146 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m13:19:24.678072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m13:19:24.678623 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m13:19:24.684912 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m13:19:24.686482 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m13:19:24.689501 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m13:19:24.690859 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m13:19:24.691394 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m13:19:24.691908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:19:24.746586 [info ] [Thread-3 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.81s]
[0m13:19:24.748582 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m13:19:24.749269 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m13:19:24.749873 [info ] [Thread-3 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m13:19:24.750739 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m13:19:24.751412 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m13:19:24.757221 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m13:19:24.758915 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m13:19:24.761370 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m13:19:24.762696 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m13:19:24.763116 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m13:19:24.763567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:19:24.814805 [info ] [Thread-4 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.87s]
[0m13:19:24.815913 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m13:19:24.816763 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.94s]
[0m13:19:24.817345 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m13:19:24.818037 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m13:19:24.818527 [info ] [Thread-4 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m13:19:24.819129 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m13:19:24.819644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m13:19:24.820136 [info ] [Thread-1 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m13:19:24.820672 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m13:19:24.821144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m13:19:24.827140 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m13:19:24.827706 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m13:19:24.831127 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m13:19:24.832083 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m13:19:24.834131 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m13:19:24.834605 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m13:19:24.836506 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m13:19:24.837313 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m13:19:24.837675 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:24.838047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:19:24.839721 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m13:19:24.840340 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:24.840764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:25.337389 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m13:19:25.343788 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m13:19:25.354890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m13:19:25.358490 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m13:19:25.474604 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m13:19:25.480233 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m13:19:25.532926 [info ] [Thread-4 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.71s]
[0m13:19:25.534838 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m13:19:25.536432 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m13:19:25.537546 [info ] [Thread-4 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m13:19:25.539190 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m13:19:25.540250 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m13:19:25.552282 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m13:19:25.555951 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m13:19:25.559368 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m13:19:25.560964 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m13:19:25.561589 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:25.562099 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:19:25.582051 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.90s]
[0m13:19:25.583312 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m13:19:25.583893 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m13:19:25.584421 [info ] [Thread-2 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m13:19:25.585087 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m13:19:25.585511 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m13:19:25.589507 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m13:19:25.590542 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m13:19:25.592771 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m13:19:25.593937 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m13:19:25.594351 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:25.594709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:19:25.700088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m13:19:25.702760 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m13:19:25.706251 [info ] [Thread-3 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.96s]
[0m13:19:25.707481 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m13:19:25.708072 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m13:19:25.708591 [info ] [Thread-3 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m13:19:25.709351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m13:19:25.709822 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m13:19:25.714215 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m13:19:25.715257 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m13:19:25.717507 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m13:19:25.718779 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m13:19:25.719233 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:25.719655 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:19:25.878502 [info ] [Thread-1 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 1.06s]
[0m13:19:25.880029 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m13:24:50.661315 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 32.199 seconds
[0m13:24:50.668857 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m13:24:50.674497 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 32.338 seconds
[0m13:24:50.677570 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m13:24:50.700825 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 32.397 seconds
[0m13:24:50.703632 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m13:24:50.869160 [info ] [Thread-2 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 325.28s]
[0m13:24:50.873363 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m13:24:50.895142 [info ] [Thread-4 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 325.36s]
[0m13:24:50.897344 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m13:24:51.484627 [info ] [Thread-3 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 325.77s]
[0m13:24:51.487370 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m13:24:51.492095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:51.492781 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m13:24:51.493465 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m13:24:51.494131 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m13:24:51.494645 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m13:24:51.495469 [info ] [MainThread]: 
[0m13:24:51.496517 [info ] [MainThread]: Finished running 18 data tests in 0 hours 5 minutes and 31.63 seconds (331.63s).
[0m13:24:51.500602 [debug] [MainThread]: Command end result
[0m13:24:51.578049 [info ] [MainThread]: 
[0m13:24:51.578837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:51.579319 [info ] [MainThread]: 
[0m13:24:51.579785 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m13:24:51.580987 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 40.02354, "process_user_time": 4.310766, "process_kernel_time": 1.975048, "process_mem_max_rss": "271020", "process_out_blocks": "2223", "process_in_blocks": "0"}
[0m13:24:51.581393 [debug] [MainThread]: Command `dbt test` succeeded at 13:24:51.581321 after 40.02 seconds
[0m13:24:51.581709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbb8e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8121790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd594410>]}
[0m13:24:51.581997 [debug] [MainThread]: Flushing usage events
[0m13:24:56.043159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb930e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbac3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf802f0>]}


============================== 13:24:56.051788 | 8e86537d-196a-4522-82de-4e9089a95b94 ==============================
[0m13:24:56.051788 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:24:56.052739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:24:56.815211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd88419d0>]}
[0m13:24:56.856678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dcdb80>]}
[0m13:24:56.857571 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:24:56.871549 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m13:24:56.954245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:56.954700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:56.984415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86a0980>]}
[0m13:24:57.061052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e88ec0>]}
[0m13:24:57.061610 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m13:24:57.062335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbddc890>]}
[0m13:24:57.064296 [info ] [MainThread]: 
[0m13:24:57.065034 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:57.069020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m13:24:57.081041 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m13:24:57.081422 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m13:24:57.081758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:58.391262 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.309 seconds
[0m13:24:58.395350 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m13:24:58.588463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m13:24:58.606712 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m13:24:58.607543 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m13:24:58.608115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:59.258289 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.650 seconds
[0m13:24:59.263800 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m13:24:59.638206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd98a1700>]}
[0m13:24:59.638782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:24:59.639344 [info ] [MainThread]: 
[0m13:24:59.645483 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m13:24:59.646011 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m13:24:59.646516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m13:24:59.646824 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m13:24:59.651896 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m13:24:59.652729 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m13:24:59.670356 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m13:24:59.672567 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m13:24:59.672969 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m13:24:59.673375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:00.493487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m13:25:00.530600 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m13:25:00.730388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839cb60>]}
[0m13:25:00.733035 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.08s]
[0m13:25:00.736390 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m13:25:00.739288 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m13:25:00.741316 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m13:25:00.743166 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m13:25:00.744010 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m13:25:00.757435 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m13:25:00.758864 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m13:25:00.790040 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:25:00.790596 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m13:25:00.791055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:01.759718 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.968 seconds
[0m13:25:01.774094 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:25:01.774806 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m13:25:01.915070 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.139 seconds
[0m13:25:01.928407 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:25:01.929379 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m13:25:02.126355 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.196 seconds
[0m13:25:02.154547 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:25:02.155314 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m13:25:02.295595 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.140 seconds
[0m13:25:02.300112 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:25:02.300565 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m13:46:59.671485 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 2.234 seconds
[0m13:46:59.681669 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:46:59.701441 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m13:46:59.703272 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:46:59.703610 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m13:46:59.961110 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m13:46:59.961717 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:46:59.962123 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m13:47:02.418127 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.454 seconds
[0m13:47:02.420965 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:47:02.421844 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m13:47:02.857109 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m13:47:02.885573 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m13:47:02.894885 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m13:47:02.895478 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m13:47:03.627074 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m13:47:03.634776 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m13:47:03.823302 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd33795b0>]}
[0m13:47:03.826907 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 1323.08s]
[0m13:47:03.833825 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m13:47:03.838517 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m13:47:03.839865 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m13:47:03.840783 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m13:47:03.841820 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m13:47:03.843707 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m13:47:03.844937 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m13:47:03.846696 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m13:47:03.849765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m13:47:03.851138 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m13:47:03.852074 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m13:47:03.852771 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m13:47:03.853431 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m13:47:03.862521 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m13:47:03.868155 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m13:47:03.871755 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m13:47:03.873436 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m13:47:03.873872 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m13:47:03.878460 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:03.884469 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m13:47:03.892333 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m13:47:03.899117 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m13:47:03.901241 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m13:47:03.901693 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:47:03.905389 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m13:47:03.907548 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m13:47:03.907939 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m13:47:03.908702 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m13:47:03.909188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:03.909553 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:47:04.701916 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m13:47:04.713242 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:04.715283 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m13:47:06.999369 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 2.282 seconds
[0m13:47:07.015725 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:07.016942 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m13:47:07.168162 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.150 seconds
[0m13:47:07.182256 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:07.183816 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m13:47:07.338508 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.153 seconds
[0m13:47:07.350248 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:07.352079 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m13:47:07.512941 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.159 seconds
[0m13:47:07.524673 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:47:07.528776 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m13:47:07.532851 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:07.533535 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m13:47:07.771615 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m13:47:07.772420 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:07.772961 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m13:47:09.575954 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.802 seconds
[0m13:47:09.577287 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:09.577890 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m13:47:09.915497 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m13:47:09.929581 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m13:47:09.933672 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m13:47:09.935547 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m13:47:10.114469 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m13:47:10.123624 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m13:47:10.315644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8206ae0>]}
[0m13:47:10.319894 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 6.47s]
[0m13:47:10.325614 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m13:47:20.843739 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 16.934 seconds
[0m13:47:20.850485 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m13:47:21.037282 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd33d9f10>]}
[0m13:47:21.040122 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 17.19s]
[0m13:47:21.043300 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m14:05:38.499283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 32.437 seconds
[0m14:05:38.510560 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m14:05:38.684202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e86537d-196a-4522-82de-4e9089a95b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd33b0fb0>]}
[0m14:05:38.687085 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1114.84s]
[0m14:05:38.691579 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m14:05:38.697321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:38.698067 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m14:05:38.698592 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m14:05:38.699064 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m14:05:38.699518 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m14:05:38.701101 [info ] [MainThread]: 
[0m14:05:38.702404 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 40 minutes and 41.64 seconds (2441.64s).
[0m14:05:38.705091 [debug] [MainThread]: Command end result
[0m14:05:38.745208 [info ] [MainThread]: 
[0m14:05:38.745993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:38.746295 [info ] [MainThread]: 
[0m14:05:38.746789 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:05:38.749327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 45.459282, "process_user_time": 4.251518, "process_kernel_time": 1.931962, "process_mem_max_rss": "270380", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m14:05:38.750067 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:38.749947 after 45.46 seconds
[0m14:05:38.750635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb20c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbdb9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b8d10>]}
[0m14:05:38.751045 [debug] [MainThread]: Flushing usage events
[0m14:05:42.066311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcb714f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1afdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1afa40>]}


============================== 14:05:42.077370 | 70c3e2b3-74e5-4295-a8cd-ae30493ff6e2 ==============================
[0m14:05:42.077370 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:05:42.078651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.306108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70c3e2b3-74e5-4295-a8cd-ae30493ff6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb2a13a0>]}
[0m14:05:43.367662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70c3e2b3-74e5-4295-a8cd-ae30493ff6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd808bdd0>]}
[0m14:05:43.369024 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:05:43.391216 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:05:43.554089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:43.554938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:43.620408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70c3e2b3-74e5-4295-a8cd-ae30493ff6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf803e0>]}
[0m14:05:43.790786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70c3e2b3-74e5-4295-a8cd-ae30493ff6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da05f0>]}
[0m14:05:43.791835 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m14:05:43.793270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70c3e2b3-74e5-4295-a8cd-ae30493ff6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd809e0c0>]}
[0m14:05:43.797745 [info ] [MainThread]: 
[0m14:05:43.799725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:43.808945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m14:05:43.835937 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m14:05:43.836772 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m14:05:43.837551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:40.445741 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 18.232 seconds
[0m14:25:40.449389 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m14:25:40.610907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70c3e2b3-74e5-4295-a8cd-ae30493ff6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da12b0>]}
[0m14:25:40.611909 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:40.612918 [info ] [MainThread]: 
[0m14:25:40.621179 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m14:25:40.621647 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m14:25:40.622005 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m14:25:40.622387 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m14:25:40.622811 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m14:25:40.623132 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m14:25:40.623515 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m14:25:40.623984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m14:25:40.624388 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m14:25:40.625019 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m14:25:40.625523 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m14:25:40.625964 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m14:25:40.626427 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m14:25:40.626757 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m14:25:40.627102 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m14:25:40.639840 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m14:25:40.640272 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m14:25:40.643539 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m14:25:40.647456 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m14:25:40.650612 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m14:25:40.651456 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m14:25:40.664309 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m14:25:40.664766 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m14:25:40.667836 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m14:25:40.669660 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m14:25:40.670014 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m14:25:40.671810 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m14:25:40.673906 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m14:25:40.675045 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m14:25:40.675489 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m14:25:40.676041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:40.676645 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m14:25:40.677199 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m14:25:40.678466 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m14:25:40.679503 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m14:25:40.680148 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m14:25:40.680717 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m14:25:40.681475 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:40.682530 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:40.682896 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:41.230036 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m14:25:41.240377 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m14:25:41.247183 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m14:25:41.248824 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m14:25:41.366665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m14:25:41.368937 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m14:25:41.401881 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.78s]
[0m14:25:41.403233 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m14:25:41.403769 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m14:25:41.404602 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.78s]
[0m14:25:41.405078 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m14:25:41.405768 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m14:25:41.406228 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m14:25:41.406757 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m14:25:41.407148 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m14:25:41.407563 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m14:25:41.411490 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m14:25:41.411886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m14:25:41.412436 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m14:25:41.415511 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m14:25:41.416115 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m14:25:41.417939 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m14:25:41.418447 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m14:25:41.420917 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m14:25:41.421624 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m14:25:41.422000 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m14:25:41.422295 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:25:41.423308 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m14:25:41.424290 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m14:25:41.424661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:25:41.548283 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.92s]
[0m14:25:41.549438 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m14:25:41.549915 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m14:25:41.550327 [info ] [Thread-1 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m14:25:41.550864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m14:25:41.551205 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m14:25:41.554520 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m14:25:41.555421 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m14:25:41.557256 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m14:25:41.558220 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m14:25:41.558611 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m14:25:41.558909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:41.805188 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.123 seconds
[0m14:25:41.810986 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m14:25:41.842714 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.420 seconds
[0m14:25:41.846898 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m14:25:41.859415 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m14:25:41.862562 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m14:25:42.000802 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 1.38s]
[0m14:25:42.002454 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m14:25:42.003262 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m14:25:42.004001 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m14:25:42.005065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m14:25:42.005904 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m14:25:42.011649 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m14:25:42.012995 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m14:25:42.015857 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m14:25:42.017182 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m14:25:42.017657 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m14:25:42.018065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:25:42.028183 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.62s]
[0m14:25:42.029296 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m14:25:42.029862 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m14:25:42.030392 [info ] [Thread-3 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m14:25:42.031134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m14:25:42.031815 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.62s]
[0m14:25:42.032224 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m14:25:42.032815 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m14:25:42.036775 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m14:25:42.037274 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m14:25:42.037872 [info ] [Thread-4 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m14:25:42.038463 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m14:25:42.039626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m14:25:42.040016 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m14:25:42.040411 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m14:25:42.042219 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m14:25:42.045530 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m14:25:42.047537 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m14:25:42.050160 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m14:25:42.050851 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m14:25:42.052666 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m14:25:42.053070 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m14:25:42.053581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:25:42.055286 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m14:25:42.055706 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m14:25:42.056018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:25:42.213860 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.66s]
[0m14:25:42.215035 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m14:25:42.215575 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m14:25:42.216030 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m14:25:42.216631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m14:25:42.217058 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m14:25:42.222197 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m14:25:42.223188 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m14:25:42.225501 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m14:25:42.226740 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m14:25:42.227191 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m14:25:42.227628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:59.403674 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 17.350 seconds
[0m14:25:59.406890 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m14:25:59.407501 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 17.389 seconds
[0m14:25:59.410390 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m14:25:59.579898 [info ] [Thread-3 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 17.55s]
[0m14:25:59.581737 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m14:25:59.582278 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m14:25:59.582829 [info ] [Thread-3 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m14:25:59.583456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m14:25:59.583847 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m14:25:59.588562 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m14:25:59.589471 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m14:25:59.591653 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m14:25:59.592718 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m14:25:59.593147 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m14:25:59.593534 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:25:59.603548 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 17.60s]
[0m14:25:59.604540 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m14:25:59.605000 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m14:25:59.605482 [info ] [Thread-2 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m14:25:59.606077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m14:25:59.606435 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m14:25:59.609834 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m14:25:59.610635 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m14:25:59.612439 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m14:25:59.613579 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m14:25:59.613971 [debug] [Thread-2 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m14:25:59.614307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:25:59.698162 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 17.642 seconds
[0m14:25:59.700427 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m14:25:59.876844 [info ] [Thread-4 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 17.84s]
[0m14:25:59.880730 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m14:25:59.881855 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m14:25:59.882871 [info ] [Thread-4 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m14:25:59.884301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m14:25:59.885040 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m14:25:59.894974 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m14:25:59.896341 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m14:25:59.899244 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m14:25:59.900711 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m14:25:59.901235 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:25:59.901814 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:00.172915 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m14:26:00.177061 [debug] [Thread-2 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m14:26:00.386283 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m14:26:00.388997 [info ] [Thread-2 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.78s]
[0m14:26:00.395134 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m14:26:00.397317 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m14:26:00.401927 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m14:26:00.403000 [info ] [Thread-2 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m14:26:00.404045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m14:26:00.404797 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m14:26:00.411301 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m14:26:00.412872 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m14:26:00.415999 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m14:26:00.417678 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m14:26:00.418288 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:00.418874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:00.557428 [info ] [Thread-4 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.67s]
[0m14:26:00.558610 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m14:26:00.559669 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m14:26:00.560240 [info ] [Thread-4 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m14:26:00.561382 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.968 seconds
[0m14:26:00.562062 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m14:26:00.564696 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m14:26:00.565481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 18.338 seconds
[0m14:26:00.566042 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m14:26:00.569334 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m14:26:00.574409 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m14:26:00.577282 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m14:26:00.579454 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m14:26:00.580641 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m14:26:00.581116 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:00.581662 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:00.749581 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 18.53s]
[0m14:26:00.750744 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m14:26:00.751288 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m14:26:00.751785 [info ] [Thread-1 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m14:26:00.752512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m14:26:00.752956 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m14:26:00.757228 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m14:26:00.758270 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m14:26:00.760532 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m14:26:00.761666 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m14:26:00.762075 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:00.762445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:00.766557 [info ] [Thread-3 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 1.18s]
[0m14:26:00.767647 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m14:26:00.768114 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m14:26:00.768545 [info ] [Thread-3 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m14:26:00.769139 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m14:26:00.769495 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m14:26:00.772923 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m14:26:00.773655 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m14:26:00.775510 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m14:26:00.776396 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m14:26:00.776725 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:00.777018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:26:01.222475 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m14:26:01.228033 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m14:26:01.382599 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m14:26:01.388973 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m14:26:01.482496 [info ] [Thread-2 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 1.08s]
[0m14:26:01.486051 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m14:26:01.687302 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.910 seconds
[0m14:26:01.693239 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m14:26:01.868824 [info ] [Thread-3 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.10s]
[0m14:26:01.893171 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m14:26:02.004266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.242 seconds
[0m14:26:02.006819 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m14:26:02.042604 [info ] [Thread-4 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 1.48s]
[0m14:26:02.044748 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m14:26:02.173054 [info ] [Thread-1 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.42s]
[0m14:26:02.174938 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m14:26:02.178464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:02.178982 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m14:26:02.179391 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m14:26:02.179745 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m14:26:02.180040 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m14:26:02.180549 [info ] [MainThread]: 
[0m14:26:02.181424 [info ] [MainThread]: Finished running 18 data tests in 0 hours 20 minutes and 18.38 seconds (1218.38s).
[0m14:26:02.184424 [debug] [MainThread]: Command end result
[0m14:26:02.283243 [info ] [MainThread]: 
[0m14:26:02.284122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:02.284548 [info ] [MainThread]: 
[0m14:26:02.285082 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m14:26:02.286665 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 41.894913, "process_user_time": 5.113506, "process_kernel_time": 2.052462, "process_mem_max_rss": "274156", "process_in_blocks": "32", "process_out_blocks": "2222"}
[0m14:26:02.287105 [debug] [MainThread]: Command `dbt test` succeeded at 14:26:02.287030 after 41.90 seconds
[0m14:26:02.287445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcb714f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb98c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe0a9c0>]}
[0m14:26:02.287736 [debug] [MainThread]: Flushing usage events
[0m14:26:06.564553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe0a13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb0be990>]}


============================== 14:26:06.573328 | 72b760a7-b614-4945-bbd2-5915b0fd8717 ==============================
[0m14:26:06.573328 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:26:06.574406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:26:07.400472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabc8500>]}
[0m14:26:07.434588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabee7b0>]}
[0m14:26:07.435512 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:26:07.450598 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:26:07.569338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:07.570058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:07.609249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd82067b0>]}
[0m14:26:07.692693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e88800>]}
[0m14:26:07.693266 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m14:26:07.693997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabca960>]}
[0m14:26:07.696107 [info ] [MainThread]: 
[0m14:26:07.696931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:26:07.701062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m14:26:07.713165 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m14:26:07.713664 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m14:26:07.714021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:09.178508 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.464 seconds
[0m14:26:09.181328 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m14:26:09.379404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m14:26:09.394313 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m14:26:09.394860 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m14:26:09.395198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:36.945683 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.567 seconds
[0m14:44:36.952018 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m14:44:37.200337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd80836b0>]}
[0m14:44:37.202473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:37.206303 [info ] [MainThread]: 
[0m14:44:37.230348 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m14:44:37.232434 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m14:44:37.235140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m14:44:37.236551 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m14:44:37.259171 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m14:44:37.272115 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m14:44:37.306016 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m14:44:37.309404 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m14:44:37.310116 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m14:44:37.310714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:37.995825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m14:44:38.015724 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m14:44:38.260011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398b00>]}
[0m14:44:38.260809 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m14:44:38.262204 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m14:44:38.263661 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m14:44:38.264228 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m14:44:38.264989 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m14:44:38.265327 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m14:44:38.272500 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m14:44:38.273423 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m14:44:38.298436 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:44:38.299016 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m14:44:38.299442 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:44:56.030283 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 17.730 seconds
[0m14:44:56.057215 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:44:56.058389 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m14:44:56.236543 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.177 seconds
[0m14:44:56.248090 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:44:56.248741 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m14:44:56.388628 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.139 seconds
[0m14:44:56.417152 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:44:56.417723 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m14:44:56.573004 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.155 seconds
[0m14:44:56.579213 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:44:56.580529 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m14:44:56.686814 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.106 seconds
[0m14:44:56.697232 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:44:56.719152 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m14:44:56.721120 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:44:56.721523 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m14:44:56.894016 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m14:44:56.894577 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:44:56.895049 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m14:45:00.685856 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 3.790 seconds
[0m14:45:00.687901 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m14:45:00.688550 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m15:09:17.400997 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 17.711 seconds
[0m15:09:17.422293 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m15:09:17.430905 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m15:09:17.431533 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m15:09:18.989205 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.556 seconds
[0m15:09:18.997076 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m15:09:19.727068 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34f8b90>]}
[0m15:09:19.729867 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 1481.46s]
[0m15:09:19.734768 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m15:09:19.738091 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m15:09:19.739150 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m15:09:19.740294 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m15:09:19.741938 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m15:09:19.744068 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m15:09:19.745305 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m15:09:19.746796 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m15:09:19.747980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m15:09:19.749141 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m15:09:19.750000 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m15:09:19.750825 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m15:09:19.751548 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m15:09:19.758149 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m15:09:19.764234 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m15:09:19.768155 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m15:09:19.769582 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m15:09:19.770036 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m15:09:19.774973 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:09:19.775383 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m15:09:19.790164 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m15:09:19.794276 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m15:09:19.796340 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m15:09:19.796796 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:09:19.799838 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m15:09:19.801993 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m15:09:19.802422 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m15:09:19.803039 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m15:09:19.803503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:19.803864 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:09:20.687141 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m15:09:20.694754 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:09:20.695853 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m15:09:20.934141 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.237 seconds
[0m15:09:20.942150 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:09:20.942971 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m15:09:21.142493 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.199 seconds
[0m15:09:21.150824 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:09:21.151756 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m15:09:21.295963 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.143 seconds
[0m15:09:21.303775 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:09:21.304545 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m15:09:21.448686 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.143 seconds
[0m15:09:21.457354 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:09:21.460986 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m15:09:21.465316 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:09:21.466028 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m15:09:21.647890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m15:09:21.649846 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:09:21.651533 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m15:09:21.869424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.066 seconds
[0m15:09:21.871490 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m15:09:22.069467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3317d10>]}
[0m15:09:22.072345 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.32s]
[0m15:09:22.076494 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m15:09:22.270290 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.466 seconds
[0m15:09:22.277877 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m15:09:22.464666 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd330ea20>]}
[0m15:09:22.466999 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.71s]
[0m15:09:22.469963 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m15:39:50.348767 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 16.571 seconds
[0m15:39:50.349909 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:39:50.350365 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m15:39:50.844528 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m15:39:50.854961 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m15:39:50.858268 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m15:39:50.859580 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m15:39:51.126136 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m15:39:51.129818 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m15:39:51.336836 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b760a7-b614-4945-bbd2-5915b0fd8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd020b8f0>]}
[0m15:39:51.339563 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 1831.59s]
[0m15:39:51.343293 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m15:39:51.347674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:51.348287 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m15:39:51.348674 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m15:39:51.349034 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m15:39:51.349366 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m15:39:51.350240 [info ] [MainThread]: 
[0m15:39:51.351164 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 1 hours 13 minutes and 43.65 seconds (4423.65s).
[0m15:39:51.354679 [debug] [MainThread]: Command end result
[0m15:39:51.393205 [info ] [MainThread]: 
[0m15:39:51.394125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:51.394478 [info ] [MainThread]: 
[0m15:39:51.395086 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:39:51.397533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 66.766426, "process_user_time": 4.644604, "process_kernel_time": 1.933266, "process_mem_max_rss": "269252", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m15:39:51.398369 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:51.398265 after 66.77 seconds
[0m15:39:51.398907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf5f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb617560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3edbc80>]}
[0m15:39:51.399262 [debug] [MainThread]: Flushing usage events
[0m15:39:54.576194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc8c20>]}


============================== 15:39:54.585059 | 260efc5f-b767-432a-87d3-825a643cccf9 ==============================
[0m15:39:54.585059 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:39:54.586238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:39:55.410318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '260efc5f-b767-432a-87d3-825a643cccf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839e990>]}
[0m15:39:55.444411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '260efc5f-b767-432a-87d3-825a643cccf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb119ca0>]}
[0m15:39:55.445326 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:39:55.460104 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m15:39:55.547666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:55.548153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:55.579602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '260efc5f-b767-432a-87d3-825a643cccf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e87f80>]}
[0m15:39:55.668425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '260efc5f-b767-432a-87d3-825a643cccf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81da8d0>]}
[0m15:39:55.669078 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m15:39:55.669826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '260efc5f-b767-432a-87d3-825a643cccf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafcfe00>]}
[0m15:39:55.672130 [info ] [MainThread]: 
[0m15:39:55.672889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:39:55.676690 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m15:39:55.688780 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m15:39:55.689163 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m15:39:55.689462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:57.571361 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.881 seconds
[0m15:39:57.583347 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m15:39:57.800571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '260efc5f-b767-432a-87d3-825a643cccf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd80a1760>]}
[0m15:39:57.801796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:57.803179 [info ] [MainThread]: 
[0m15:39:57.815123 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m15:39:57.815798 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m15:39:57.816458 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m15:39:57.817178 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m15:39:57.817815 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m15:39:57.818322 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m15:39:57.818991 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m15:39:57.819894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m15:39:57.820496 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m15:39:57.821408 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m15:39:57.822141 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m15:39:57.822739 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m15:39:57.823408 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m15:39:57.823913 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m15:39:57.824423 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m15:39:57.838877 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m15:39:57.844769 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m15:39:57.849273 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m15:39:57.853678 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m15:39:57.859109 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m15:39:57.860864 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m15:39:57.861359 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m15:39:57.871016 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m15:39:57.906579 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m15:39:57.920525 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m15:39:57.914708 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m15:39:57.921363 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m15:39:57.925067 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m15:39:57.926078 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m15:39:57.927338 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m15:39:57.928375 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m15:39:57.929385 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:39:57.930600 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m15:39:57.931143 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m15:39:57.934130 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m15:39:57.936925 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m15:39:57.937724 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:39:57.938581 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m15:39:57.939305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:57.942028 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:39:58.968598 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.027 seconds
[0m15:39:58.981200 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m15:39:59.169893 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 1.35s]
[0m15:39:59.173155 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m15:39:59.174049 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m15:39:59.174933 [info ] [Thread-4 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m15:39:59.175878 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m15:39:59.176487 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m15:39:59.183435 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m15:39:59.185006 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m15:39:59.187937 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m15:39:59.189489 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m15:39:59.190089 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m15:39:59.190608 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:39:59.435149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m15:39:59.437346 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.499 seconds
[0m15:39:59.442544 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m15:39:59.445950 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m15:39:59.492427 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.563 seconds
[0m15:39:59.496595 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m15:39:59.652201 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 1.83s]
[0m15:39:59.654196 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m15:39:59.655259 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m15:39:59.656190 [info ] [Thread-1 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m15:39:59.657498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m15:39:59.658732 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 1.84s]
[0m15:39:59.659379 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m15:39:59.660260 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m15:39:59.668213 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m15:39:59.669025 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m15:39:59.669878 [info ] [Thread-3 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m15:39:59.671044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m15:39:59.671579 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m15:39:59.676321 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m15:39:59.676817 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m15:39:59.679840 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m15:39:59.680701 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m15:39:59.683030 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m15:39:59.683503 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m15:39:59.687497 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m15:39:59.688227 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m15:39:59.688900 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m15:39:59.689297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:59.690467 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m15:39:59.691449 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m15:39:59.691932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:39:59.708037 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 1.89s]
[0m15:39:59.709086 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m15:39:59.709546 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m15:39:59.709986 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m15:39:59.710600 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m15:39:59.710991 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m15:39:59.714574 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m15:39:59.715524 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m15:39:59.717419 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m15:39:59.718459 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m15:39:59.718867 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m15:39:59.719238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:39:59.884982 [info ] [Thread-4 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.71s]
[0m15:39:59.890308 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m15:39:59.893300 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m15:39:59.893826 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m15:39:59.894517 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m15:39:59.894939 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m15:39:59.898855 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m15:39:59.899866 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m15:39:59.902350 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m15:39:59.903637 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m15:39:59.904016 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m15:39:59.904456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:00.153342 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m15:40:00.156947 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m15:40:00.159143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m15:40:00.161620 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m15:40:00.322014 [info ] [Thread-1 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.66s]
[0m15:40:00.325466 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m15:40:00.328319 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m15:40:00.329781 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m15:40:00.332527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m15:40:00.334409 [info ] [Thread-3 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.66s]
[0m15:40:00.335330 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m15:40:00.336682 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m15:40:00.344020 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m15:40:00.344982 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m15:40:00.345927 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m15:40:00.346880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m15:40:00.347474 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m15:40:00.352422 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m15:40:00.352953 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m15:40:00.357730 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m15:40:00.358660 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m15:40:00.361268 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m15:40:00.362021 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m15:40:00.362559 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m15:40:00.363012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:00.364943 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m15:40:00.365696 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m15:40:00.366225 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:00.372841 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m15:40:00.374873 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m15:40:01.181983 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.277 seconds
[0m15:40:01.184678 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m15:40:01.302535 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.59s]
[0m15:40:01.305253 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m15:40:01.306246 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m15:40:01.307037 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m15:40:01.308041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m15:40:01.308641 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m15:40:01.314908 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m15:40:01.316281 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m15:40:01.319991 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m15:40:01.321611 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m15:40:01.322152 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m15:40:01.322654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:01.376254 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 1.48s]
[0m15:40:01.378009 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m15:40:01.378653 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m15:40:01.379185 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m15:40:01.379939 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m15:40:01.380417 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m15:40:01.385072 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m15:40:01.389462 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m15:40:01.391646 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m15:40:01.392737 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m15:40:01.393137 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m15:40:01.393542 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:01.890820 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.524 seconds
[0m15:40:01.898476 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m15:40:01.900935 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m15:40:01.909089 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m15:40:01.914366 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m15:40:01.917802 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m15:40:02.115979 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 1.77s]
[0m15:40:02.118353 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.74s]
[0m15:40:02.121440 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m15:40:02.123145 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m15:40:02.124597 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m15:40:02.126013 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m15:40:02.127074 [info ] [Thread-3 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m15:40:02.128181 [info ] [Thread-4 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m15:40:02.129546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m15:40:02.130482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m15:40:02.131285 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m15:40:02.132022 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m15:40:02.142213 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m15:40:02.146997 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m15:40:02.148457 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m15:40:02.148962 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m15:40:02.151720 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m15:40:02.154132 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m15:40:02.155506 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m15:40:02.156035 [debug] [Thread-3 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:02.156851 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m15:40:02.157248 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:02.157719 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:02.159390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:02.832149 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m15:40:02.840555 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m15:40:03.020698 [info ] [Thread-4 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.89s]
[0m15:40:03.025930 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m15:40:03.028076 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m15:40:03.030060 [info ] [Thread-4 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m15:40:03.032960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m15:40:03.034288 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m15:40:03.044351 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m15:40:03.046174 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m15:40:03.049515 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m15:40:03.051433 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m15:40:03.052088 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:03.052690 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:03.412569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.049 seconds
[0m15:40:03.418472 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m15:40:04.205562 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 2.90s]
[0m15:40:04.210237 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m15:40:04.212112 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m15:40:04.213369 [info ] [Thread-2 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m15:40:04.216426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m15:40:04.218017 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m15:40:04.226062 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m15:40:04.227649 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m15:40:04.230951 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m15:40:04.232760 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m15:40:04.233461 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:04.234195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:04.359057 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 4.03s]
[0m15:40:04.360306 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m15:40:04.360924 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m15:40:04.361431 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m15:40:04.362114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m15:40:04.362667 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m15:40:04.367138 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m15:40:04.368170 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m15:40:04.370484 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m15:40:04.371675 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m15:40:04.372096 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:04.372456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:04.580523 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.423 seconds
[0m15:40:04.584704 [debug] [Thread-3 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m15:40:04.768255 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.715 seconds
[0m15:40:04.774246 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m15:40:04.783285 [info ] [Thread-3 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 2.65s]
[0m15:40:04.786166 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m15:40:04.953509 [info ] [Thread-4 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 1.92s]
[0m15:40:04.958778 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m15:40:05.419266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.185 seconds
[0m15:40:05.425483 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m15:40:05.594976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.222 seconds
[0m15:40:05.600836 [info ] [Thread-2 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.38s]
[0m15:40:05.607846 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m15:40:05.610112 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m15:40:05.919718 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.56s]
[0m15:40:05.921682 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m15:40:05.925039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:05.925489 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m15:40:05.925822 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m15:40:05.926157 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6' was properly closed.
[0m15:40:05.926576 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m15:40:05.927091 [info ] [MainThread]: 
[0m15:40:05.927816 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m15:40:05.930429 [debug] [MainThread]: Command end result
[0m15:40:06.078017 [info ] [MainThread]: 
[0m15:40:06.079063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:06.079614 [info ] [MainThread]: 
[0m15:40:06.080096 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m15:40:06.081750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.546781, "process_user_time": 4.8101, "process_kernel_time": 1.958709, "process_mem_max_rss": "268992", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m15:40:06.082362 [debug] [MainThread]: Command `dbt test` succeeded at 15:40:06.082238 after 11.55 seconds
[0m15:40:06.082831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbcbdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd594920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda23b4d0>]}
[0m15:40:06.083230 [debug] [MainThread]: Flushing usage events
[0m15:40:10.546208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1e7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcb71580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7ac440>]}


============================== 15:40:10.555191 | 7c6115d5-303f-4749-a63f-330e2a63ede1 ==============================
[0m15:40:10.555191 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:40:10.556266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:40:11.333571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd86a85f0>]}
[0m15:40:11.363571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb6636e0>]}
[0m15:40:11.364233 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:40:11.376476 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m15:40:11.452123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:11.452535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:11.478429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8226390>]}
[0m15:40:11.546534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e395b0>]}
[0m15:40:11.547014 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m15:40:11.547713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8217950>]}
[0m15:40:11.549472 [info ] [MainThread]: 
[0m15:40:11.550181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:11.553597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m15:40:11.563545 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m15:40:11.563859 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m15:40:11.564285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:12.701946 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.137 seconds
[0m15:40:12.705757 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m15:40:12.984277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m15:40:13.002954 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m15:40:13.003630 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m15:40:13.004188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:13.617890 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.613 seconds
[0m15:40:13.626635 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m15:40:13.932597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8391ee0>]}
[0m15:40:13.934037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:13.935613 [info ] [MainThread]: 
[0m15:40:13.949530 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m15:40:13.950496 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m15:40:13.951397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m15:40:13.951933 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m15:40:13.960296 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m15:40:13.961398 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m15:40:13.984669 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m15:40:13.987306 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m15:40:13.987771 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m15:40:13.988187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:14.983387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.995 seconds
[0m15:40:15.014179 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m16:11:13.940881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8329010>]}
[0m16:11:13.943365 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1859.98s]
[0m16:11:13.945054 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m16:11:13.948458 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m16:11:13.949057 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m16:11:13.949851 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m16:11:13.950284 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m16:11:13.960837 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m16:11:13.961914 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m16:11:13.988551 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:13.989099 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m16:11:13.989464 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:14.706521 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m16:11:14.729930 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:14.731096 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:11:14.853439 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.121 seconds
[0m16:11:14.866472 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:14.867764 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m16:11:14.980851 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.112 seconds
[0m16:11:15.006737 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:15.007675 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:11:15.168593 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.160 seconds
[0m16:11:15.180883 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:15.182410 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m16:11:15.332551 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.149 seconds
[0m16:11:15.359039 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:11:15.390146 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m16:11:15.392368 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:15.392837 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m16:11:15.603745 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m16:11:15.604820 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:15.605704 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m16:11:17.585710 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.979 seconds
[0m16:11:17.587076 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:17.588013 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m16:11:17.946199 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m16:11:17.969042 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:11:17.978997 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:17.979750 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m16:11:18.207200 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m16:11:18.213595 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m16:11:18.432936 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd35622a0>]}
[0m16:11:18.435161 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 4.48s]
[0m16:11:18.437222 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m16:11:18.440145 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m16:11:18.441894 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:18.442964 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m16:11:18.443960 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m16:11:18.445247 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m16:11:18.445874 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m16:11:18.446556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m16:11:18.447097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m16:11:18.447591 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m16:11:18.447995 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m16:11:18.448389 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:18.448744 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m16:11:18.454147 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m16:11:18.458852 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:11:18.463120 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m16:11:18.465433 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m16:11:18.465956 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:18.466304 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m16:11:18.470475 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:18.504802 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m16:11:18.505881 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:11:18.506374 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m16:11:18.507811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:18.511662 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m16:11:18.513360 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:11:18.513880 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m16:11:18.514784 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m16:11:18.515356 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:18.515865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:19.307457 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m16:11:19.314731 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:19.316264 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:11:19.448945 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.131 seconds
[0m16:11:19.459479 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:19.460750 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m16:11:19.564972 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.103 seconds
[0m16:11:19.575458 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:19.576813 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:11:19.743835 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.166 seconds
[0m16:11:19.754994 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:19.756571 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m16:11:19.904420 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.146 seconds
[0m16:11:19.919315 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:11:19.923260 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m16:11:19.927682 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:19.928335 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m16:11:20.124394 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m16:11:20.125800 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:20.127228 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m16:11:20.198435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.682 seconds
[0m16:11:20.201657 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m16:11:20.282026 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.766 seconds
[0m16:11:20.286460 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m16:11:20.368298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd35f9cd0>]}
[0m16:11:20.370543 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.92s]
[0m16:11:20.373317 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:20.504855 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3435640>]}
[0m16:11:20.507079 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.06s]
[0m16:11:20.510191 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m16:11:21.589066 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.460 seconds
[0m16:11:21.590240 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:21.590626 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m16:11:21.976369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m16:11:21.991017 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:11:21.993213 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:21.993754 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m16:11:22.164888 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m16:11:22.170871 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m16:11:22.341353 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6115d5-303f-4749-a63f-330e2a63ede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2badd30>]}
[0m16:11:22.344080 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.89s]
[0m16:11:22.347846 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m16:11:22.354739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:22.356734 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m16:11:22.357603 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m16:11:22.358341 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m16:11:22.358975 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m16:11:22.360659 [info ] [MainThread]: 
[0m16:11:22.362364 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 31 minutes and 10.81 seconds (1870.81s).
[0m16:11:22.365223 [debug] [MainThread]: Command end result
[0m16:11:22.407669 [info ] [MainThread]: 
[0m16:11:22.408604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:22.409009 [info ] [MainThread]: 
[0m16:11:22.409557 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:11:22.412025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.0736, "process_user_time": 4.226484, "process_kernel_time": 1.861887, "process_mem_max_rss": "267728", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m16:11:22.412842 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:22.412743 after 20.08 seconds
[0m16:11:22.413402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1e7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb90fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7f8740>]}
[0m16:11:22.413746 [debug] [MainThread]: Flushing usage events
[0m16:11:25.446638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723350>]}


============================== 16:11:25.455358 | a7969aa7-0258-49de-9448-b0f364299da1 ==============================
[0m16:11:25.455358 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:11:25.456354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:26.243104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7969aa7-0258-49de-9448-b0f364299da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8516f60>]}
[0m16:11:26.271886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7969aa7-0258-49de-9448-b0f364299da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf80410>]}
[0m16:11:26.272448 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:11:26.285298 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:11:26.365749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:26.366171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:26.393344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7969aa7-0258-49de-9448-b0f364299da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e87f20>]}
[0m16:11:26.474273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7969aa7-0258-49de-9448-b0f364299da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da1220>]}
[0m16:11:26.474719 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:11:26.475410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7969aa7-0258-49de-9448-b0f364299da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8475a00>]}
[0m16:11:26.477517 [info ] [MainThread]: 
[0m16:11:26.478180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:26.481930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:11:26.493181 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:11:26.493501 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:11:26.493834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:27.608301 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.114 seconds
[0m16:11:27.613202 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:11:27.820162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7969aa7-0258-49de-9448-b0f364299da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d87350>]}
[0m16:11:27.820789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:27.821452 [info ] [MainThread]: 
[0m16:11:27.828445 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:27.828876 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:27.829274 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:27.829676 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m16:11:27.830110 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:27.830412 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m16:11:27.830839 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m16:11:27.831355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m16:11:27.831796 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m16:11:27.832408 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m16:11:27.832851 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m16:11:27.833279 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:27.833724 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m16:11:27.834113 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:27.834446 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:27.845934 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:27.845738 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:11:27.848597 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:11:27.851129 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:11:27.854022 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:11:27.855228 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:27.855537 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:27.863454 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:27.868258 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:11:27.869874 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:11:27.870197 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:27.871726 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:11:27.873621 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:11:27.874467 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:11:27.874805 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m16:11:27.875178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:27.875708 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:11:27.876873 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:11:27.877754 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m16:11:27.878341 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:11:27.878948 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:11:27.879273 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:27.879656 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:27.880004 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m16:11:27.882812 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:28.402970 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m16:11:28.405368 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m16:11:28.433772 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m16:11:28.434540 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m16:11:28.562080 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m16:11:28.566998 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m16:11:28.656497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m16:11:28.659056 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.83s]
[0m16:11:28.661500 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.83s]
[0m16:11:28.666227 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m16:11:28.668227 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:28.669615 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:28.672123 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:28.673951 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:28.674549 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m16:11:28.675858 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m16:11:28.676908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m16:11:28.677711 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m16:11:28.678470 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:28.678905 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:28.683435 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:11:28.687817 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:11:28.688981 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:28.691073 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:11:28.691483 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:28.694846 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:11:28.695811 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:11:28.696206 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:11:28.696596 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:28.697266 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:11:28.699076 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:11:28.699841 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:28.775437 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.94s]
[0m16:11:28.777078 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:28.777858 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:28.778469 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m16:11:28.779149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m16:11:28.779682 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:28.785075 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:11:28.786367 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:28.788933 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:11:28.790258 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:11:28.790726 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:11:28.791161 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:28.996238 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 1.16s]
[0m16:11:28.997201 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:28.997641 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:28.998945 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m16:11:29.002623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m16:11:29.003098 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:29.010897 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:11:29.013501 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:29.015122 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:11:29.016271 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:11:29.016619 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:11:29.016935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:29.523475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m16:11:29.529362 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m16:11:29.536355 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m16:11:29.540248 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m16:11:29.703430 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m16:11:29.709325 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m16:11:29.863003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m16:11:29.866497 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 1.09s]
[0m16:11:29.873890 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m16:11:29.879641 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 1.20s]
[0m16:11:29.886403 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:29.895076 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:29.896719 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:29.898169 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:29.899278 [info ] [Thread-2 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m16:11:29.900864 [info ] [Thread-4 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m16:11:29.901646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m16:11:29.902213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m16:11:29.902701 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:29.903195 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:29.909106 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:11:29.913139 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:11:29.921617 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:29.922489 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:29.925152 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:11:29.927245 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:11:29.928666 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:11:29.929290 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:11:29.929653 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m16:11:29.930103 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:11:29.930474 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:29.930829 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:29.973117 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 1.30s]
[0m16:11:29.974478 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:29.974957 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:29.975370 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m16:11:29.975977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m16:11:29.976330 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:29.980059 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:11:29.981010 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:29.983885 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:11:29.984773 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:11:29.985104 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:11:29.985398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:30.276133 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.27s]
[0m16:11:30.282705 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:30.291866 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:11:30.295050 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m16:11:30.300969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m16:11:30.306603 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:11:30.314383 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:11:30.321872 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:11:30.324127 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:11:30.325265 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:11:30.325691 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:11:30.326158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:30.783899 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m16:11:30.788601 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m16:11:30.970163 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.039 seconds
[0m16:11:30.975445 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.044 seconds
[0m16:11:30.991494 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m16:11:30.995063 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m16:11:31.121853 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 1.15s]
[0m16:11:31.123617 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:31.124141 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:11:31.124825 [info ] [Thread-3 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m16:11:31.125657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m16:11:31.126446 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:11:31.131408 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:11:31.132491 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:11:31.135113 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:11:31.136109 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:11:31.136513 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:11:31.136863 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:31.293382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m16:11:31.298372 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m16:11:31.465604 [info ] [Thread-4 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 1.56s]
[0m16:11:31.467717 [info ] [Thread-2 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 1.57s]
[0m16:11:31.468993 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:31.470852 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:31.472347 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:11:31.473254 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:11:31.473985 [info ] [Thread-4 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m16:11:31.475105 [info ] [Thread-2 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m16:11:31.475938 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m16:11:31.476567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m16:11:31.477155 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:11:31.477681 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:11:31.485543 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:11:31.490102 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:11:31.491537 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:11:31.492000 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:11:31.494317 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:11:31.496498 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:11:31.498041 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:11:31.498802 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:11:31.499181 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:31.499624 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:31.500103 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:31.500466 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:31.628666 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 1.33s]
[0m16:11:31.629603 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:11:31.630019 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:11:31.630406 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m16:11:31.631041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m16:11:31.631357 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:11:31.635220 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:11:31.636041 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:11:31.637821 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:11:31.638771 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:11:31.639134 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:31.639451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:32.023950 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.886 seconds
[0m16:11:32.030057 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m16:11:32.224947 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m16:11:32.233808 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m16:11:32.228933 [info ] [Thread-3 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 1.10s]
[0m16:11:32.237612 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:11:32.239546 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:11:32.240405 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m16:11:32.241653 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m16:11:32.242282 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:11:32.248992 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:11:32.250389 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:11:32.253205 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:11:32.255023 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:11:32.255649 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:32.256174 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:32.424792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m16:11:32.427990 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m16:11:32.530491 [info ] [Thread-4 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 1.05s]
[0m16:11:32.531623 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:11:32.532124 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:11:32.532535 [info ] [Thread-4 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m16:11:32.533016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m16:11:32.533473 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:11:32.537184 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:11:32.538183 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:11:32.540113 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:11:32.541252 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:11:32.541686 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:32.542076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:32.598429 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.098 seconds
[0m16:11:32.600947 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m16:11:32.618898 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.99s]
[0m16:11:32.620300 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:11:32.819684 [info ] [Thread-2 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 1.34s]
[0m16:11:32.824748 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:11:32.925321 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m16:11:32.941747 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m16:11:33.129377 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.89s]
[0m16:11:33.132108 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:11:33.165908 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m16:11:33.171484 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m16:11:33.400708 [info ] [Thread-4 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.87s]
[0m16:11:33.403043 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:11:33.409670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:33.410200 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m16:11:33.410480 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m16:11:33.410772 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m16:11:33.411129 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m16:11:33.411831 [info ] [MainThread]: 
[0m16:11:33.412669 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 6.93 seconds (6.93s).
[0m16:11:33.415047 [debug] [MainThread]: Command end result
[0m16:11:33.535488 [info ] [MainThread]: 
[0m16:11:33.537579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:33.538823 [info ] [MainThread]: 
[0m16:11:33.540306 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m16:11:33.542484 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.137502, "process_user_time": 4.503043, "process_kernel_time": 1.924194, "process_mem_max_rss": "269060", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m16:11:33.543610 [debug] [MainThread]: Command `dbt test` succeeded at 16:11:33.543478 after 8.14 seconds
[0m16:11:33.544229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd854a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc417fb0>]}
[0m16:11:33.544708 [debug] [MainThread]: Flushing usage events
[0m16:11:39.081475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb173b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb171dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1733b0>]}


============================== 16:11:39.091003 | 80a77273-49bc-446b-ad2d-4829e586ba55 ==============================
[0m16:11:39.091003 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:11:39.092183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:11:40.102923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8361df0>]}
[0m16:11:40.133146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabc82c0>]}
[0m16:11:40.133799 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:11:40.147474 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:11:40.231133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:40.231906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:40.275177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda236f30>]}
[0m16:11:40.408138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e888f0>]}
[0m16:11:40.408792 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:11:40.409602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8e45850>]}
[0m16:11:40.412147 [info ] [MainThread]: 
[0m16:11:40.413195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:40.418676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m16:11:40.433508 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m16:11:40.434055 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m16:11:40.434548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:41.543314 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.109 seconds
[0m16:11:41.545721 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m16:11:41.720681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:11:41.728432 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:11:41.728939 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:11:41.729276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:42.313989 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.585 seconds
[0m16:11:42.316226 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:11:42.485912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5acfb0>]}
[0m16:11:42.486731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:42.487572 [info ] [MainThread]: 
[0m16:11:42.495098 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m16:11:42.495707 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m16:11:42.496448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m16:11:42.496786 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m16:11:42.502694 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m16:11:42.503595 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m16:11:42.522305 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m16:11:42.524679 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m16:11:42.525096 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m16:11:42.525481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:43.269224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m16:11:43.308418 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m16:11:43.533613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398c50>]}
[0m16:11:43.535109 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.03s]
[0m16:11:43.537125 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m16:11:43.539112 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m16:11:43.540335 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m16:11:43.541396 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m16:11:43.541974 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m16:11:43.552786 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m16:11:43.553947 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m16:11:43.582906 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:43.583418 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m16:11:43.583822 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:44.491920 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.908 seconds
[0m16:11:44.513748 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:44.514889 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:11:44.693002 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.177 seconds
[0m16:11:44.717405 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:44.718158 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m16:11:44.836219 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.117 seconds
[0m16:11:44.865046 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:44.865996 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:11:45.005226 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.138 seconds
[0m16:11:45.016899 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:45.019091 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m16:11:45.149006 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.128 seconds
[0m16:11:45.176847 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:11:45.206709 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m16:11:45.208804 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:45.209204 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m16:11:45.393147 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m16:11:45.394367 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:45.395284 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m16:11:46.867562 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.471 seconds
[0m16:11:46.869719 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:46.871143 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m16:11:47.206569 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m16:11:47.223658 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:11:47.231949 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:11:47.232603 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m16:11:47.443671 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m16:11:47.446425 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m16:11:47.639043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b41130>]}
[0m16:11:47.640542 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 4.10s]
[0m16:11:47.645165 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m16:11:47.646894 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m16:11:47.647549 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:47.648092 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m16:11:47.648739 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m16:11:47.649710 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m16:11:47.650439 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m16:11:47.651300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m16:11:47.651910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m16:11:47.652533 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m16:11:47.652998 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m16:11:47.653405 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:47.653823 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m16:11:47.658579 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m16:11:47.661359 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:11:47.665159 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m16:11:47.666303 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m16:11:47.670542 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:47.670905 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:47.671343 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m16:11:47.671764 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m16:11:47.687720 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:11:47.688138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:47.690086 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m16:11:47.693115 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:11:47.693544 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m16:11:47.695662 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m16:11:47.695976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:47.696511 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m16:11:47.698367 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:48.593399 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.904 seconds
[0m16:11:48.605685 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:48.606762 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:11:48.746866 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.139 seconds
[0m16:11:48.758866 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:48.760033 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m16:11:48.890752 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.129 seconds
[0m16:11:48.902378 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:48.903886 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:11:49.048941 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.143 seconds
[0m16:11:49.061558 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:49.062768 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m16:11:49.217710 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.154 seconds
[0m16:11:49.233450 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:11:49.238120 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m16:11:49.242673 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:49.243528 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m16:11:49.313656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.617 seconds
[0m16:11:49.318045 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m16:11:49.358411 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.660 seconds
[0m16:11:49.362202 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m16:11:49.387510 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m16:11:49.388413 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:49.389400 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m16:11:49.562915 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34da090>]}
[0m16:11:49.565284 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 1.91s]
[0m16:11:49.570234 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m16:11:50.367374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d2da00>]}
[0m16:11:50.369512 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.71s]
[0m16:11:50.371681 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:11:51.007580 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.617 seconds
[0m16:11:51.010045 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:51.011377 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m16:11:51.369888 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m16:11:51.377189 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:11:51.378792 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:11:51.379313 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m16:11:51.557671 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m16:11:51.559601 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m16:11:51.767156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a77273-49bc-446b-ad2d-4829e586ba55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd021a870>]}
[0m16:11:51.769493 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 4.11s]
[0m16:11:51.773346 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m16:11:51.778985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:51.780248 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m16:11:51.781048 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m16:11:51.781589 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m16:11:51.782283 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m16:11:51.783975 [info ] [MainThread]: 
[0m16:11:51.785770 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 11.37 seconds (11.37s).
[0m16:11:51.788495 [debug] [MainThread]: Command end result
[0m16:11:51.829066 [info ] [MainThread]: 
[0m16:11:51.829929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:51.830295 [info ] [MainThread]: 
[0m16:11:51.830964 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:11:51.833927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.802406, "process_user_time": 4.490003, "process_kernel_time": 1.895873, "process_mem_max_rss": "268080", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m16:11:51.834882 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:51.834752 after 12.80 seconds
[0m16:11:51.835521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabaa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa7f7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5cdeb0>]}
[0m16:11:51.835904 [debug] [MainThread]: Flushing usage events
[0m16:11:54.618261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb754860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd597ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb756e40>]}


============================== 16:11:54.626579 | af042b56-4e52-4a10-8dcc-02e01c8ca932 ==============================
[0m16:11:54.626579 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:11:54.627680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:55.395826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af042b56-4e52-4a10-8dcc-02e01c8ca932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe03ca570>]}
[0m16:11:55.425651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af042b56-4e52-4a10-8dcc-02e01c8ca932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda2553a0>]}
[0m16:11:55.426214 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:11:55.438903 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:11:55.515311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:55.515738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:55.543660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af042b56-4e52-4a10-8dcc-02e01c8ca932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8458980>]}
[0m16:11:55.617964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af042b56-4e52-4a10-8dcc-02e01c8ca932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da1520>]}
[0m16:11:55.618450 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:11:55.619323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af042b56-4e52-4a10-8dcc-02e01c8ca932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81a7e00>]}
[0m16:11:55.621373 [info ] [MainThread]: 
[0m16:11:55.622173 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:55.625885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:11:55.637417 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:11:55.637770 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:11:55.638085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:56.900440 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.262 seconds
[0m16:11:56.905545 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:11:57.126568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af042b56-4e52-4a10-8dcc-02e01c8ca932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8150f80>]}
[0m16:11:57.128601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:57.130685 [info ] [MainThread]: 
[0m16:11:57.147991 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:57.148601 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:57.149164 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:57.149827 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m16:11:57.150388 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:57.150857 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m16:11:57.151416 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m16:11:57.152196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m16:11:57.152705 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m16:11:57.153404 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m16:11:57.153994 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m16:11:57.154499 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:57.155072 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m16:11:57.155554 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:57.156000 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:57.169326 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:57.172023 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:11:57.175287 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:11:57.178604 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:11:57.182225 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:11:57.183584 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:57.189943 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:57.198591 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:11:57.200401 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:11:57.200743 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:57.201072 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:57.202902 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:11:57.204595 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:11:57.205299 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:11:57.206116 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:11:57.206454 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m16:11:57.206930 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m16:11:57.207531 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:11:57.208097 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:11:57.208415 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:57.208765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:57.209082 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m16:11:57.209435 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:11:57.212751 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:57.213145 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:57.730828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m16:11:57.750323 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m16:11:57.753445 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m16:11:57.756023 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m16:11:57.834836 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m16:11:57.837556 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m16:11:57.886739 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m16:11:57.888716 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m16:11:57.904864 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.75s]
[0m16:11:57.906367 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:11:57.906885 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:57.907385 [info ] [Thread-1 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m16:11:57.907990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m16:11:57.908350 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:57.912406 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:11:57.913980 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.76s]
[0m16:11:57.914343 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:57.914804 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:11:57.916640 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:11:57.917056 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:57.917559 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m16:11:57.918037 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m16:11:57.918920 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:11:57.919240 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:57.919598 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:11:57.924793 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:11:57.927281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:57.934013 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:57.938311 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:11:57.939610 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:11:57.940096 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:11:57.940775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:58.057964 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.90s]
[0m16:11:58.059095 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:11:58.059539 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:58.059944 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m16:11:58.060355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m16:11:58.060664 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:58.063712 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:11:58.064610 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:58.066301 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:11:58.067188 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:11:58.067587 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:11:58.067907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:58.389828 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m16:11:58.394025 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m16:11:58.546324 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.63s]
[0m16:11:58.547815 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:11:58.548695 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:58.549433 [info ] [Thread-4 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m16:11:58.550147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m16:11:58.550727 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:58.556234 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:11:58.557312 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:58.559951 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:11:58.561157 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:11:58.561653 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:11:58.562071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:58.614504 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m16:11:58.617494 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m16:11:58.904018 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 1.75s]
[0m16:11:58.906325 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:11:58.907382 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:58.908706 [info ] [Thread-3 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m16:11:58.910711 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m16:11:58.914557 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:58.923816 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:11:58.928536 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:58.931351 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:11:58.932541 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:11:58.932971 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m16:11:58.933341 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:58.990156 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.93s]
[0m16:11:58.991817 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:11:58.992535 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:58.993181 [info ] [Thread-2 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m16:11:58.993801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m16:11:58.994313 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:58.998869 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:11:59.003184 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:59.008369 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:11:59.009431 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:11:59.010204 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:11:59.010608 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:59.087773 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m16:11:59.090186 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m16:11:59.184660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.258 seconds
[0m16:11:59.187290 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m16:11:59.242652 [info ] [Thread-4 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.69s]
[0m16:11:59.244293 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:11:59.245136 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:59.245841 [info ] [Thread-4 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m16:11:59.246771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m16:11:59.247393 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:59.252837 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:11:59.257339 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:59.259884 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:11:59.261101 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:11:59.261626 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:11:59.263341 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:59.343372 [info ] [Thread-1 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 1.43s]
[0m16:11:59.345407 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:11:59.346064 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:11:59.346645 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m16:11:59.347552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m16:11:59.348165 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:11:59.355934 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:11:59.357326 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:11:59.360105 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:11:59.361392 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:11:59.361871 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:11:59.362315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:59.465193 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m16:11:59.467956 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m16:11:59.562052 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m16:11:59.564971 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m16:11:59.652951 [info ] [Thread-3 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.74s]
[0m16:11:59.654123 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:11:59.654892 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:11:59.655583 [info ] [Thread-3 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m16:11:59.656247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m16:11:59.656819 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:11:59.661961 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:11:59.663228 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:11:59.665699 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:11:59.666919 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:11:59.667351 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:11:59.667749 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:59.743189 [info ] [Thread-2 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.75s]
[0m16:11:59.745947 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:11:59.746668 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:11:59.747246 [info ] [Thread-2 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m16:11:59.747864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m16:11:59.748708 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:11:59.755865 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:11:59.756974 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:11:59.759406 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:11:59.760619 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:11:59.761074 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:59.761509 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:59.767537 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m16:11:59.769849 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m16:11:59.874551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m16:11:59.876951 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m16:11:59.931698 [info ] [Thread-4 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.68s]
[0m16:11:59.933051 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:11:59.933645 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:11:59.934125 [info ] [Thread-4 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m16:11:59.934873 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m16:11:59.935305 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:11:59.939482 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:11:59.940554 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:11:59.943903 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:11:59.944941 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:11:59.945302 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:59.945661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:00.082840 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.73s]
[0m16:12:00.085065 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:12:00.085869 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:12:00.086540 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m16:12:00.087414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m16:12:00.088024 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:12:00.093489 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:12:00.094736 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:12:00.097725 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:12:00.099066 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:12:00.099544 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:00.099947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:00.190112 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m16:12:00.192657 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m16:12:00.266842 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m16:12:00.271621 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m16:12:00.363283 [info ] [Thread-3 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.71s]
[0m16:12:00.365067 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:12:00.366022 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:12:00.366778 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m16:12:00.367856 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m16:12:00.368599 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:12:00.374703 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:12:00.376068 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:12:00.379020 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:12:00.380506 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:12:00.381024 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:00.381505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:00.454425 [info ] [Thread-2 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.71s]
[0m16:12:00.456647 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:12:00.457522 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:12:00.458282 [info ] [Thread-2 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m16:12:00.459304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m16:12:00.459895 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:12:00.465295 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:12:00.466954 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:12:00.469965 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:12:00.471454 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:12:00.472016 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:00.472584 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:00.547715 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m16:12:00.550984 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m16:12:00.716129 [info ] [Thread-4 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.78s]
[0m16:12:00.718440 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:12:00.741811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m16:12:00.744842 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m16:12:01.137385 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 1.05s]
[0m16:12:01.140152 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:12:01.314391 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.932 seconds
[0m16:12:01.320753 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m16:12:01.470126 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m16:12:01.473014 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m16:12:01.527235 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.16s]
[0m16:12:01.528269 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:12:01.649260 [info ] [Thread-2 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.19s]
[0m16:12:01.651020 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:12:01.654270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:01.654831 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m16:12:01.655260 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m16:12:01.655681 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m16:12:01.656021 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m16:12:01.656604 [info ] [MainThread]: 
[0m16:12:01.657132 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m16:12:01.660597 [debug] [MainThread]: Command end result
[0m16:12:01.751959 [info ] [MainThread]: 
[0m16:12:01.752872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:01.753317 [info ] [MainThread]: 
[0m16:12:01.753797 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m16:12:01.755041 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.1788716, "process_user_time": 4.250324, "process_kernel_time": 1.939097, "process_mem_max_rss": "268752", "process_out_blocks": "2223", "process_in_blocks": "0"}
[0m16:12:01.755443 [debug] [MainThread]: Command `dbt test` succeeded at 16:12:01.755374 after 7.18 seconds
[0m16:12:01.755833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd32e1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd32e03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd32e00b0>]}
[0m16:12:01.756188 [debug] [MainThread]: Flushing usage events
[0m16:15:02.418365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe0a13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc8ce0>]}


============================== 16:15:02.427995 | 4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1 ==============================
[0m16:15:02.427995 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:15:02.429029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:15:03.194835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>]}
[0m16:15:03.223474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839b740>]}
[0m16:15:03.224057 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:15:03.236464 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:15:03.315354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:03.315800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:03.342929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd97bcb90>]}
[0m16:15:03.413202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e88c80>]}
[0m16:15:03.413697 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:15:03.414354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafcf200>]}
[0m16:15:03.416073 [info ] [MainThread]: 
[0m16:15:03.416748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:15:03.420392 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m16:15:03.431104 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m16:15:03.431452 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m16:15:03.431757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:04.828965 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.396 seconds
[0m16:15:04.835225 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m16:15:05.035043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:15:05.052641 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:15:05.053603 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:15:05.054250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:05.684528 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.630 seconds
[0m16:15:05.689336 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:15:05.873777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8206c30>]}
[0m16:15:05.875449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:05.876740 [info ] [MainThread]: 
[0m16:15:05.890699 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m16:15:05.891598 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m16:15:05.892495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m16:15:05.892970 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m16:15:05.900618 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m16:15:05.901961 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m16:15:05.924977 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m16:15:05.927818 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m16:15:05.928280 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m16:15:05.928779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:06.937298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.008 seconds
[0m16:15:06.976644 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m16:15:07.343124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398d70>]}
[0m16:15:07.347542 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.45s]
[0m16:15:07.351360 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m16:15:07.354711 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m16:15:07.355815 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m16:15:07.357247 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m16:15:07.357854 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m16:15:07.370645 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m16:15:07.372136 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m16:15:07.401963 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:07.402447 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m16:15:07.402844 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:15:08.205785 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m16:15:08.226835 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:08.227817 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:15:08.423793 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.195 seconds
[0m16:15:08.436489 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:08.437444 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m16:15:08.571052 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.132 seconds
[0m16:15:08.598291 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:08.599015 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:15:08.754071 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.154 seconds
[0m16:15:08.761853 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:08.762627 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m16:15:08.877157 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.114 seconds
[0m16:15:08.894879 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:15:08.920587 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m16:15:08.923461 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:08.924008 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m16:15:09.116402 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m16:15:09.117114 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:09.117721 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m16:15:10.828668 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.710 seconds
[0m16:15:10.831019 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:10.832271 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m16:15:11.339990 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m16:15:11.362483 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:15:11.372492 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:15:11.373244 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m16:15:11.551094 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m16:15:11.552970 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m16:15:11.740997 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3499370>]}
[0m16:15:11.742036 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 4.38s]
[0m16:15:11.743315 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m16:15:11.744742 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m16:15:11.745299 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:15:11.745855 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m16:15:11.746514 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m16:15:11.747381 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m16:15:11.748094 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m16:15:11.748754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m16:15:11.749376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m16:15:11.750067 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m16:15:11.750577 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m16:15:11.751055 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m16:15:11.751540 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m16:15:11.755739 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m16:15:11.758497 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:15:11.762392 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m16:15:11.763629 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m16:15:11.764034 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m16:15:11.768262 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:11.775567 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m16:15:11.783290 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m16:15:11.785482 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:15:11.787469 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m16:15:11.787868 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:11.790773 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:15:11.791211 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m16:15:11.793255 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m16:15:11.793563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:11.794057 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m16:15:11.795802 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:15:12.530393 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m16:15:12.539985 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:12.541178 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:15:12.674654 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.132 seconds
[0m16:15:12.682746 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:12.683521 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m16:15:12.806546 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.122 seconds
[0m16:15:12.813905 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:12.814675 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:15:12.952804 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.137 seconds
[0m16:15:12.964503 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:12.965724 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m16:15:13.077698 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.111 seconds
[0m16:15:13.090956 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:15:13.095052 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m16:15:13.100528 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:13.101278 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m16:15:13.257155 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m16:15:13.259151 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:13.260910 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m16:15:13.896274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.102 seconds
[0m16:15:13.900255 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m16:15:14.107577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34f3d70>]}
[0m16:15:14.108924 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.36s]
[0m16:15:14.110011 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:15:14.282130 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.486 seconds
[0m16:15:14.289482 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m16:15:14.443739 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.181 seconds
[0m16:15:14.445824 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:14.447009 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m16:15:14.509038 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34db9b0>]}
[0m16:15:14.511860 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.76s]
[0m16:15:14.515041 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m16:15:14.902673 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m16:15:14.915829 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:15:14.918489 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:15:14.919381 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m16:15:15.147329 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m16:15:15.154684 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m16:15:15.335098 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4581d9e1-b6f5-49a2-b786-b4d94b2dbcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd020c2c0>]}
[0m16:15:15.337830 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.59s]
[0m16:15:15.340532 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m16:15:15.343944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:15.344743 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m16:15:15.345500 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m16:15:15.346238 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m16:15:15.346847 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m16:15:15.347972 [info ] [MainThread]: 
[0m16:15:15.349079 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 11.93 seconds (11.93s).
[0m16:15:15.351060 [debug] [MainThread]: Command end result
[0m16:15:15.386708 [info ] [MainThread]: 
[0m16:15:15.387358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:15.387659 [info ] [MainThread]: 
[0m16:15:15.388056 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:15:15.389404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.012157, "process_user_time": 4.10107, "process_kernel_time": 1.916891, "process_mem_max_rss": "268008", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m16:15:15.390060 [debug] [MainThread]: Command `dbt run` succeeded at 16:15:15.389943 after 13.01 seconds
[0m16:15:15.390490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda26c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b2c4a0>]}
[0m16:15:15.390885 [debug] [MainThread]: Flushing usage events
[0m16:15:18.530812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7a4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafbae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb088620>]}


============================== 16:15:18.539408 | 0f1fcac9-8dc0-4b0f-8a5f-63374ce7c19f ==============================
[0m16:15:18.539408 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:15:18.540475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:15:19.285555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f1fcac9-8dc0-4b0f-8a5f-63374ce7c19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb991610>]}
[0m16:15:19.314322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f1fcac9-8dc0-4b0f-8a5f-63374ce7c19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffac1c590>]}
[0m16:15:19.314874 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:15:19.326365 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:15:19.403662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:19.404080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:19.430775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1fcac9-8dc0-4b0f-8a5f-63374ce7c19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafbfd10>]}
[0m16:15:19.504304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1fcac9-8dc0-4b0f-8a5f-63374ce7c19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d40890>]}
[0m16:15:19.504784 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:15:19.505430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1fcac9-8dc0-4b0f-8a5f-63374ce7c19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd82cfe90>]}
[0m16:15:19.507463 [info ] [MainThread]: 
[0m16:15:19.508142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:15:19.511769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:15:19.523187 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:15:19.523519 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:15:19.523832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:20.676757 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.152 seconds
[0m16:15:20.684154 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:15:20.861182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1fcac9-8dc0-4b0f-8a5f-63374ce7c19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d27680>]}
[0m16:15:20.862361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:20.863680 [info ] [MainThread]: 
[0m16:15:20.876358 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:15:20.877034 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:15:20.877658 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:15:20.878282 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m16:15:20.878828 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:15:20.879258 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m16:15:20.879809 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m16:15:20.880440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m16:15:20.880988 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m16:15:20.881801 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m16:15:20.882393 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m16:15:20.882872 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:15:20.883422 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m16:15:20.883871 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:15:20.884283 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:15:20.898211 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:15:20.898644 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:15:20.901939 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:15:20.905042 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:15:20.908642 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:15:20.911089 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:15:20.911443 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:15:20.918111 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:15:20.928028 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:15:20.928979 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:15:20.929350 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:15:20.930966 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:15:20.933041 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:15:20.933953 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:15:20.934576 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:15:20.934964 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m16:15:20.935616 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:15:20.935918 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m16:15:20.936510 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:15:20.936816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:15:20.937181 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:15:20.937533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:20.937878 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m16:15:20.939402 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:15:20.940766 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:15:21.488008 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m16:15:21.501007 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m16:15:21.510267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m16:15:21.514110 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m16:15:21.535908 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m16:15:21.537604 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m16:15:21.540155 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m16:15:21.541664 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m16:15:21.668473 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.78s]
[0m16:15:21.670583 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:15:21.671369 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:15:21.672093 [info ] [Thread-4 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m16:15:21.672904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m16:15:21.673414 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:15:21.678621 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:15:21.680722 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:15:21.683180 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:15:21.684766 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:15:21.685306 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:15:21.685764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:21.693490 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.81s]
[0m16:15:21.694798 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:15:21.695313 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:15:21.695777 [info ] [Thread-1 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m16:15:21.696352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m16:15:21.696748 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:15:21.700658 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:15:21.701623 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:15:21.705175 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:15:21.706412 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.82s]
[0m16:15:21.707173 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:15:21.707778 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:15:21.708156 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:15:21.708550 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:15:21.708966 [info ] [Thread-3 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m16:15:21.709483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:21.709908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m16:15:21.711296 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:15:21.714803 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:15:21.716004 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:15:21.716729 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.83s]
[0m16:15:21.718599 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:15:21.719158 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:15:21.719654 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:15:21.720008 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m16:15:21.720445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m16:15:21.720866 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:15:21.721407 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:15:21.724374 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:15:21.724733 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:15:21.725134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:21.726314 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:15:21.728150 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:15:21.729148 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:15:21.729453 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:15:21.729832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:22.167128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m16:15:22.169176 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m16:15:22.215190 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m16:15:22.217322 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m16:15:22.270409 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m16:15:22.272842 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m16:15:22.359457 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m16:15:22.361766 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m16:15:22.447774 [info ] [Thread-1 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.75s]
[0m16:15:22.448522 [info ] [Thread-4 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.78s]
[0m16:15:22.449126 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:15:22.449646 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:15:22.450102 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:15:22.450514 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:15:22.450912 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m16:15:22.451346 [info ] [Thread-4 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m16:15:22.451784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m16:15:22.452216 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m16:15:22.452593 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:15:22.452978 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:15:22.456382 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:15:22.459064 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:15:22.461302 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:15:22.461594 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:15:22.463259 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:15:22.464940 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:15:22.465964 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:15:22.466501 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:15:22.466813 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:15:22.467149 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m16:15:22.467476 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:22.467791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:22.503683 [info ] [Thread-3 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.79s]
[0m16:15:22.504650 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:15:22.505042 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:15:22.505400 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m16:15:22.505958 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m16:15:22.506279 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:15:22.509086 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:15:22.509965 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:15:22.512672 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:15:22.513619 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:15:22.513968 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:15:22.514315 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:22.545377 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.82s]
[0m16:15:22.546233 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:15:22.546594 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:15:22.546976 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m16:15:22.547460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m16:15:22.547769 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:15:22.550603 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:15:22.551418 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:15:22.552996 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:15:22.553862 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:15:22.554178 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:15:22.554464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:23.005976 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.491 seconds
[0m16:15:23.008569 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m16:15:23.021388 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m16:15:23.023540 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m16:15:23.032478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m16:15:23.034511 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m16:15:23.068108 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m16:15:23.070451 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m16:15:23.201476 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.69s]
[0m16:15:23.205260 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:15:23.206591 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:15:23.207613 [info ] [Thread-3 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m16:15:23.209452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m16:15:23.211347 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:15:23.219553 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:15:23.221590 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.77s]
[0m16:15:23.223320 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:15:23.224040 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:15:23.224809 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:15:23.225421 [info ] [Thread-1 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m16:15:23.228787 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:15:23.229461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m16:15:23.230295 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:15:23.238162 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:15:23.239217 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:15:23.239754 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:15:23.240197 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:23.241861 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:15:23.244602 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:15:23.245752 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:15:23.246224 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:23.246727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:23.263310 [info ] [Thread-4 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.81s]
[0m16:15:23.264101 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:15:23.265115 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:15:23.265676 [info ] [Thread-4 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m16:15:23.266403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m16:15:23.267122 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.72s]
[0m16:15:23.267530 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:15:23.268117 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:15:23.271731 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:15:23.272206 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:15:23.272730 [info ] [Thread-2 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m16:15:23.273274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m16:15:23.273630 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:15:23.276664 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:15:23.277012 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:15:23.279000 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:15:23.279563 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:15:23.282282 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:15:23.283080 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:15:23.283488 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:23.283865 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:23.284565 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:15:23.285429 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:23.286343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:23.711822 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m16:15:23.717608 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m16:15:23.765371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m16:15:23.770512 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m16:15:23.863621 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m16:15:23.867889 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m16:15:23.881381 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m16:15:23.884232 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m16:15:23.901506 [info ] [Thread-3 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.69s]
[0m16:15:23.902731 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:15:23.903341 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:15:23.903883 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m16:15:23.904509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m16:15:23.904985 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:15:23.909611 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:15:23.910682 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:15:23.913042 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:15:23.914379 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:15:23.914855 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:23.915300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:23.949717 [info ] [Thread-1 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.72s]
[0m16:15:23.950933 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:15:23.951511 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:15:23.952085 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m16:15:23.952759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m16:15:23.953217 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:15:23.957455 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:15:23.958426 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:15:23.960646 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:15:23.961735 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:15:23.962125 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:23.962524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:24.031356 [info ] [Thread-2 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.76s]
[0m16:15:24.033032 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:15:24.090770 [info ] [Thread-4 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.82s]
[0m16:15:24.091566 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:15:24.607781 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m16:15:24.612853 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m16:15:24.742002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m16:15:24.747629 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m16:15:24.778761 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.87s]
[0m16:15:24.780392 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:15:24.946501 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.99s]
[0m16:15:24.948869 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:15:24.953120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:24.953902 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m16:15:24.954515 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m16:15:24.955084 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m16:15:24.955628 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m16:15:24.956453 [info ] [MainThread]: 
[0m16:15:24.957453 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m16:15:24.961462 [debug] [MainThread]: Command end result
[0m16:15:25.032774 [info ] [MainThread]: 
[0m16:15:25.033603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:25.033930 [info ] [MainThread]: 
[0m16:15:25.034303 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m16:15:25.035391 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.5454936, "process_user_time": 4.042095, "process_kernel_time": 1.883237, "process_mem_max_rss": "268660", "process_out_blocks": "2223", "process_in_blocks": "0"}
[0m16:15:25.035813 [debug] [MainThread]: Command `dbt test` succeeded at 16:15:25.035739 after 6.55 seconds
[0m16:15:25.036139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc2da270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8891160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7f9520>]}
[0m16:15:25.036423 [debug] [MainThread]: Flushing usage events
[0m16:33:40.200681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb172480>]}


============================== 16:33:40.219907 | 826369ff-4da2-44c0-8309-8faa1128a021 ==============================
[0m16:33:40.219907 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:33:40.222112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:33:41.863644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd84592b0>]}
[0m16:33:41.925930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8477260>]}
[0m16:33:41.927227 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:33:41.953717 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:33:42.112996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:42.113918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:42.170587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8dfe240>]}
[0m16:33:42.312748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e84aa0>]}
[0m16:33:42.313702 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:33:42.314901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ea5fd0>]}
[0m16:33:42.318203 [info ] [MainThread]: 
[0m16:33:42.319501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:42.326509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m16:33:42.347513 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m16:33:42.348157 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m16:33:42.348728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:43.576315 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.227 seconds
[0m16:33:43.582526 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m16:33:43.785920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:33:43.793733 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:33:43.794174 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:33:43.794499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:44.410569 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.616 seconds
[0m16:33:44.414800 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:33:44.603375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd88abbf0>]}
[0m16:33:44.605127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:33:44.606053 [info ] [MainThread]: 
[0m16:33:44.623876 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m16:33:44.625001 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m16:33:44.626207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m16:33:44.626891 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m16:33:44.636696 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m16:33:44.637985 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m16:33:44.662655 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m16:33:44.665524 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m16:33:44.666019 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m16:33:44.666533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:45.664383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m16:33:45.703402 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m16:33:45.894179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398bf0>]}
[0m16:33:45.896452 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.26s]
[0m16:33:45.899333 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m16:33:45.901621 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m16:33:45.903238 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m16:33:45.904626 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m16:33:45.905311 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m16:33:45.917704 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m16:33:45.919288 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m16:33:45.948806 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:33:45.949283 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m16:33:45.949718 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:33:46.694087 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m16:33:46.708602 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:33:46.709321 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:33:46.892495 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.182 seconds
[0m16:33:46.904588 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:33:46.905850 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m16:33:47.048206 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.141 seconds
[0m16:33:47.078035 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:33:47.079032 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:33:48.086957 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 1.007 seconds
[0m16:33:48.093125 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:33:48.094285 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m16:33:48.296052 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.201 seconds
[0m16:33:48.317322 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:33:48.343983 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m16:33:48.345999 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:33:48.346374 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m16:33:48.665515 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m16:33:48.667206 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:33:48.668346 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m16:34:06.048534 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 17.378 seconds
[0m16:34:06.051714 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:34:06.052809 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m16:39:56.212499 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m16:39:56.224640 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:39:56.231380 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:39:56.231939 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m16:39:56.435983 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m16:39:56.438030 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m16:39:56.658587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81da780>]}
[0m16:39:56.659325 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 370.75s]
[0m16:39:56.660313 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m16:39:56.661394 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m16:39:56.661727 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:39:56.662080 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m16:39:56.662508 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m16:39:56.663077 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m16:39:56.663508 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m16:39:56.663946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m16:39:56.664361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m16:39:56.664765 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m16:39:56.665115 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m16:39:56.665500 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m16:39:56.665883 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m16:39:56.669096 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m16:39:56.672097 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:39:56.674719 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m16:39:56.677035 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m16:39:56.681064 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:56.681475 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m16:39:56.681838 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m16:39:56.682249 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m16:39:56.705940 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:39:56.712673 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:39:56.712249 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m16:39:56.716421 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:39:56.716979 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m16:39:56.719238 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m16:39:56.719639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:56.720238 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m16:39:56.722034 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:39:57.456301 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m16:39:57.462740 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:57.463694 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:39:57.588144 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.124 seconds
[0m16:39:57.591442 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:57.591796 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m16:39:57.717467 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.125 seconds
[0m16:39:57.723382 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:57.724011 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:39:57.843616 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.119 seconds
[0m16:39:57.855134 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:57.856243 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m16:39:57.970951 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.113 seconds
[0m16:39:57.985273 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:39:57.989854 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m16:39:57.996559 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:57.997262 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m16:39:58.146488 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m16:39:58.147126 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:58.147696 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m16:39:58.739055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.019 seconds
[0m16:39:58.745980 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m16:39:58.903782 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.181 seconds
[0m16:39:58.910053 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m16:39:58.917654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b18230>]}
[0m16:39:58.919101 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.25s]
[0m16:39:58.921502 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:39:59.104021 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34a76e0>]}
[0m16:39:59.105492 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.44s]
[0m16:39:59.106863 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m16:39:59.736063 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.587 seconds
[0m16:39:59.738760 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:39:59.739473 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m16:40:00.179289 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m16:40:00.189292 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:40:00.191545 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:40:00.192344 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m16:40:00.431363 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m16:40:00.436593 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m16:40:00.663712 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '826369ff-4da2-44c0-8309-8faa1128a021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0218e30>]}
[0m16:40:00.666152 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 4.00s]
[0m16:40:00.669940 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m16:40:00.674178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:00.675041 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m16:40:00.675757 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m16:40:00.676498 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m16:40:00.677382 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m16:40:00.678701 [info ] [MainThread]: 
[0m16:40:00.679925 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 6 minutes and 18.36 seconds (378.36s).
[0m16:40:00.682323 [debug] [MainThread]: Command end result
[0m16:40:00.719610 [info ] [MainThread]: 
[0m16:40:00.720262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:00.720657 [info ] [MainThread]: 
[0m16:40:00.721163 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:40:00.722543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.90722, "process_user_time": 6.099577, "process_kernel_time": 2.035192, "process_mem_max_rss": "268540", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m16:40:00.723095 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:00.722999 after 30.91 seconds
[0m16:40:00.723518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec030b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd88abbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1adf70>]}
[0m16:40:00.723930 [debug] [MainThread]: Flushing usage events
[0m16:40:05.274372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb6a7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd310fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe748c0>]}


============================== 16:40:05.283114 | cca3aea8-6c36-475d-9dd5-6f5e1ad523d3 ==============================
[0m16:40:05.283114 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:40:05.284131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:40:06.024747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cca3aea8-6c36-475d-9dd5-6f5e1ad523d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd82ea780>]}
[0m16:40:06.053338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cca3aea8-6c36-475d-9dd5-6f5e1ad523d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb971850>]}
[0m16:40:06.053891 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:40:06.065246 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:40:06.140497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:06.140889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:06.167564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cca3aea8-6c36-475d-9dd5-6f5e1ad523d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb8f7ce0>]}
[0m16:40:06.241084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cca3aea8-6c36-475d-9dd5-6f5e1ad523d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d38920>]}
[0m16:40:06.241584 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:40:06.242161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca3aea8-6c36-475d-9dd5-6f5e1ad523d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d1f560>]}
[0m16:40:06.244106 [info ] [MainThread]: 
[0m16:40:06.244720 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:06.248337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:40:06.261083 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:40:06.261556 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:40:06.261935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:07.717078 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.455 seconds
[0m16:40:07.722661 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:40:07.941623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca3aea8-6c36-475d-9dd5-6f5e1ad523d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd87e9ac0>]}
[0m16:40:07.943521 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:07.945720 [info ] [MainThread]: 
[0m16:40:07.961425 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:40:07.962346 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:40:07.963090 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:40:07.963811 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m16:40:07.964463 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:40:07.964999 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m16:40:07.965726 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m16:40:07.966712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m16:40:07.967334 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m16:40:07.968379 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m16:40:07.969141 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m16:40:07.969733 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:40:07.970449 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m16:40:07.970993 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:40:07.971492 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:40:07.987143 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:40:07.988510 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:40:07.991859 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:40:07.995070 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:40:07.998800 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:40:08.001056 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:40:08.001397 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:40:08.001775 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:40:08.008685 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:40:08.016691 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:40:08.018427 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:40:08.020166 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:40:08.021824 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:40:08.023357 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:40:08.023872 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:40:08.024275 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m16:40:08.024881 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:40:08.025384 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:40:08.025680 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m16:40:08.026040 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:08.026396 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m16:40:08.026737 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:40:08.027071 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:40:08.027971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:08.028875 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:08.639886 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m16:40:08.651455 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m16:40:08.705449 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m16:40:08.707453 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m16:40:08.762639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m16:40:08.763381 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m16:40:08.765181 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m16:40:08.766875 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m16:40:08.819183 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.85s]
[0m16:40:08.820933 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:40:08.821631 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:40:08.822307 [info ] [Thread-4 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m16:40:08.823100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m16:40:08.824820 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:40:08.829607 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:40:08.830860 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:40:08.833146 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:40:08.834265 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:40:08.834731 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:40:08.835133 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:08.941039 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.97s]
[0m16:40:08.942509 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:40:08.943525 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:40:08.944321 [info ] [Thread-1 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m16:40:08.945191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m16:40:08.946193 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.98s]
[0m16:40:08.946804 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:40:08.947609 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:40:08.952512 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:40:08.953110 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:40:08.953863 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m16:40:08.954521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m16:40:08.955067 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:40:08.960219 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:40:08.960657 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:40:08.963014 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:40:08.964073 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:40:08.966339 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:40:08.967114 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 1.00s]
[0m16:40:08.967829 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:40:08.968500 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:40:08.968908 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:40:08.969391 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:40:08.969820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:08.970412 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:40:08.970812 [info ] [Thread-3 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m16:40:08.972524 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:40:08.972983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m16:40:08.973362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:08.973710 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:40:08.977869 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:40:08.978925 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:40:08.980833 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:40:08.981878 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:40:08.982207 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:40:08.982552 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:09.291810 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m16:40:09.298371 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m16:40:09.462135 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m16:40:09.467345 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m16:40:09.470817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m16:40:09.475738 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m16:40:09.478324 [info ] [Thread-4 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.66s]
[0m16:40:09.480038 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:40:09.480774 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:40:09.481615 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m16:40:09.482480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m16:40:09.483017 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:40:09.487622 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:40:09.488640 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:40:09.490864 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:40:09.492171 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:40:09.492649 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m16:40:09.493078 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:09.602576 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m16:40:09.605486 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m16:40:09.621262 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.67s]
[0m16:40:09.622725 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:40:09.623448 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:40:09.624061 [info ] [Thread-2 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m16:40:09.624994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m16:40:09.625591 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:40:09.630767 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:40:09.632075 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:40:09.634599 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:40:09.637033 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:40:09.637519 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:40:09.637947 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:09.731882 [info ] [Thread-1 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.79s]
[0m16:40:09.733061 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:40:09.733628 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:40:09.734121 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m16:40:09.734799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m16:40:09.735257 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:40:09.739752 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:40:09.740802 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:40:09.744302 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:40:09.745384 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:40:09.745802 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:40:09.746187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:09.835896 [info ] [Thread-3 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.86s]
[0m16:40:09.837046 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:40:09.837621 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:40:09.838150 [info ] [Thread-3 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m16:40:09.838936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m16:40:09.839427 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:40:09.843650 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:40:09.844709 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:40:09.846839 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:40:09.847972 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:40:09.848405 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:40:09.848784 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:10.141761 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m16:40:10.147851 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m16:40:10.308924 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m16:40:10.315008 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m16:40:10.347212 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.86s]
[0m16:40:10.348981 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:40:10.350114 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:40:10.351046 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m16:40:10.352204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m16:40:10.352940 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:40:10.359971 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:40:10.362519 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:40:10.365469 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:40:10.367085 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:40:10.367649 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:40:10.368166 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:10.415639 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m16:40:10.417593 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m16:40:10.487014 [info ] [Thread-2 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.86s]
[0m16:40:10.488295 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:40:10.488930 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:40:10.489477 [info ] [Thread-2 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m16:40:10.490168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m16:40:10.490656 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:40:10.497531 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:40:10.498761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m16:40:10.500731 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m16:40:10.502971 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:40:10.505336 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:40:10.506545 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:40:10.506964 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:10.507345 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:10.663702 [info ] [Thread-3 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.82s]
[0m16:40:10.665734 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:40:10.666637 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:40:10.667432 [info ] [Thread-3 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m16:40:10.668371 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m16:40:10.669021 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:40:10.674796 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:40:10.676254 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:40:10.679178 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:40:10.686183 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:40:10.687446 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:10.691019 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.96s]
[0m16:40:10.691531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:10.692349 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:40:10.694248 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:40:10.694794 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m16:40:10.695443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m16:40:10.695825 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:40:10.699615 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:40:10.700582 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:40:10.703845 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:40:10.707188 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:40:10.707626 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:10.708011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:10.855893 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m16:40:10.858536 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m16:42:05.767957 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 23.337 seconds
[0m16:42:05.777843 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m16:42:05.978884 [info ] [Thread-3 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 115.31s]
[0m16:42:05.981444 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:42:05.983885 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:42:05.985338 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m16:42:05.986592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m16:42:05.987274 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:42:06.000517 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:42:06.002148 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:42:06.005451 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:42:06.007119 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:42:06.007671 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:06.008227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:06.760419 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m16:42:06.764515 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m16:42:06.990773 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.00s]
[0m16:42:06.994815 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:42:06.996837 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:42:06.998070 [info ] [Thread-3 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m16:42:07.000668 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m16:42:07.001766 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:42:07.009211 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:42:07.011225 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:42:07.014774 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:42:07.016643 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:42:07.017341 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:07.017978 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:08.068156 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m16:42:08.074122 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m16:42:08.262657 [info ] [Thread-3 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.26s]
[0m16:42:08.264721 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:42:08.384640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 25.939 seconds
[0m16:42:08.390476 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m16:42:08.523262 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 118.17s]
[0m16:42:08.527444 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:42:08.591495 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 117.89s]
[0m16:42:08.594567 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:42:10.791069 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 28.545 seconds
[0m16:42:10.797796 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m16:42:10.999892 [info ] [Thread-2 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 120.51s]
[0m16:42:11.003598 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:42:11.014261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:11.015032 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m16:42:11.015666 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6' was properly closed.
[0m16:42:11.016175 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m16:42:11.016678 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f' was properly closed.
[0m16:42:11.017839 [info ] [MainThread]: 
[0m16:42:11.018579 [info ] [MainThread]: Finished running 18 data tests in 0 hours 2 minutes and 4.77 seconds (124.77s).
[0m16:42:11.024062 [debug] [MainThread]: Command end result
[0m16:42:11.165620 [info ] [MainThread]: 
[0m16:42:11.166454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:11.166751 [info ] [MainThread]: 
[0m16:42:11.167180 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m16:42:11.168836 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 34.197834, "process_user_time": 4.389362, "process_kernel_time": 1.920158, "process_mem_max_rss": "268636", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m16:42:11.169305 [debug] [MainThread]: Command `dbt test` succeeded at 16:42:11.169229 after 34.20 seconds
[0m16:42:11.169649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd594650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbeb2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbeb0c20>]}
[0m16:42:11.169976 [debug] [MainThread]: Flushing usage events
[0m16:45:02.148906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafb84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf78da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffba1cc20>]}


============================== 16:45:02.157952 | e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c ==============================
[0m16:45:02.157952 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:45:02.159345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:02.933671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e31f70>]}
[0m16:45:02.962493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafb8410>]}
[0m16:45:02.963080 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:45:02.975617 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:45:03.081565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:03.082033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:03.109641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd820d520>]}
[0m16:45:03.178870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81184d0>]}
[0m16:45:03.179428 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:45:03.180284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e21790>]}
[0m16:45:03.182018 [info ] [MainThread]: 
[0m16:45:03.182816 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:03.186401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m16:45:03.197645 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m16:45:03.198061 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m16:45:03.198357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:04.665193 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.466 seconds
[0m16:45:04.670821 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m16:45:04.891877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:45:04.906509 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:45:04.907158 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:45:04.907637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:05.510184 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.602 seconds
[0m16:45:05.518577 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:45:05.866605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5ad100>]}
[0m16:45:05.867990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:05.868643 [info ] [MainThread]: 
[0m16:45:05.875939 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m16:45:05.876512 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m16:45:05.877149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m16:45:05.877461 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m16:45:05.882901 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m16:45:05.883865 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m16:45:05.903226 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m16:45:05.905792 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m16:45:05.906226 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m16:45:05.906629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:06.936937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.029 seconds
[0m16:45:06.976727 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m16:45:07.154524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd832cc50>]}
[0m16:45:07.156314 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.27s]
[0m16:45:07.158935 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m16:45:07.161515 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m16:45:07.162430 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m16:45:07.163504 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m16:45:07.164102 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m16:45:07.175894 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m16:45:07.177112 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m16:45:07.207208 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:07.207699 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m16:45:07.208139 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:45:08.124284 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.916 seconds
[0m16:45:08.130431 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:08.130797 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:45:08.283082 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.152 seconds
[0m16:45:08.288007 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:08.288494 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m16:45:08.416049 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.127 seconds
[0m16:45:08.431512 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:08.432037 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:45:08.733735 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.301 seconds
[0m16:45:08.737497 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:08.737871 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m16:45:08.878850 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.140 seconds
[0m16:45:08.893442 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:45:08.917724 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m16:45:08.919548 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:08.919923 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m16:45:09.123541 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m16:45:09.124760 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:09.125607 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m16:45:11.283325 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.157 seconds
[0m16:45:11.285056 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:11.286001 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m16:45:11.727134 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m16:45:11.749583 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m16:45:11.760110 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m16:45:11.761102 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m16:45:12.011828 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m16:45:12.019026 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m16:45:12.216658 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd816ba40>]}
[0m16:45:12.219309 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 5.05s]
[0m16:45:12.222870 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m16:45:12.225236 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m16:45:12.226131 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:45:12.226924 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m16:45:12.227892 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m16:45:12.229222 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m16:45:12.230179 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m16:45:12.231058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m16:45:12.231938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m16:45:12.232782 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m16:45:12.233432 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m16:45:12.234092 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m16:45:12.234700 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m16:45:12.240445 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m16:45:12.243967 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:45:12.248594 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m16:45:12.250561 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m16:45:12.251051 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m16:45:12.255861 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:12.256268 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m16:45:12.269244 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m16:45:12.274425 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:45:12.276524 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m16:45:12.276958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:12.279868 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m16:45:12.280354 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m16:45:12.282504 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m16:45:12.282852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:12.283322 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m16:45:12.285263 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:12.976793 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m16:45:12.983214 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:12.984743 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:45:13.139716 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.154 seconds
[0m16:45:13.143620 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:13.144095 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m16:45:13.269774 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.125 seconds
[0m16:45:13.281243 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:13.282595 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:45:13.428639 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.144 seconds
[0m16:45:13.441428 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:13.443224 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m16:45:13.557574 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.113 seconds
[0m16:45:13.569449 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:45:13.574918 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m16:45:13.580467 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:13.581577 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m16:45:13.793268 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m16:45:13.795852 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:13.797713 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m16:45:13.864196 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.579 seconds
[0m16:45:13.869020 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m16:45:13.890521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.607 seconds
[0m16:45:13.895294 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m16:45:14.483046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34ec6e0>]}
[0m16:45:14.487034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34e9700>]}
[0m16:45:14.489184 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.25s]
[0m16:45:14.491290 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 2.25s]
[0m16:45:14.493737 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m16:45:14.495235 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m16:45:14.921407 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.122 seconds
[0m16:45:14.923247 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:14.924458 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m16:45:15.308959 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m16:45:15.316266 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m16:45:15.317903 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m16:45:15.318617 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m16:45:15.528134 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m16:45:15.533548 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m16:45:15.720772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e0e06a-e71f-46b5-9e1a-8f40da1ba71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2babb00>]}
[0m16:45:15.722015 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.49s]
[0m16:45:15.723145 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m16:45:15.725187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:15.725641 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m16:45:15.726048 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m16:45:15.726410 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m16:45:15.726727 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m16:45:15.727338 [info ] [MainThread]: 
[0m16:45:15.727976 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m16:45:15.729377 [debug] [MainThread]: Command end result
[0m16:45:15.755142 [info ] [MainThread]: 
[0m16:45:15.756048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:15.756547 [info ] [MainThread]: 
[0m16:45:15.757178 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:45:15.759049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.653954, "process_user_time": 4.105756, "process_kernel_time": 1.95094, "process_mem_max_rss": "267728", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m16:45:15.759839 [debug] [MainThread]: Command `dbt run` succeeded at 16:45:15.759721 after 13.66 seconds
[0m16:45:15.760269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb275a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb274b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8404bc0>]}
[0m16:45:15.760588 [debug] [MainThread]: Flushing usage events
[0m16:45:19.091418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe0c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe0fa10>]}


============================== 16:45:19.102853 | aac656c8-e8d4-4298-8ad0-1ba2efea5706 ==============================
[0m16:45:19.102853 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:45:19.104034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:19.918389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac656c8-e8d4-4298-8ad0-1ba2efea5706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd97bcad0>]}
[0m16:45:19.952920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac656c8-e8d4-4298-8ad0-1ba2efea5706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc44d0>]}
[0m16:45:19.953729 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:45:19.967729 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:45:20.054760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:20.055236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:20.085402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac656c8-e8d4-4298-8ad0-1ba2efea5706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8088c20>]}
[0m16:45:20.165530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac656c8-e8d4-4298-8ad0-1ba2efea5706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da0710>]}
[0m16:45:20.166045 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m16:45:20.166754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac656c8-e8d4-4298-8ad0-1ba2efea5706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd808a8a0>]}
[0m16:45:20.168968 [info ] [MainThread]: 
[0m16:45:20.169701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:20.173636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m16:45:20.185817 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m16:45:20.186201 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m16:45:20.186488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:21.326407 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.139 seconds
[0m16:45:21.332535 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m16:45:21.590725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac656c8-e8d4-4298-8ad0-1ba2efea5706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ea6780>]}
[0m16:45:21.592547 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:21.594765 [info ] [MainThread]: 
[0m16:45:21.610055 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:45:21.610801 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:45:21.611512 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:45:21.612208 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m16:45:21.612878 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:45:21.613456 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m16:45:21.614199 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m16:45:21.615018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m16:45:21.615664 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m16:45:21.616537 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m16:45:21.617259 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m16:45:21.617827 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:45:21.618447 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m16:45:21.618973 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:45:21.619499 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:45:21.633088 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:45:21.635393 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:45:21.638711 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:45:21.642133 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:45:21.646184 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:45:21.648750 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:45:21.655116 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:45:21.667237 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:45:21.671711 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:45:21.672317 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:45:21.672627 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:45:21.674277 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:45:21.677171 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:45:21.678429 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m16:45:21.679766 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m16:45:21.680425 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m16:45:21.681041 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m16:45:21.682853 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m16:45:21.684964 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m16:45:21.690821 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:21.692373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:21.693428 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:45:21.694860 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m16:45:21.703430 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:21.705110 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:45:22.282037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m16:45:22.283416 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m16:45:22.300616 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m16:45:22.301327 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m16:45:22.305511 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m16:45:22.308133 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m16:45:22.379987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m16:45:22.382482 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m16:45:22.483970 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.87s]
[0m16:45:22.485725 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m16:45:22.486355 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:45:22.486877 [info ] [Thread-4 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m16:45:22.487609 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m16:45:22.488132 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:45:22.492721 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:45:22.496728 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:45:22.500596 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:45:22.503772 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m16:45:22.505461 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:45:22.506289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:45:22.512798 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.90s]
[0m16:45:22.514277 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m16:45:22.516276 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:45:22.517184 [info ] [Thread-3 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m16:45:22.518811 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m16:45:22.519502 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:45:22.520346 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.91s]
[0m16:45:22.530401 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:45:22.531831 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m16:45:22.532846 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:45:22.533429 [info ] [Thread-1 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m16:45:22.534927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m16:45:22.535458 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:45:22.535809 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:45:22.544850 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:45:22.549724 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:45:22.551568 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:45:22.552263 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m16:45:22.554260 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:45:22.554658 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:45:22.555578 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:45:22.558300 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m16:45:22.559118 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:45:22.559520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:22.594566 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.98s]
[0m16:45:22.595805 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m16:45:22.596306 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:45:22.596807 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m16:45:22.597399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m16:45:22.598240 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:45:22.601772 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:45:22.602942 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:45:22.604671 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:45:22.605938 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m16:45:22.606298 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:45:22.606608 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:23.023399 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m16:45:23.029607 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m16:45:23.040337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m16:45:23.043382 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m16:45:23.053991 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m16:45:23.058906 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m16:45:23.231890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m16:45:23.237522 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m16:45:23.245226 [info ] [Thread-3 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.73s]
[0m16:45:23.247094 [info ] [Thread-4 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.76s]
[0m16:45:23.248430 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m16:45:23.249429 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m16:45:23.250296 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:45:23.251182 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:45:23.252235 [info ] [Thread-3 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m16:45:23.253366 [info ] [Thread-4 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m16:45:23.254183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m16:45:23.254958 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m16:45:23.255725 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:45:23.256445 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:45:23.262925 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:45:23.268648 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:45:23.270290 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:45:23.273875 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:45:23.274621 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:45:23.276762 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:45:23.277777 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m16:45:23.278203 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m16:45:23.278910 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m16:45:23.279303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:45:23.279813 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m16:45:23.281386 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:45:23.431502 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.83s]
[0m16:45:23.433381 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m16:45:23.434984 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:45:23.436067 [info ] [Thread-2 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m16:45:23.437071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m16:45:23.438113 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:45:23.444097 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:45:23.463672 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:45:23.465910 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:45:23.467039 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m16:45:23.467468 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m16:45:23.467865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:23.763662 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m16:45:23.770768 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m16:45:23.846274 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 1.31s]
[0m16:45:23.849898 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m16:45:23.851474 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:45:23.852922 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m16:45:23.855551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m16:45:23.857000 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:45:23.865539 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:45:23.867941 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:45:23.871466 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:45:23.873933 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m16:45:23.874788 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m16:45:23.875482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:23.880119 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m16:45:23.884334 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m16:45:24.069117 [info ] [Thread-3 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.81s]
[0m16:45:24.071535 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m16:45:24.072594 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:45:24.073860 [info ] [Thread-3 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m16:45:24.075212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m16:45:24.076829 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:45:24.087131 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:45:24.090350 [info ] [Thread-4 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.84s]
[0m16:45:24.091800 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m16:45:24.092437 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:45:24.093061 [info ] [Thread-4 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m16:45:24.093572 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:45:24.094033 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m16:45:24.096791 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:45:24.097392 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:45:24.104318 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:45:24.105771 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m16:45:24.106297 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m16:45:24.106757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:45:24.108159 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:45:24.111148 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:45:24.113600 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m16:45:24.114146 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:45:24.114507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:45:24.118369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m16:45:24.120884 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m16:45:24.338817 [info ] [Thread-2 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.90s]
[0m16:45:24.340836 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m16:45:24.341565 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:45:24.342181 [info ] [Thread-2 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m16:45:24.343151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m16:45:24.343712 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:45:24.348854 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:45:24.350370 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:45:24.354384 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:45:24.356112 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m16:45:24.356637 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:45:24.357105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:24.432153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m16:45:24.434902 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m16:45:24.609046 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m16:45:24.613852 [debug] [Thread-3 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m16:45:24.634694 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m16:45:24.637874 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m16:45:24.644917 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.79s]
[0m16:45:24.646780 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m16:45:24.647646 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:45:24.648381 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m16:45:24.649386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m16:45:24.650057 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:45:24.655783 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:45:24.657103 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:45:24.659816 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:45:24.661277 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m16:45:24.661815 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m16:45:24.662267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:24.836006 [info ] [Thread-4 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.74s]
[0m16:45:24.837385 [info ] [Thread-3 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.76s]
[0m16:45:24.838350 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m16:45:24.839177 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m16:45:24.839890 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:45:24.840538 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:45:24.841135 [info ] [Thread-4 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m16:45:24.841842 [info ] [Thread-3 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m16:45:24.842539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m16:45:24.843248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m16:45:24.843865 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:45:24.844412 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:45:24.849258 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:45:24.853099 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:45:24.854320 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:45:24.854784 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:45:24.857026 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:45:24.859244 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:45:24.860815 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m16:45:24.861562 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m16:45:24.861970 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:45:24.862411 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:45:24.862879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:45:24.863259 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:45:25.087862 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m16:45:25.090979 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m16:45:25.261703 [info ] [Thread-2 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.92s]
[0m16:45:25.264785 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m16:45:25.290612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m16:45:25.294844 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m16:45:25.526135 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.88s]
[0m16:45:25.528236 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m16:45:25.553044 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m16:45:25.559282 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m16:45:25.562516 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m16:45:25.570260 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m16:45:25.732855 [info ] [Thread-3 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.89s]
[0m16:45:25.734094 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m16:45:25.745386 [info ] [Thread-4 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.90s]
[0m16:45:25.746139 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m16:45:25.749054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:25.749467 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m16:45:25.749775 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m16:45:25.750048 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m16:45:25.750316 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m16:45:25.750777 [info ] [MainThread]: 
[0m16:45:25.751471 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m16:45:25.754212 [debug] [MainThread]: Command end result
[0m16:45:25.865131 [info ] [MainThread]: 
[0m16:45:25.866018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:25.866322 [info ] [MainThread]: 
[0m16:45:25.866891 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m16:45:25.869028 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.820786, "process_user_time": 4.569975, "process_kernel_time": 1.909505, "process_mem_max_rss": "268988", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m16:45:25.869935 [debug] [MainThread]: Command `dbt test` succeeded at 16:45:25.869771 after 6.82 seconds
[0m16:45:25.870439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7ed970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd88b45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe7383e0>]}
[0m16:45:25.870829 [debug] [MainThread]: Flushing usage events
[0m17:00:35.743036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf83c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd3176e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf80560>]}


============================== 17:00:35.751739 | 0e1a42c6-a595-4117-9e2e-6612c37b9aba ==============================
[0m17:00:35.751739 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:00:35.752695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:00:36.527706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbcbddf0>]}
[0m17:00:36.556372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd9167d70>]}
[0m17:00:36.556992 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:00:36.571185 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:00:36.650671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:36.651136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:36.677924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8207bf0>]}
[0m17:00:36.747707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e88dd0>]}
[0m17:00:36.748315 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:00:36.749096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda2561b0>]}
[0m17:00:36.750755 [info ] [MainThread]: 
[0m17:00:36.751408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:00:36.754885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m17:00:36.765438 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m17:00:36.765760 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m17:00:36.766202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:37.911236 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.144 seconds
[0m17:00:37.915638 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m17:00:38.309699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m17:00:38.329558 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:00:38.330455 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:00:38.331178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:38.971549 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.640 seconds
[0m17:00:38.976504 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:00:39.150408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5ad310>]}
[0m17:00:39.152368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:39.153263 [info ] [MainThread]: 
[0m17:00:39.171941 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m17:00:39.173294 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m17:00:39.174681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m17:00:39.175302 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m17:00:39.184294 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m17:00:39.186355 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m17:00:39.210785 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m17:00:39.214164 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m17:00:39.214666 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m17:00:39.215146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.299646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.083 seconds
[0m17:00:40.327906 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m17:05:13.646533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78fce0>]}
[0m17:05:13.649722 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 274.46s]
[0m17:05:13.654996 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m17:05:13.660749 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m17:05:13.661790 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m17:05:13.662943 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m17:05:13.663366 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m17:05:13.700880 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m17:05:13.703734 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m17:05:13.794403 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:13.798285 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m17:05:13.800574 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:05:14.614015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m17:05:14.634048 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:14.634762 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:05:14.819197 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.183 seconds
[0m17:05:14.831045 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:14.832512 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m17:05:14.953236 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.119 seconds
[0m17:05:14.980191 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:14.980834 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:05:15.106799 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.125 seconds
[0m17:05:15.114359 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:15.115263 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m17:05:15.303445 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.187 seconds
[0m17:05:15.328791 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:05:15.362038 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m17:05:15.364340 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:15.364752 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m17:05:15.513301 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m17:05:15.515102 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:15.517182 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m17:05:17.819230 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.300 seconds
[0m17:05:17.820269 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:17.820942 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m17:05:18.301378 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m17:05:18.322792 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:05:18.332726 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:05:18.333413 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m17:05:19.069487 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m17:05:19.071952 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m17:05:19.241674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd349a570>]}
[0m17:05:19.242816 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 5.58s]
[0m17:05:19.244861 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m17:05:19.246432 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m17:05:19.247139 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:05:19.247788 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m17:05:19.248419 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m17:05:19.249193 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m17:05:19.249887 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m17:05:19.250756 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m17:05:19.251328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m17:05:19.251918 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m17:05:19.252369 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m17:05:19.252817 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m17:05:19.253246 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m17:05:19.257731 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m17:05:19.260454 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:05:19.264278 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m17:05:19.265620 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m17:05:19.266002 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m17:05:19.266372 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m17:05:19.270538 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:19.294273 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m17:05:19.296314 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:05:19.296728 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m17:05:19.297732 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:05:19.300385 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m17:05:19.301415 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m17:05:19.302519 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:05:19.302838 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:05:19.303191 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m17:05:19.304525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:20.074190 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m17:05:20.084537 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:20.085599 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:05:20.244631 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.158 seconds
[0m17:05:20.257268 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:20.258396 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m17:05:20.397813 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.138 seconds
[0m17:05:20.410120 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:20.412176 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:05:20.552954 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.139 seconds
[0m17:05:20.564264 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:20.565564 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m17:05:20.694369 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.127 seconds
[0m17:05:20.707857 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:05:20.713058 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m17:05:20.717770 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:20.718427 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m17:05:20.888786 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m17:05:20.890034 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:20.891208 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m17:05:20.930696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.626 seconds
[0m17:05:20.937093 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m17:05:21.085198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34f4e00>]}
[0m17:05:21.087118 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.83s]
[0m17:05:21.092214 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:05:21.114018 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.811 seconds
[0m17:05:21.116837 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m17:05:21.309121 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd348ee10>]}
[0m17:05:21.310187 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.06s]
[0m17:05:21.311195 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m17:05:22.362914 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.470 seconds
[0m17:05:22.363809 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:22.364523 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m17:05:22.701535 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m17:05:22.712928 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:05:22.715975 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:05:22.717361 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m17:05:22.989439 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m17:05:22.996625 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m17:05:23.317456 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1a42c6-a595-4117-9e2e-6612c37b9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd02f0860>]}
[0m17:05:23.320206 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 4.07s]
[0m17:05:23.323575 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m17:05:23.327820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:23.329502 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m17:05:23.330326 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m17:05:23.331079 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m17:05:23.331680 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m17:05:23.333392 [info ] [MainThread]: 
[0m17:05:23.335493 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 4 minutes and 46.58 seconds (286.58s).
[0m17:05:23.338034 [debug] [MainThread]: Command end result
[0m17:05:23.380637 [info ] [MainThread]: 
[0m17:05:23.381509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:23.381847 [info ] [MainThread]: 
[0m17:05:23.382418 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:05:23.385189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 74.54966, "process_user_time": 4.235842, "process_kernel_time": 1.916548, "process_mem_max_rss": "268856", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m17:05:23.386090 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:23.385982 after 74.55 seconds
[0m17:05:23.386754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec030b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3dcaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda26cd10>]}
[0m17:05:23.387179 [debug] [MainThread]: Flushing usage events
[0m17:05:27.099615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1da9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb933740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf7e2a0>]}


============================== 17:05:27.110208 | 5ec3cd6a-e404-4a15-af22-a3441f358b65 ==============================
[0m17:05:27.110208 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:05:27.111447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:27.921922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec3cd6a-e404-4a15-af22-a3441f358b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd817ffb0>]}
[0m17:05:27.951766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ec3cd6a-e404-4a15-af22-a3441f358b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839b560>]}
[0m17:05:27.952352 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:05:27.965512 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:05:28.057369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:28.057870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:28.085424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ec3cd6a-e404-4a15-af22-a3441f358b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd808aab0>]}
[0m17:05:28.161416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ec3cd6a-e404-4a15-af22-a3441f358b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da0e00>]}
[0m17:05:28.161914 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:05:28.162817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec3cd6a-e404-4a15-af22-a3441f358b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd808a8a0>]}
[0m17:05:28.164993 [info ] [MainThread]: 
[0m17:05:28.165745 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:28.169428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m17:05:28.180936 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:05:28.181257 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:05:28.181579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:29.468170 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.278 seconds
[0m17:05:29.486754 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:05:29.683966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec3cd6a-e404-4a15-af22-a3441f358b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ebfc20>]}
[0m17:05:29.687869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:05:29.691015 [info ] [MainThread]: 
[0m17:05:29.702154 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:05:29.702719 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:05:29.703145 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:05:29.703582 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m17:05:29.704429 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:05:29.704896 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m17:05:29.705336 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m17:05:29.705878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m17:05:29.706262 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m17:05:29.706969 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m17:05:29.707449 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m17:05:29.707821 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:05:29.708248 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m17:05:29.708605 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:05:29.708965 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:05:29.725445 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:05:29.731759 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:05:29.746356 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:05:29.770109 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:05:29.783866 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:05:29.790104 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:05:29.804708 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:05:29.812396 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:05:29.830397 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:05:29.830992 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:05:29.831357 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:05:29.833310 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:05:29.835739 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:05:29.837430 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:05:29.838771 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m17:05:29.839307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:05:29.841270 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:05:29.842551 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:05:29.842917 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m17:05:29.843925 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:05:29.844431 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m17:05:29.844888 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:05:29.845272 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:05:29.845757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:29.847794 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:05:30.518893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m17:05:30.563815 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m17:05:30.568261 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m17:05:30.571447 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m17:05:30.615514 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m17:05:30.617305 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m17:05:30.779805 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 1.07s]
[0m17:05:30.783229 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:05:30.784125 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:05:30.785142 [info ] [Thread-1 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m17:05:30.786692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m17:05:30.788024 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:05:30.795073 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:05:30.796819 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 1.09s]
[0m17:05:30.798222 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:05:30.798986 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:05:30.799774 [info ] [Thread-3 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m17:05:30.801119 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:05:30.801837 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m17:05:30.805621 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:05:30.806429 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:05:30.811941 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:05:30.813785 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 1.10s]
[0m17:05:30.815814 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:05:30.816381 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:05:30.816953 [info ] [Thread-4 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m17:05:30.817817 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:05:30.818246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m17:05:30.818686 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:05:30.819141 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:05:30.819575 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:05:30.823245 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:05:30.823970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:30.827951 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:05:30.831029 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:05:30.831559 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:05:30.832047 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:05:30.832565 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:05:30.835362 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:05:30.838503 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:05:30.839301 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:05:30.839763 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:05:31.175019 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.335 seconds
[0m17:05:31.178791 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m17:05:31.304855 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m17:05:31.307886 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m17:05:31.351108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m17:05:31.354748 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m17:05:31.363393 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 1.66s]
[0m17:05:31.365423 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:05:31.366375 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:05:31.367027 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m17:05:31.368153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m17:05:31.368718 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:05:31.374501 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:05:31.375868 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:05:31.378469 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:05:31.380247 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:05:31.380778 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:05:31.381210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:05:31.407396 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m17:05:31.410512 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m17:05:31.512470 [info ] [Thread-4 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.69s]
[0m17:05:31.514250 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:05:31.515782 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:05:31.518382 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m17:05:31.519860 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m17:05:31.520417 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:05:31.528328 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:05:31.530712 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:05:31.534360 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:05:31.536252 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:05:31.536751 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m17:05:31.537247 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:05:31.575850 [info ] [Thread-1 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.79s]
[0m17:05:31.577233 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:05:31.577750 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:05:31.578182 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m17:05:31.578949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m17:05:31.579514 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:05:31.584160 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:05:31.585395 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:05:31.587834 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:05:31.588989 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:05:31.589384 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:05:31.589751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:31.600281 [info ] [Thread-3 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.80s]
[0m17:05:31.601736 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:05:31.602190 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:05:31.602656 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m17:05:31.603292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m17:05:31.603663 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:05:31.608108 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:05:31.609114 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:05:31.610904 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:05:31.611962 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:05:31.612411 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:05:31.612810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:05:31.997804 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m17:05:32.004257 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m17:05:32.227905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m17:05:32.230057 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m17:05:32.263728 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.90s]
[0m17:05:32.265070 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:05:32.265561 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:05:32.266003 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m17:05:32.267232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m17:05:32.267731 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:05:32.274403 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:05:32.275537 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:05:32.277741 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:05:32.280070 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:05:32.281193 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:05:32.281747 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:05:32.331846 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m17:05:32.334874 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m17:05:32.440732 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.86s]
[0m17:05:32.442627 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:05:32.443149 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:05:32.443538 [info ] [Thread-1 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m17:05:32.445800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m17:05:32.447245 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:05:32.453427 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:05:32.456105 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:05:32.458503 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:05:32.459607 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:05:32.459945 [debug] [Thread-1 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:05:32.460241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:32.581119 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.98s]
[0m17:05:32.585406 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:05:32.588131 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:05:32.589399 [info ] [Thread-3 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m17:05:32.592214 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m17:05:32.597778 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:05:32.672468 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:05:32.679184 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:05:32.690665 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:05:32.701213 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:05:32.702619 [debug] [Thread-3 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:05:32.703519 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:05:32.725806 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.188 seconds
[0m17:05:32.728588 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m17:05:32.933562 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 1.41s]
[0m17:05:32.936479 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:05:32.938866 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:05:32.940723 [info ] [Thread-4 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m17:05:32.943135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m17:05:32.944874 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:05:32.953418 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:05:32.960215 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m17:05:32.961304 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:05:32.967978 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m17:05:32.976389 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:05:32.996699 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:05:32.997401 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m17:05:32.997845 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:05:33.062500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m17:05:33.064407 [debug] [Thread-1 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m17:05:33.168699 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.90s]
[0m17:05:33.179729 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:05:33.188988 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:05:33.190952 [info ] [Thread-2 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m17:05:33.194239 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m17:05:33.195163 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:05:33.199122 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:05:33.200198 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:05:33.201932 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:05:33.203153 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:05:33.203568 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m17:05:33.204044 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:05:33.232365 [info ] [Thread-1 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.79s]
[0m17:05:33.233622 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:05:33.234025 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:05:33.234441 [info ] [Thread-1 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m17:05:33.235083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m17:05:33.235751 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:05:33.240374 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:05:33.241378 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:05:33.243746 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:05:33.246479 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:05:33.248246 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:05:33.249688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:33.317313 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m17:05:33.328085 [debug] [Thread-3 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m17:05:33.518121 [info ] [Thread-3 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.93s]
[0m17:05:33.520106 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:05:33.520903 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:05:33.521697 [info ] [Thread-3 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m17:05:33.522490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m17:05:33.523070 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:05:33.528121 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:05:33.529016 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:05:33.531325 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:05:33.532922 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:05:33.533500 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:05:33.534022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:05:33.855001 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m17:05:33.861849 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m17:05:33.886914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m17:05:33.891848 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m17:05:33.900587 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m17:05:33.910136 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m17:05:34.032531 [info ] [Thread-4 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 1.09s]
[0m17:05:34.033896 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:05:34.062293 [info ] [Thread-2 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.87s]
[0m17:05:34.063085 [info ] [Thread-1 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.83s]
[0m17:05:34.063754 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:05:34.064582 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:05:34.157719 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m17:05:34.161872 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m17:05:34.327593 [info ] [Thread-3 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.80s]
[0m17:05:34.331162 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:05:34.338574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:34.339813 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m17:05:34.340600 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m17:05:34.341337 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m17:05:34.341930 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m17:05:34.342984 [info ] [MainThread]: 
[0m17:05:34.344390 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m17:05:34.349391 [debug] [MainThread]: Command end result
[0m17:05:34.500738 [info ] [MainThread]: 
[0m17:05:34.501665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:34.501979 [info ] [MainThread]: 
[0m17:05:34.502444 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m17:05:34.504651 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.448981, "process_user_time": 5.02608, "process_kernel_time": 2.100907, "process_mem_max_rss": "269268", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m17:05:34.505458 [debug] [MainThread]: Command `dbt test` succeeded at 17:05:34.505352 after 7.45 seconds
[0m17:05:34.506022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1da990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe46180>]}
[0m17:05:34.506459 [debug] [MainThread]: Flushing usage events
[0m17:15:02.999146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe0bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbdb9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe0ba10>]}


============================== 17:15:03.009743 | 7f5cfa81-5cce-4cec-9394-e8bfa6d12655 ==============================
[0m17:15:03.009743 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:15:03.011068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:03.873653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabee990>]}
[0m17:15:03.903021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8458d70>]}
[0m17:15:03.903620 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:15:03.916668 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:15:03.999667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:04.000134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:04.029455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd809d7c0>]}
[0m17:15:04.101578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e88e90>]}
[0m17:15:04.102059 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:15:04.102349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ebc380>]}
[0m17:15:04.104080 [info ] [MainThread]: 
[0m17:15:04.104780 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:15:04.108235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m17:15:04.118849 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m17:15:04.119196 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m17:15:04.119526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:05.291896 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.172 seconds
[0m17:15:05.294804 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m17:15:05.503336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m17:15:05.522050 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:15:05.522870 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:15:05.523450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:06.286866 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.763 seconds
[0m17:15:06.289429 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:15:06.477504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbdb9c40>]}
[0m17:15:06.478469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:06.480332 [info ] [MainThread]: 
[0m17:15:06.491150 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m17:15:06.491927 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m17:15:06.492793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m17:15:06.493238 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m17:15:06.500613 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m17:15:06.501660 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m17:15:06.525368 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m17:15:06.528733 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m17:15:06.529285 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m17:15:06.529698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:07.288943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m17:15:07.313702 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m17:15:07.554339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398fe0>]}
[0m17:15:07.555213 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.06s]
[0m17:15:07.557079 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m17:15:07.558221 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m17:15:07.559041 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m17:15:07.559744 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m17:15:07.560220 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m17:15:07.567566 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m17:15:07.568879 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m17:15:07.592387 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:07.592891 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m17:15:07.593283 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:15:08.519553 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.926 seconds
[0m17:15:08.537163 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:08.538185 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:15:08.712209 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.173 seconds
[0m17:15:08.721688 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:08.722729 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m17:15:08.824496 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.101 seconds
[0m17:15:08.837760 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:08.838415 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:15:08.979581 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.141 seconds
[0m17:15:08.985415 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:08.986129 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m17:15:09.106782 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.120 seconds
[0m17:15:09.131328 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:15:09.165312 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m17:15:09.167963 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:09.168546 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:09.348107 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m17:15:09.350022 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:09.351230 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m17:15:11.629163 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.276 seconds
[0m17:15:11.631087 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:11.631701 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m17:15:12.133988 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m17:15:12.160236 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:15:12.170081 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:15:12.170782 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m17:15:12.508692 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m17:15:12.517231 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m17:15:12.709773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b2d070>]}
[0m17:15:12.713211 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 5.15s]
[0m17:15:12.715673 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m17:15:12.720396 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m17:15:12.721855 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:15:12.722882 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m17:15:12.724099 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m17:15:12.725347 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m17:15:12.726512 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m17:15:12.727559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m17:15:12.728525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m17:15:12.729377 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m17:15:12.730104 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m17:15:12.730755 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m17:15:12.731377 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m17:15:12.737562 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m17:15:12.741235 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:15:12.746438 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m17:15:12.748117 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m17:15:12.748580 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m17:15:12.753471 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:12.753894 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m17:15:12.762177 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m17:15:12.772548 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:15:12.774688 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m17:15:12.775135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:12.779840 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m17:15:12.780861 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:15:12.781269 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m17:15:12.781730 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m17:15:12.782121 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:15:12.782420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:13.651789 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.876 seconds
[0m17:15:13.658255 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:13.659168 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:15:13.799426 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.139 seconds
[0m17:15:13.804682 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:13.805213 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m17:15:13.919246 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.113 seconds
[0m17:15:13.929261 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:13.930282 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:15:14.073571 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.142 seconds
[0m17:15:14.081095 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:14.081781 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m17:15:14.236345 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.153 seconds
[0m17:15:14.248085 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:15:14.251861 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m17:15:14.256991 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:14.257686 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:14.348281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.565 seconds
[0m17:15:14.355471 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m17:15:14.451179 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m17:15:14.453715 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:14.455388 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m17:15:14.571240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34dfe00>]}
[0m17:15:14.574059 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.84s]
[0m17:15:14.577534 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:15:14.599045 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.816 seconds
[0m17:15:14.605208 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m17:15:14.835151 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2b68410>]}
[0m17:15:14.836792 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.11s]
[0m17:15:14.839177 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m17:15:15.597501 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.140 seconds
[0m17:15:15.599445 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:15.600298 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m17:15:16.663988 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.063 seconds
[0m17:15:16.668140 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:15:16.669017 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:15:16.669341 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m17:15:16.881178 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m17:15:16.888439 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m17:15:17.070561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5cfa81-5cce-4cec-9394-e8bfa6d12655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0208320>]}
[0m17:15:17.074803 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 4.34s]
[0m17:15:17.079557 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m17:15:17.085640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:17.086565 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m17:15:17.087413 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m17:15:17.088201 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m17:15:17.088807 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m17:15:17.090717 [info ] [MainThread]: 
[0m17:15:17.091475 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 12.99 seconds (12.99s).
[0m17:15:17.093769 [debug] [MainThread]: Command end result
[0m17:15:17.140974 [info ] [MainThread]: 
[0m17:15:17.141926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:17.143339 [info ] [MainThread]: 
[0m17:15:17.144989 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:15:17.151435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.194104, "process_user_time": 4.176575, "process_kernel_time": 2.015105, "process_mem_max_rss": "267840", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m17:15:17.153805 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:17.153432 after 14.20 seconds
[0m17:15:17.154583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb616240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8099220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd809ad80>]}
[0m17:15:17.155001 [debug] [MainThread]: Flushing usage events
[0m17:15:20.822134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc769670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb0dc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbddeb70>]}


============================== 17:15:20.831228 | 1a84b5c0-3fa7-40b0-b10f-141141d42924 ==============================
[0m17:15:20.831228 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:15:20.832455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:21.627984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a84b5c0-3fa7-40b0-b10f-141141d42924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>]}
[0m17:15:21.659323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a84b5c0-3fa7-40b0-b10f-141141d42924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe06990>]}
[0m17:15:21.660057 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:15:21.672420 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:15:21.755548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:21.756034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:21.784724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a84b5c0-3fa7-40b0-b10f-141141d42924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb753110>]}
[0m17:15:21.862745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a84b5c0-3fa7-40b0-b10f-141141d42924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd80cf140>]}
[0m17:15:21.863254 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:15:21.863890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a84b5c0-3fa7-40b0-b10f-141141d42924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8055640>]}
[0m17:15:21.865874 [info ] [MainThread]: 
[0m17:15:21.866513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:15:21.870201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m17:15:21.881727 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:15:21.882074 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:15:21.882383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:23.098979 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.216 seconds
[0m17:15:23.101895 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:15:23.293244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a84b5c0-3fa7-40b0-b10f-141141d42924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8849ac0>]}
[0m17:15:23.293942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:23.294702 [info ] [MainThread]: 
[0m17:15:23.302910 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:15:23.303394 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:15:23.303856 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:15:23.304304 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m17:15:23.304716 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:15:23.305139 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m17:15:23.305649 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m17:15:23.306216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m17:15:23.306633 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m17:15:23.307287 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m17:15:23.307799 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m17:15:23.308202 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:15:23.308654 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m17:15:23.309053 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:15:23.309470 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:15:23.321749 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:15:23.322142 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:15:23.325146 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:15:23.327909 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:15:23.331303 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:15:23.333620 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:15:23.340460 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:15:23.349083 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:15:23.350251 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:15:23.350538 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:15:23.350992 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:15:23.354133 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:15:23.355648 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:15:23.356333 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:15:23.357079 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:15:23.357431 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m17:15:23.358009 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:15:23.358369 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m17:15:23.358747 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:15:23.359262 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:15:23.359620 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m17:15:23.359972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:23.361579 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:15:23.362046 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:15:23.363191 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:15:23.942333 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m17:15:23.943624 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m17:15:23.959260 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m17:15:23.961309 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m17:15:24.088530 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m17:15:24.091286 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m17:15:24.129255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m17:15:24.131979 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m17:15:24.185687 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.88s]
[0m17:15:24.187170 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.88s]
[0m17:15:24.188632 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:15:24.189761 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:15:24.193269 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:15:24.194310 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:15:24.195128 [info ] [Thread-4 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m17:15:24.196144 [info ] [Thread-3 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m17:15:24.196932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m17:15:24.197614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m17:15:24.198246 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:15:24.198831 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:15:24.204012 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:15:24.208167 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:15:24.210285 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:15:24.210681 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:15:24.213107 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:15:24.217170 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:15:24.219880 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:15:24.220332 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:15:24.220804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:15:24.221489 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:15:24.223084 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:15:24.223632 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:15:24.279417 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.97s]
[0m17:15:24.280350 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:15:24.280748 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:15:24.281167 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m17:15:24.281573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m17:15:24.285081 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:15:24.288115 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:15:24.289272 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:15:24.290840 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:15:24.291757 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:15:24.292133 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:15:24.292426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:24.324800 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 1.02s]
[0m17:15:24.325673 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:15:24.326041 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:15:24.326383 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m17:15:24.326830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m17:15:24.327140 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:15:24.330068 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:15:24.330904 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:15:24.332557 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:15:24.333729 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:15:24.334081 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:15:24.334394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:24.730141 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m17:15:24.733944 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m17:15:24.839168 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m17:15:24.845102 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m17:15:24.851413 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m17:15:24.855534 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m17:15:24.919479 [info ] [Thread-4 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.72s]
[0m17:15:24.922494 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:15:24.923635 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:15:24.925197 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m17:15:24.926384 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m17:15:24.927748 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:15:24.934824 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:15:24.938364 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:15:24.941269 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:15:24.942758 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:15:24.943289 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m17:15:24.943772 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:15:25.020133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m17:15:25.023077 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m17:15:25.027983 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.75s]
[0m17:15:25.028887 [info ] [Thread-3 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.83s]
[0m17:15:25.029528 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:15:25.030182 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:15:25.030700 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:15:25.031233 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:15:25.031720 [info ] [Thread-2 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m17:15:25.032299 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m17:15:25.032805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m17:15:25.033291 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m17:15:25.033740 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:15:25.034179 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:15:25.038025 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:15:25.041597 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:15:25.042697 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:15:25.043044 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:15:25.044956 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:15:25.047839 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:15:25.049133 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:15:25.049755 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:15:25.050139 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:15:25.050592 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:15:25.051051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:25.051440 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:15:25.196871 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.87s]
[0m17:15:25.198461 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:15:25.199241 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:15:25.199910 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m17:15:25.200818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m17:15:25.201370 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:15:25.206455 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:15:25.207615 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:15:25.210139 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:15:25.211505 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:15:25.212076 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:15:25.212543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:25.435396 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.491 seconds
[0m17:15:25.441610 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m17:15:25.620570 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m17:15:25.625802 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m17:15:25.685633 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m17:15:25.691671 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m17:15:25.701517 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.77s]
[0m17:15:25.703469 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:15:25.704298 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:15:25.705072 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m17:15:25.706004 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m17:15:25.706627 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:15:25.713259 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:15:25.716536 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:15:25.719273 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:15:25.720641 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:15:25.721127 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:15:25.721540 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:15:25.730906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m17:15:25.733002 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m17:15:25.816757 [info ] [Thread-2 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.78s]
[0m17:15:25.818099 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:15:25.818705 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:15:25.819280 [info ] [Thread-2 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m17:15:25.820083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m17:15:25.820586 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:15:25.827732 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:15:25.828813 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:15:25.831145 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:15:25.832402 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:15:25.832926 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:25.833413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:25.899894 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.87s]
[0m17:15:25.900876 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.70s]
[0m17:15:25.901590 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:15:25.902560 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:15:25.903176 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:15:25.903789 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:15:25.904297 [info ] [Thread-3 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m17:15:25.904941 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m17:15:25.905493 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m17:15:25.905991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m17:15:25.906420 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:15:25.906833 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:15:25.910725 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:15:25.914247 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:15:25.916291 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:15:25.916672 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:15:25.919725 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:15:25.921573 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:15:25.922844 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:15:25.923519 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:15:25.923877 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:25.924309 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:25.924706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:15:25.925059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:26.187456 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m17:15:26.190855 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m17:15:26.369477 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.66s]
[0m17:15:26.372017 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:15:26.373170 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:15:26.374137 [info ] [Thread-4 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m17:15:26.375076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m17:15:26.375823 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:15:26.382389 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:15:26.383905 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:15:26.386903 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:15:26.388505 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:15:26.389043 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:26.389632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:15:26.428903 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m17:15:26.432202 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m17:15:26.479729 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m17:15:26.482241 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m17:15:26.546712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m17:15:26.550666 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m17:15:26.578444 [info ] [Thread-2 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.76s]
[0m17:15:26.579477 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:15:26.579885 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:15:26.580350 [info ] [Thread-2 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m17:15:26.581008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m17:15:26.581382 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:15:26.584661 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:15:26.585585 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:15:26.587436 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:15:26.588376 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:15:26.588720 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:26.589087 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:26.641736 [info ] [Thread-3 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.74s]
[0m17:15:26.643034 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:15:26.717456 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.81s]
[0m17:15:26.719074 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:15:27.013572 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m17:15:27.017466 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m17:15:27.223397 [info ] [Thread-4 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.85s]
[0m17:15:27.225475 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:15:27.261003 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m17:15:27.264901 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m17:15:27.472525 [info ] [Thread-2 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.89s]
[0m17:15:27.476551 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:15:27.482123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:27.483313 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m17:15:27.484178 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m17:15:27.485009 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m17:15:27.485728 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m17:15:27.486654 [info ] [MainThread]: 
[0m17:15:27.488000 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m17:15:27.492825 [debug] [MainThread]: Command end result
[0m17:15:27.579481 [info ] [MainThread]: 
[0m17:15:27.580445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:27.580752 [info ] [MainThread]: 
[0m17:15:27.581245 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m17:15:27.582334 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.803435, "process_user_time": 4.290921, "process_kernel_time": 1.931169, "process_mem_max_rss": "268964", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m17:15:27.582734 [debug] [MainThread]: Command `dbt test` succeeded at 17:15:27.582664 after 6.80 seconds
[0m17:15:27.583060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc417980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5acef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda26ca10>]}
[0m17:15:27.583356 [debug] [MainThread]: Flushing usage events
[0m17:30:02.237263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf80440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7590a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75ac30>]}


============================== 17:30:02.247298 | 8e03b7ad-951a-4476-8bda-d64379013418 ==============================
[0m17:30:02.247298 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:30:02.248005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:30:03.229607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbcba000>]}
[0m17:30:03.260370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd817c140>]}
[0m17:30:03.260987 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:30:03.272700 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:30:03.361848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:03.362275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:03.391221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1da1b0>]}
[0m17:30:03.462985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e89520>]}
[0m17:30:03.463528 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:30:03.463903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ea1f70>]}
[0m17:30:03.465897 [info ] [MainThread]: 
[0m17:30:03.466497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:03.470012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m17:30:03.482181 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m17:30:03.482532 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m17:30:03.482815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:04.786741 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.304 seconds
[0m17:30:04.789708 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m17:30:05.007437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m17:30:05.017516 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:30:05.018081 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:30:05.018471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:05.566161 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.548 seconds
[0m17:30:05.568601 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:30:05.759863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda2896a0>]}
[0m17:30:05.760749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:05.761364 [info ] [MainThread]: 
[0m17:30:05.772182 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m17:30:05.773024 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m17:30:05.773719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m17:30:05.774318 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m17:30:05.782669 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m17:30:05.783998 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m17:30:05.807409 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m17:30:05.810459 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m17:30:05.810899 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m17:30:05.811293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:06.821220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m17:30:06.856428 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m17:30:07.047283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8399160>]}
[0m17:30:07.049782 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.27s]
[0m17:30:07.052081 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m17:30:07.054629 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m17:30:07.056502 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m17:30:07.058163 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m17:30:07.059161 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m17:30:07.075257 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m17:30:07.077121 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m17:30:07.110203 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:07.110833 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m17:30:07.111245 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:30:08.504408 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.392 seconds
[0m17:30:08.518041 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:08.522256 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:30:08.673210 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.149 seconds
[0m17:30:08.678596 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:08.679171 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m17:30:08.829385 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.149 seconds
[0m17:30:08.851702 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:08.852445 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:30:09.000467 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.147 seconds
[0m17:30:09.009108 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:09.010210 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m17:30:09.151943 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.141 seconds
[0m17:30:09.168746 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:30:09.204221 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m17:30:09.210772 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:09.211885 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m17:30:09.350041 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m17:30:09.350561 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:09.351003 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m17:30:11.141041 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.790 seconds
[0m17:30:11.141751 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:11.142207 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m17:30:11.518711 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m17:30:11.538338 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:30:11.548672 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:30:11.549374 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m17:30:11.765678 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m17:30:11.770884 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m17:30:11.984766 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd326c4a0>]}
[0m17:30:11.986336 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 4.93s]
[0m17:30:11.988962 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m17:30:11.990863 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m17:30:11.991842 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:30:11.992685 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m17:30:11.993734 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m17:30:11.995445 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m17:30:11.996578 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m17:30:11.998247 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m17:30:11.999739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m17:30:12.001100 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m17:30:12.001638 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m17:30:12.002314 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m17:30:12.003118 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m17:30:12.009328 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m17:30:12.013190 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:30:12.018143 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m17:30:12.019669 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m17:30:12.020172 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m17:30:12.025578 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:12.025990 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m17:30:12.039165 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m17:30:12.045026 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:30:12.047153 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m17:30:12.047611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:30:12.050740 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:30:12.052919 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m17:30:12.053303 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m17:30:12.053839 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m17:30:12.054348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:12.054715 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:30:12.781794 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m17:30:12.790434 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:12.791624 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:30:12.911402 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.119 seconds
[0m17:30:12.916354 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:12.916824 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m17:30:13.468071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.413 seconds
[0m17:30:13.474137 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m17:30:13.547187 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.630 seconds
[0m17:30:13.560522 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:13.562616 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:30:13.633859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd321d490>]}
[0m17:30:13.635637 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.63s]
[0m17:30:13.637733 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:30:13.703573 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.139 seconds
[0m17:30:13.714188 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:13.715419 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m17:30:13.772984 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.718 seconds
[0m17:30:13.779112 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m17:30:13.851426 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.135 seconds
[0m17:30:13.864483 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:30:13.871712 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m17:30:13.878110 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:13.881648 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m17:30:13.964798 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd32e6a50>]}
[0m17:30:13.965480 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 1.96s]
[0m17:30:13.966069 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m17:30:14.034844 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m17:30:14.035386 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:14.036112 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m17:30:15.218858 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.182 seconds
[0m17:30:15.220528 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:15.221650 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m17:30:15.618890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m17:30:15.630771 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:30:15.633773 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:30:15.634936 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m17:30:15.828426 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m17:30:15.830287 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m17:30:16.037729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e03b7ad-951a-4476-8bda-d64379013418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd32bd1f0>]}
[0m17:30:16.039389 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 4.04s]
[0m17:30:16.040804 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m17:30:16.043669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:16.044492 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m17:30:16.045130 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m17:30:16.045673 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m17:30:16.046147 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m17:30:16.047091 [info ] [MainThread]: 
[0m17:30:16.047868 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 12.58 seconds (12.58s).
[0m17:30:16.050017 [debug] [MainThread]: Command end result
[0m17:30:16.083279 [info ] [MainThread]: 
[0m17:30:16.083795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:16.084116 [info ] [MainThread]: 
[0m17:30:16.084595 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:30:16.086214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.892553, "process_user_time": 4.275873, "process_kernel_time": 2.080883, "process_mem_max_rss": "269432", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m17:30:16.086853 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:16.086746 after 13.89 seconds
[0m17:30:16.087284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf804d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ea26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb965fd0>]}
[0m17:30:16.087633 [debug] [MainThread]: Flushing usage events
[0m17:30:19.031417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb391b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5f4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78f410>]}


============================== 17:30:19.039992 | 7ddcd2b4-7b0e-47ff-b240-08b0003c5c8e ==============================
[0m17:30:19.039992 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:30:19.040936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:30:19.853270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ddcd2b4-7b0e-47ff-b240-08b0003c5c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabca570>]}
[0m17:30:19.884017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ddcd2b4-7b0e-47ff-b240-08b0003c5c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe6dcd0>]}
[0m17:30:19.884586 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:30:19.896018 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:30:19.980321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:19.980791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:20.009657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ddcd2b4-7b0e-47ff-b240-08b0003c5c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8055fd0>]}
[0m17:30:20.087546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ddcd2b4-7b0e-47ff-b240-08b0003c5c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabaa8d0>]}
[0m17:30:20.088033 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:30:20.088711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddcd2b4-7b0e-47ff-b240-08b0003c5c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd98b0da0>]}
[0m17:30:20.090678 [info ] [MainThread]: 
[0m17:30:20.091378 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:20.095244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m17:30:20.107224 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:30:20.107581 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:30:20.107889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:21.778850 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.670 seconds
[0m17:30:21.794533 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:30:21.993420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddcd2b4-7b0e-47ff-b240-08b0003c5c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81b0110>]}
[0m17:30:21.994144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:21.994839 [info ] [MainThread]: 
[0m17:30:22.001659 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:30:22.002062 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:30:22.002409 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:30:22.002808 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m17:30:22.003158 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:30:22.003485 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m17:30:22.003912 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m17:30:22.004405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m17:30:22.004944 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m17:30:22.005613 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m17:30:22.006123 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m17:30:22.006515 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:30:22.006956 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m17:30:22.007323 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:30:22.007665 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:30:22.020435 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:30:22.020864 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:30:22.023645 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:30:22.026671 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:30:22.030336 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:30:22.032428 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:30:22.054014 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:30:22.054511 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:30:22.054963 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:30:22.055274 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:30:22.057184 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:30:22.058839 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:30:22.060625 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:30:22.061443 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:30:22.062601 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m17:30:22.062976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:22.064261 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:30:22.065348 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:30:22.065770 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m17:30:22.066352 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:30:22.066886 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m17:30:22.067498 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:30:22.068153 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:30:22.068562 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:30:22.069549 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:30:22.753474 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m17:30:22.756841 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m17:30:22.849963 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m17:30:22.852566 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m17:30:22.855808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m17:30:22.893712 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m17:30:23.020647 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m17:30:23.023281 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m17:30:23.072535 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 1.06s]
[0m17:30:23.075424 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:30:23.076472 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:30:23.077806 [info ] [Thread-4 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m17:30:23.078732 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 1.07s]
[0m17:30:23.079402 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 1.07s]
[0m17:30:23.080085 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m17:30:23.080649 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:30:23.081122 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:30:23.081518 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:30:23.081945 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:30:23.082522 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:30:23.086714 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:30:23.087180 [info ] [Thread-3 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m17:30:23.087608 [info ] [Thread-1 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m17:30:23.088247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m17:30:23.088664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m17:30:23.089068 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:30:23.089473 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:30:23.089794 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:30:23.093325 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:30:23.096916 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:30:23.100064 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:30:23.101771 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:30:23.102146 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:30:23.103762 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:30:23.105436 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:30:23.105993 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:30:23.106577 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:30:23.106953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:23.107658 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:30:23.108655 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:30:23.109658 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:30:23.111867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:23.115852 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:30:23.120431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:23.220680 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 1.21s]
[0m17:30:23.221871 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:30:23.222296 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:30:23.222683 [info ] [Thread-2 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m17:30:23.223160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m17:30:23.223485 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:30:23.229568 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:30:23.231120 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:30:23.232935 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:30:23.234054 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:30:23.234615 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:30:23.235234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:23.621962 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m17:30:23.624158 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m17:30:23.687841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m17:30:23.689637 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m17:30:23.746524 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m17:30:23.748313 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m17:30:23.795207 [info ] [Thread-4 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.71s]
[0m17:30:23.796611 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:30:23.798301 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:30:23.800482 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m17:30:23.801533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m17:30:23.801941 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:30:23.806075 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:30:23.807003 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:30:23.808960 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:30:23.810013 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:30:23.811260 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m17:30:23.811745 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:23.819657 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m17:30:23.822707 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m17:30:23.870351 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.78s]
[0m17:30:23.885055 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:30:23.900748 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:30:23.902781 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m17:30:23.904489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m17:30:23.906497 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:30:23.918977 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:30:23.924528 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:30:23.930122 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:30:23.932529 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:30:23.933419 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:30:23.934380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:23.949607 [info ] [Thread-3 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.86s]
[0m17:30:23.950331 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:30:23.950874 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:30:23.951419 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m17:30:23.952219 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m17:30:23.952696 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:30:23.956968 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:30:23.957889 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:30:23.963274 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:30:23.964441 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:30:23.964850 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:30:23.965372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:24.019980 [info ] [Thread-2 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.80s]
[0m17:30:24.020797 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:30:24.021369 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:30:24.021807 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m17:30:24.022364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m17:30:24.022827 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:30:24.027523 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:30:24.029446 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:30:24.031810 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:30:24.033281 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:30:24.034222 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:30:24.034743 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:24.368848 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m17:30:24.373552 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m17:30:24.442624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m17:30:24.445388 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m17:30:24.558565 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.76s]
[0m17:30:24.559317 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:30:24.559761 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:30:24.560136 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m17:30:24.560575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m17:30:24.560964 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:30:24.566236 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:30:24.567574 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:30:24.569370 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:30:24.570379 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:30:24.570742 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:30:24.571095 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:24.595939 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.69s]
[0m17:30:24.596727 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:30:24.597297 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:30:24.597845 [info ] [Thread-1 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m17:30:24.598831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m17:30:24.599464 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:30:24.604370 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:30:24.606222 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m17:30:24.608146 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m17:30:24.609771 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:30:24.613085 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:30:24.615175 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m17:30:24.616977 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m17:30:24.618648 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:30:24.619605 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:24.620189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:24.822353 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.87s]
[0m17:30:24.823344 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:30:24.823813 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:30:24.824203 [info ] [Thread-3 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m17:30:24.824616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m17:30:24.824951 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:30:24.828145 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:30:24.829097 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:30:24.832284 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:30:24.833694 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:30:24.834032 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:24.834348 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:24.876757 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.85s]
[0m17:30:24.877546 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:30:24.877983 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:30:24.878396 [info ] [Thread-2 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m17:30:24.878874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m17:30:24.879191 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:30:24.885211 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:30:24.886194 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:30:24.888005 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:30:24.889211 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:30:24.889628 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:24.889967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:25.020973 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m17:30:25.023064 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m17:30:25.095244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m17:30:25.097104 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m17:30:25.180850 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.62s]
[0m17:30:25.181635 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:30:25.182098 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:30:25.182496 [info ] [Thread-4 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m17:30:25.182900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m17:30:25.183243 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:30:25.186501 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:30:25.187446 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:30:25.191372 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:30:25.193307 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:30:25.193693 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:25.194047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:25.262379 [info ] [Thread-1 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.66s]
[0m17:30:25.263121 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:30:25.263619 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:30:25.264293 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m17:30:25.265113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m17:30:25.265707 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:30:25.268874 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:30:25.270642 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:30:25.272750 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:30:25.273909 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:30:25.274318 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:25.274826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:25.454964 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m17:30:25.461648 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m17:30:25.511341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m17:30:25.515624 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m17:30:25.681737 [info ] [Thread-3 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.86s]
[0m17:30:25.683353 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:30:25.716344 [info ] [Thread-2 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.84s]
[0m17:30:25.718167 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:30:25.837231 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m17:30:25.841843 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m17:30:25.988070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m17:30:25.992710 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m17:30:26.033429 [info ] [Thread-4 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.85s]
[0m17:30:26.035413 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:30:26.178617 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.91s]
[0m17:30:26.179779 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:30:26.182348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:26.182719 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m17:30:26.182982 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m17:30:26.183233 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m17:30:26.183490 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m17:30:26.183916 [info ] [MainThread]: 
[0m17:30:26.184248 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 6.09 seconds (6.09s).
[0m17:30:26.186548 [debug] [MainThread]: Command end result
[0m17:30:26.295139 [info ] [MainThread]: 
[0m17:30:26.295764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:26.296142 [info ] [MainThread]: 
[0m17:30:26.296815 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m17:30:26.299010 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.3142767, "process_user_time": 4.649857, "process_kernel_time": 1.968906, "process_mem_max_rss": "270176", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m17:30:26.299734 [debug] [MainThread]: Command `dbt test` succeeded at 17:30:26.299597 after 7.32 seconds
[0m17:30:26.300302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbb26360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda238fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa823d40>]}
[0m17:30:26.300785 [debug] [MainThread]: Flushing usage events
[0m17:45:02.241844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf82930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7b8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb600830>]}


============================== 17:45:02.251026 | 9afb22c8-0630-4b0f-99f8-43775c60e2d6 ==============================
[0m17:45:02.251026 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:45:02.251805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:03.138716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabc8260>]}
[0m17:45:03.175703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbcbde80>]}
[0m17:45:03.176551 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:45:03.190188 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:45:03.292311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:03.292797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:03.322991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8081100>]}
[0m17:45:03.397664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e8d100>]}
[0m17:45:03.398123 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:45:03.398486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3ebfa40>]}
[0m17:45:03.400285 [info ] [MainThread]: 
[0m17:45:03.400913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:03.404654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m17:45:03.415225 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m17:45:03.415543 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m17:45:03.415844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:04.571783 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.156 seconds
[0m17:45:04.576095 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m17:45:04.872327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m17:45:04.888117 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:45:04.888897 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:45:04.889400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:05.561753 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.672 seconds
[0m17:45:05.568716 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:45:05.957408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd866cb60>]}
[0m17:45:05.959280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:05.960860 [info ] [MainThread]: 
[0m17:45:05.975516 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m17:45:05.976522 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m17:45:05.977362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m17:45:05.978060 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m17:45:05.987165 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m17:45:05.989384 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m17:45:06.014204 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m17:45:06.017670 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m17:45:06.018152 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m17:45:06.018697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:07.241849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.222 seconds
[0m17:45:07.273863 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m17:45:07.473729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd839ce00>]}
[0m17:45:07.475803 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.49s]
[0m17:45:07.477951 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m17:45:07.480839 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m17:45:07.481937 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m17:45:07.482965 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m17:45:07.483589 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m17:45:07.496276 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m17:45:07.498732 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m17:45:07.528669 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:07.529142 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m17:45:07.529541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:45:08.380232 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m17:45:08.389945 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:08.390419 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:45:08.534592 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.144 seconds
[0m17:45:08.549038 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:08.549744 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m17:45:08.719405 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.169 seconds
[0m17:45:08.734181 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:08.734787 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:45:08.875426 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.140 seconds
[0m17:45:08.879827 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:08.880436 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m17:45:09.019704 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.139 seconds
[0m17:45:09.034627 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:45:09.062435 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m17:45:09.064748 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:09.065214 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m17:45:09.243520 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m17:45:09.244822 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:09.246080 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m17:45:11.488088 [debug] [Thread-3 (]: SQL status: SUCCESS 368 in 2.241 seconds
[0m17:45:11.489233 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:11.489893 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m17:45:11.862223 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m17:45:11.877664 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m17:45:11.886825 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m17:45:11.887367 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m17:45:12.104738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m17:45:12.110872 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m17:45:12.290016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34fb920>]}
[0m17:45:12.291080 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 368[0m in 4.81s]
[0m17:45:12.292898 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m17:45:12.295310 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m17:45:12.295949 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:45:12.296382 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m17:45:12.297319 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m17:45:12.297954 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m17:45:12.298536 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m17:45:12.299309 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m17:45:12.301301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m17:45:12.302447 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m17:45:12.302928 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m17:45:12.303474 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m17:45:12.303873 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m17:45:12.308415 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m17:45:12.311820 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:45:12.316969 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m17:45:12.319841 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m17:45:12.320672 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m17:45:12.325096 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:12.325647 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m17:45:12.344886 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m17:45:12.351158 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:45:12.353573 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m17:45:12.354034 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:12.357381 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m17:45:12.357980 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m17:45:12.360235 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m17:45:12.360735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:12.361245 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m17:45:12.363377 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:13.035109 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m17:45:13.040136 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:13.040986 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:45:13.182716 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.141 seconds
[0m17:45:13.193476 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:13.194856 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m17:45:13.346976 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.151 seconds
[0m17:45:13.359687 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:13.361143 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:45:13.471077 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.109 seconds
[0m17:45:13.478551 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:13.479262 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m17:45:13.555642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.195 seconds
[0m17:45:13.561860 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m17:45:13.610557 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.130 seconds
[0m17:45:13.622362 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:45:13.628424 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m17:45:13.633498 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:13.634384 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m17:45:13.748591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34361b0>]}
[0m17:45:13.755733 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.45s]
[0m17:45:13.759076 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m17:45:13.800257 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m17:45:13.800873 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:13.801393 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m17:45:13.850142 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.487 seconds
[0m17:45:13.852772 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m17:45:14.045913 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0226e10>]}
[0m17:45:14.048093 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 1.74s]
[0m17:45:14.049646 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m17:45:14.990047 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.188 seconds
[0m17:45:14.991352 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:14.991929 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m17:45:15.415043 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m17:45:15.419924 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m17:45:15.420845 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m17:45:15.421227 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m17:45:15.616927 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m17:45:15.620715 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m17:45:15.829837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afb22c8-0630-4b0f-99f8-43775c60e2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0208530>]}
[0m17:45:15.832253 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.53s]
[0m17:45:15.834491 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m17:45:15.839406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:15.841395 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m17:45:15.843143 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m17:45:15.844636 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m17:45:15.845889 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m17:45:15.847507 [info ] [MainThread]: 
[0m17:45:15.848537 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 12.45 seconds (12.45s).
[0m17:45:15.851737 [debug] [MainThread]: Command end result
[0m17:45:15.893723 [info ] [MainThread]: 
[0m17:45:15.894700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:15.895146 [info ] [MainThread]: 
[0m17:45:15.895690 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:45:15.897744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.7004, "process_user_time": 4.209144, "process_kernel_time": 1.956037, "process_mem_max_rss": "268040", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m17:45:15.898495 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:15.898386 after 13.70 seconds
[0m17:45:15.898978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf80620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffafc85f0>]}
[0m17:45:15.899315 [debug] [MainThread]: Flushing usage events
[0m17:45:19.618780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd103e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe47ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe44c80>]}


============================== 17:45:19.630089 | 623665b8-8d7d-4e2d-ba36-c4d94bc178de ==============================
[0m17:45:19.630089 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:45:19.631023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:45:20.474720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '623665b8-8d7d-4e2d-ba36-c4d94bc178de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbddd1f0>]}
[0m17:45:20.509543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '623665b8-8d7d-4e2d-ba36-c4d94bc178de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf80410>]}
[0m17:45:20.510332 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:45:20.523300 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:45:20.614911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:20.615376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:20.644348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '623665b8-8d7d-4e2d-ba36-c4d94bc178de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8086d80>]}
[0m17:45:20.724346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '623665b8-8d7d-4e2d-ba36-c4d94bc178de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da0f20>]}
[0m17:45:20.724869 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m17:45:20.725309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '623665b8-8d7d-4e2d-ba36-c4d94bc178de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81b0ec0>]}
[0m17:45:20.727449 [info ] [MainThread]: 
[0m17:45:20.728083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:20.731850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m17:45:20.744005 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m17:45:20.744358 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m17:45:20.744670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:21.935844 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.190 seconds
[0m17:45:21.943743 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m17:45:22.182485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '623665b8-8d7d-4e2d-ba36-c4d94bc178de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc5ad130>]}
[0m17:45:22.184659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:22.185888 [info ] [MainThread]: 
[0m17:45:22.202963 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:45:22.203886 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:45:22.204666 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:45:22.205430 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m17:45:22.206170 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:45:22.206820 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m17:45:22.207523 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m17:45:22.208410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m17:45:22.209082 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m17:45:22.209905 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m17:45:22.210580 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m17:45:22.211144 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:45:22.211845 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m17:45:22.212392 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:45:22.212924 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:45:22.226558 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:45:22.230563 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:45:22.234725 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:45:22.238266 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:45:22.242784 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:45:22.245308 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:45:22.245733 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:45:22.246137 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:45:22.269615 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:45:22.273207 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:45:22.274542 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:45:22.276426 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:45:22.278069 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:45:22.279861 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m17:45:22.280417 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m17:45:22.280809 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m17:45:22.281368 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m17:45:22.281715 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m17:45:22.282312 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m17:45:22.282723 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:22.283214 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m17:45:22.283583 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:45:22.283952 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:45:22.285139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:22.287110 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:22.781301 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m17:45:22.809344 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m17:45:22.813048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m17:45:22.816105 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m17:45:22.866730 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m17:45:22.868476 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m17:45:22.936621 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m17:45:22.938820 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m17:45:23.036078 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.83s]
[0m17:45:23.037045 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m17:45:23.037524 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:45:23.037963 [info ] [Thread-1 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m17:45:23.038379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m17:45:23.038731 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:45:23.042412 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:45:23.045519 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.83s]
[0m17:45:23.046017 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:45:23.046498 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m17:45:23.048922 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:45:23.049372 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:45:23.049982 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m17:45:23.050489 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m17:45:23.050872 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:45:23.053971 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:45:23.054577 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m17:45:23.055093 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:45:23.055414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:23.056343 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:45:23.060077 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:45:23.061379 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m17:45:23.061772 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:45:23.062109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:23.067827 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.86s]
[0m17:45:23.068416 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m17:45:23.068851 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:45:23.069192 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m17:45:23.069569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m17:45:23.069866 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:45:23.072918 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:45:23.073847 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:45:23.075634 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:45:23.076614 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m17:45:23.077346 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:45:23.077864 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:23.148650 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.94s]
[0m17:45:23.149304 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m17:45:23.149706 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:45:23.150066 [info ] [Thread-3 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m17:45:23.150436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m17:45:23.150759 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:45:23.153913 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:45:23.154813 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:45:23.156504 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:45:23.157705 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m17:45:23.158047 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:45:23.158358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:23.530136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m17:45:23.532806 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m17:45:23.535203 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m17:45:23.537529 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m17:45:23.541414 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m17:45:23.543471 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m17:45:23.708417 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.66s]
[0m17:45:23.709390 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m17:45:23.709868 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:45:23.710291 [info ] [Thread-4 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m17:45:23.710934 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m17:45:23.711357 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:45:23.714770 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:45:23.715519 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:45:23.717176 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:45:23.718012 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m17:45:23.718313 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m17:45:23.718601 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:23.730217 [info ] [Thread-1 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.69s]
[0m17:45:23.731077 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m17:45:23.731661 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.66s]
[0m17:45:23.732101 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:45:23.732552 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m17:45:23.732915 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m17:45:23.733346 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:45:23.733747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m17:45:23.734107 [info ] [Thread-2 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m17:45:23.734601 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:45:23.734972 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m17:45:23.737722 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:45:23.738040 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:45:23.740842 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:45:23.741485 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:45:23.743013 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:45:23.743440 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:45:23.745640 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:45:23.746302 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m17:45:23.746625 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m17:45:23.746953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:23.747962 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m17:45:23.748633 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m17:45:23.749103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:24.354847 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m17:45:24.360670 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m17:45:24.373056 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m17:45:24.379169 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m17:45:24.386103 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.228 seconds
[0m17:45:24.389644 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m17:45:24.390954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m17:45:24.396736 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m17:45:24.565990 [info ] [Thread-2 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.83s]
[0m17:45:24.570160 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m17:45:24.573079 [info ] [Thread-4 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.86s]
[0m17:45:24.574628 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:45:24.576390 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m17:45:24.577808 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.84s]
[0m17:45:24.578799 [info ] [Thread-2 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m17:45:24.580677 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:45:24.583026 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m17:45:24.584258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m17:45:24.585516 [info ] [Thread-3 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.43s]
[0m17:45:24.586251 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m17:45:24.587168 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:45:24.587861 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:45:24.588833 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m17:45:24.589512 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m17:45:24.590203 [info ] [Thread-1 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m17:45:24.595779 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:45:24.596352 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:45:24.596981 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:45:24.597696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m17:45:24.598481 [info ] [Thread-3 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m17:45:24.617124 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m17:45:24.613684 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:45:24.611356 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:45:24.618698 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:45:24.619208 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:45:24.632767 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:45:24.639021 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:45:24.641848 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:45:24.642690 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:45:24.645022 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:45:24.645662 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:45:24.647765 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:45:24.648171 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:45:24.648800 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m17:45:24.649738 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m17:45:24.652146 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:45:24.652689 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m17:45:24.653178 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m17:45:24.653951 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m17:45:24.654465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:24.654853 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:24.655279 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:24.656090 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m17:45:24.664725 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:24.666972 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:24.669733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:25.195832 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m17:45:25.203168 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m17:45:25.235725 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m17:45:25.241097 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m17:45:25.311233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m17:45:25.316734 [debug] [Thread-1 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m17:45:25.394803 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m17:45:25.400643 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m17:45:25.415251 [info ] [Thread-2 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.83s]
[0m17:45:25.421349 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m17:45:25.422708 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:45:25.423919 [info ] [Thread-2 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m17:45:25.425928 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.84s]
[0m17:45:25.426706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m17:45:25.427671 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m17:45:25.428289 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:45:25.429041 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:45:25.436816 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:45:25.437354 [info ] [Thread-4 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m17:45:25.438200 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m17:45:25.438676 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:45:25.442755 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:45:25.443468 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:45:25.445692 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:45:25.446316 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:45:25.448518 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:45:25.449471 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m17:45:25.449903 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:25.450338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:25.451180 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m17:45:25.453080 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:25.453543 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:25.546198 [info ] [Thread-1 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.95s]
[0m17:45:25.547870 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m17:45:25.548584 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:45:25.549162 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m17:45:25.550320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m17:45:25.550945 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:45:25.555511 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:45:25.556714 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:45:25.558945 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:45:25.560324 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m17:45:25.560786 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:25.561163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:25.634623 [info ] [Thread-3 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 1.02s]
[0m17:45:25.635969 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m17:45:26.017371 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m17:45:26.023576 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m17:45:26.064455 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m17:45:26.068854 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m17:45:26.210384 [info ] [Thread-4 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.77s]
[0m17:45:26.213855 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m17:45:26.234796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m17:45:26.239968 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m17:45:26.246150 [info ] [Thread-2 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.82s]
[0m17:45:26.247888 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m17:45:26.405907 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.86s]
[0m17:45:26.406778 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m17:45:26.409035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:26.409533 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m17:45:26.409958 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m17:45:26.410314 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m17:45:26.410672 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m17:45:26.411136 [info ] [MainThread]: 
[0m17:45:26.411582 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m17:45:26.414402 [debug] [MainThread]: Command end result
[0m17:45:26.492595 [info ] [MainThread]: 
[0m17:45:26.493068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:26.493338 [info ] [MainThread]: 
[0m17:45:26.493670 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m17:45:26.494722 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.921902, "process_user_time": 4.559679, "process_kernel_time": 2.02382, "process_mem_max_rss": "268908", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m17:45:26.495128 [debug] [MainThread]: Command `dbt test` succeeded at 17:45:26.495056 after 6.92 seconds
[0m17:45:26.495462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb6740b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8929af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7ebef0>]}
[0m17:45:26.495785 [debug] [MainThread]: Flushing usage events
[0m18:00:02.408940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbb9d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb674e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb952de0>]}


============================== 18:00:02.418105 | bc1ea907-0a68-48e1-9581-2358709dc893 ==============================
[0m18:00:02.418105 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:00:02.418812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:03.208545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe03b7a40>]}
[0m18:00:03.239258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbb9d1c0>]}
[0m18:00:03.239969 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:03.253868 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:00:03.338044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:03.338499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:03.367516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd98ac8f0>]}
[0m18:00:03.441609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e896a0>]}
[0m18:00:03.442131 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m18:00:03.442489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd9c6c080>]}
[0m18:00:03.444252 [info ] [MainThread]: 
[0m18:00:03.444869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:03.448469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m18:00:03.459452 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m18:00:03.459769 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m18:00:03.460062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:04.692701 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.232 seconds
[0m18:00:04.696315 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m18:00:04.884907 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m18:00:04.903450 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m18:00:04.904355 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m18:00:04.905110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:05.522515 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.617 seconds
[0m18:00:05.530219 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m18:00:05.709660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7225a0>]}
[0m18:00:05.711651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:05.712870 [info ] [MainThread]: 
[0m18:00:05.728233 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m18:00:05.729548 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m18:00:05.730458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m18:00:05.731080 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m18:00:05.740316 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m18:00:05.741801 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m18:00:05.766290 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m18:00:05.769308 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m18:00:05.769812 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m18:00:05.770374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:06.468920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m18:00:06.489487 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m18:00:06.668720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398e90>]}
[0m18:00:06.671203 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m18:00:06.673569 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m18:00:06.676631 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m18:00:06.678596 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m18:00:06.680497 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m18:00:06.681242 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m18:00:06.694530 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m18:00:06.696795 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m18:00:06.727588 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:06.728091 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m18:00:06.728492 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:08.042029 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m18:00:08.063282 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:08.064420 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:00:08.208356 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.143 seconds
[0m18:00:08.220522 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:08.221597 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m18:00:08.373143 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.151 seconds
[0m18:00:08.388570 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:08.389125 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:00:08.545774 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.156 seconds
[0m18:00:08.557806 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:08.558957 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m18:00:08.685803 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.126 seconds
[0m18:00:08.711963 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:00:08.741042 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m18:00:08.743765 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:08.744161 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m18:00:09.470658 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m18:00:09.471421 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:09.472137 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m18:00:15.713235 [debug] [Thread-3 (]: SQL status: SUCCESS 2222 in 6.239 seconds
[0m18:00:15.715237 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:15.716696 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m18:00:17.854283 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.136 seconds
[0m18:00:17.874180 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:00:17.883665 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:00:17.884334 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m18:00:18.095536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m18:00:18.102256 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m18:00:18.515098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3499250>]}
[0m18:00:18.517460 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 2222[0m in 11.83s]
[0m18:00:18.519462 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m18:00:18.521602 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m18:00:18.522478 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m18:00:18.523254 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m18:00:18.524160 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m18:00:18.525181 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m18:00:18.526064 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m18:00:18.526904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m18:00:18.527678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m18:00:18.528505 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m18:00:18.529180 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m18:00:18.529818 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m18:00:18.530443 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m18:00:18.535959 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m18:00:18.539329 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:00:18.543733 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m18:00:18.545251 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m18:00:18.545797 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m18:00:18.558059 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m18:00:18.568530 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:18.569018 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:00:18.571032 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m18:00:18.571513 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m18:00:18.572470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:18.574934 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:00:18.575337 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m18:00:18.577441 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m18:00:18.577781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:18.578281 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m18:00:18.579428 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:00:20.430868 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.858 seconds
[0m18:00:20.439696 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:20.441110 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:00:20.613279 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.171 seconds
[0m18:00:20.620814 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:20.621508 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m18:00:20.785850 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.163 seconds
[0m18:00:20.798158 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:20.799381 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:00:21.309802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.732 seconds
[0m18:00:21.312389 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m18:00:21.998950 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.419 seconds
[0m18:00:22.001525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2be8e90>]}
[0m18:00:22.007077 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m18:00:22.008912 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 3.47s]
[0m18:00:22.014814 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m18:00:22.124385 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 1.324 seconds
[0m18:00:22.138922 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:22.140803 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m18:00:22.340134 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.198 seconds
[0m18:00:22.344411 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:00:22.346125 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m18:00:22.349118 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:22.349547 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m18:00:22.540218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34f5220>]}
[0m18:00:22.541405 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 4.01s]
[0m18:00:22.542299 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m18:00:22.609822 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m18:00:22.611175 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:22.612642 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m18:00:23.808930 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 1.195 seconds
[0m18:00:23.810922 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:23.811921 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m18:00:24.260220 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m18:00:24.264440 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:00:24.265609 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:00:24.266027 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m18:00:24.441921 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m18:00:24.447852 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m18:00:24.733745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1ea907-0a68-48e1-9581-2358709dc893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3dbb0b0>]}
[0m18:00:24.739228 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 9[0m in 6.20s]
[0m18:00:24.743397 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m18:00:24.748047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:24.749086 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m18:00:24.749830 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m18:00:24.750466 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m18:00:24.751091 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m18:00:24.752260 [info ] [MainThread]: 
[0m18:00:24.753105 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 21.31 seconds (21.31s).
[0m18:00:24.755755 [debug] [MainThread]: Command end result
[0m18:00:24.797376 [info ] [MainThread]: 
[0m18:00:24.798048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:24.798466 [info ] [MainThread]: 
[0m18:00:24.798918 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:00:24.800627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.4354, "process_user_time": 4.171082, "process_kernel_time": 1.933428, "process_mem_max_rss": "268048", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m18:00:24.801277 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:24.801182 after 22.44 seconds
[0m18:00:24.801724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7ca480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd7f88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbe6e240>]}
[0m18:00:24.802047 [debug] [MainThread]: Flushing usage events
[0m18:00:28.872262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb351b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9513a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb71f920>]}


============================== 18:00:28.882521 | f2ac9b85-3220-4658-9c7b-36942f4df14e ==============================
[0m18:00:28.882521 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:00:28.883676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:00:29.754096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2ac9b85-3220-4658-9c7b-36942f4df14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc4e7e60>]}
[0m18:00:29.786469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2ac9b85-3220-4658-9c7b-36942f4df14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda2553a0>]}
[0m18:00:29.787186 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:29.807518 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:00:29.941487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:29.942172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:29.975936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2ac9b85-3220-4658-9c7b-36942f4df14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd81b25d0>]}
[0m18:00:30.060839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2ac9b85-3220-4658-9c7b-36942f4df14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3da0860>]}
[0m18:00:30.061384 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m18:00:30.061790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2ac9b85-3220-4658-9c7b-36942f4df14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d87560>]}
[0m18:00:30.064102 [info ] [MainThread]: 
[0m18:00:30.064775 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:30.068750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m18:00:30.080510 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m18:00:30.080868 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m18:00:30.081192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:31.398365 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.316 seconds
[0m18:00:31.406955 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m18:00:31.753789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2ac9b85-3220-4658-9c7b-36942f4df14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8150fe0>]}
[0m18:00:31.755503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:31.756369 [info ] [MainThread]: 
[0m18:00:31.771611 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:00:31.772328 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:00:31.772965 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:00:31.773599 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m18:00:31.774171 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:00:31.774658 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m18:00:31.775323 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m18:00:31.775990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m18:00:31.776576 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m18:00:31.777302 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m18:00:31.777902 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m18:00:31.778403 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:00:31.779023 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m18:00:31.779480 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:00:31.779902 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:00:31.795165 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:00:31.795558 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:00:31.798882 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:00:31.801985 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:00:31.806116 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:00:31.807216 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:00:31.821125 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:00:31.830199 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:00:31.832716 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:00:31.833304 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:00:31.833787 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:00:31.836253 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:00:31.838400 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:00:31.839617 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:00:31.840465 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:00:31.841111 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m18:00:31.841872 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m18:00:31.842688 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:00:31.843199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:31.843936 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:00:31.844239 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:31.844626 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:00:31.846118 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m18:00:31.849501 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:00:31.850246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:00:32.384165 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m18:00:32.394638 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m18:00:32.432904 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m18:00:32.434640 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m18:00:32.520276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m18:00:32.523353 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m18:00:32.624524 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.85s]
[0m18:00:32.625941 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:00:32.626564 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:00:32.627178 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m18:00:32.627754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m18:00:32.628178 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:00:32.632603 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:00:32.633686 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:00:32.635857 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:00:32.636859 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:00:32.637222 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m18:00:32.637584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:32.700471 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.92s]
[0m18:00:32.701273 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:00:32.701782 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:00:32.702248 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m18:00:32.702708 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m18:00:32.703095 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:00:32.706899 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:00:32.707876 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:00:32.710782 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:00:32.711965 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:00:32.712329 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m18:00:32.712682 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:32.760944 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.98s]
[0m18:00:32.761738 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:00:32.762227 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:00:32.762710 [info ] [Thread-1 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m18:00:32.763191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m18:00:32.763604 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:00:32.767738 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:00:32.771884 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:00:32.774131 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:00:32.775343 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:00:32.775815 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m18:00:32.776197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:33.249808 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m18:00:33.256203 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m18:00:33.435078 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m18:00:33.441178 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m18:00:33.457581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m18:00:33.463118 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m18:00:33.663448 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.813 seconds
[0m18:00:33.665532 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.96s]
[0m18:00:33.668423 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m18:00:33.669388 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:00:33.671528 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:00:33.672728 [info ] [Thread-4 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m18:00:33.673768 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m18:00:33.674411 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:00:33.679559 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:00:33.681491 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.92s]
[0m18:00:33.681959 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:00:33.682505 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:00:33.684753 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:00:33.685239 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:00:33.685797 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m18:00:33.686232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m18:00:33.686638 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:00:33.687334 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:00:33.690759 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:00:33.691210 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:00:33.691777 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:33.694019 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:00:33.696231 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:00:33.697319 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:00:33.697683 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m18:00:33.698210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:33.863374 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 2.09s]
[0m18:00:33.866014 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:00:33.878728 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:00:33.879438 [info ] [Thread-2 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m18:00:33.885663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m18:00:33.889087 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:00:33.893637 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:00:33.894783 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:00:33.897022 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:00:33.898232 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:00:33.898688 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m18:00:33.899086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:33.950773 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 1.32s]
[0m18:00:33.951745 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:00:33.952532 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:00:33.953197 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m18:00:33.953874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m18:00:33.954428 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:00:33.960215 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:00:33.961294 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:00:33.963506 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:00:33.964827 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:00:33.965270 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m18:00:33.965705 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:34.794022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.095 seconds
[0m18:00:34.799771 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m18:00:34.975841 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 1.29s]
[0m18:00:34.981395 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.289 seconds
[0m18:00:34.983530 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:00:34.989683 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m18:00:34.991152 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:00:34.996112 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m18:00:34.997283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m18:00:34.998017 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:00:35.006593 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:00:35.009699 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.044 seconds
[0m18:00:35.010750 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.112 seconds
[0m18:00:35.013466 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m18:00:35.015772 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m18:00:35.019652 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:00:35.022637 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:00:35.024854 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:00:35.025531 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m18:00:35.026066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:35.291750 [info ] [Thread-4 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.62s]
[0m18:00:35.293305 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:00:35.294839 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:00:35.296066 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m18:00:35.296976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m18:00:35.297666 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:00:35.305605 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:00:35.307426 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:00:35.311009 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:00:35.312406 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:00:35.312920 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:00:35.313377 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:35.540629 [info ] [Thread-2 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 1.65s]
[0m18:00:35.542373 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:00:35.543265 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:00:35.544117 [info ] [Thread-2 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m18:00:35.545034 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m18:00:35.545747 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:00:35.553945 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:00:35.555231 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:00:35.557811 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:00:35.559161 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:00:35.559691 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:35.560163 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:35.574971 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 1.62s]
[0m18:00:35.575892 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:00:35.576423 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:00:35.576876 [info ] [Thread-3 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m18:00:35.577347 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m18:00:35.577746 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:00:35.582437 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:00:35.584478 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:00:35.587800 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:00:35.589116 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:00:35.589519 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:35.589931 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:35.710759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m18:00:35.715154 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m18:00:36.000881 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 1.00s]
[0m18:00:36.003140 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:00:36.004527 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:00:36.005582 [info ] [Thread-1 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m18:00:36.006785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m18:00:36.007908 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:00:36.016519 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:00:36.018428 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:00:36.022794 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:00:36.025290 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:00:36.026623 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:36.027426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:36.297252 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m18:00:36.303159 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m18:00:36.308920 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m18:00:36.313261 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m18:00:36.516021 [info ] [Thread-3 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.94s]
[0m18:00:36.518385 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:00:36.521202 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:00:36.522523 [info ] [Thread-3 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m18:00:36.523989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m18:00:36.526085 [info ] [Thread-2 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.98s]
[0m18:00:36.527183 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:00:36.528844 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:00:36.536298 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:00:36.537306 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:00:36.538307 [info ] [Thread-2 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m18:00:36.539086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m18:00:36.539711 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:00:36.544822 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:00:36.545369 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:00:36.548469 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:00:36.549378 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:00:36.551894 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:00:36.553055 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:00:36.553596 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:36.554079 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:36.555103 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:00:36.556249 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:36.557275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:36.720690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m18:00:36.724949 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m18:00:36.887666 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m18:00:36.891455 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m18:00:37.001560 [info ] [Thread-1 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.99s]
[0m18:00:37.003845 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:00:37.156317 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 1.86s]
[0m18:00:37.157491 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:00:37.521542 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.964 seconds
[0m18:00:37.527137 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m18:00:37.704795 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m18:00:37.708644 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m18:00:37.732733 [info ] [Thread-2 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 1.19s]
[0m18:00:37.734012 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:00:38.023577 [info ] [Thread-3 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 1.50s]
[0m18:00:38.026175 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:00:38.032571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:38.034049 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m18:00:38.034941 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m18:00:38.035845 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m18:00:38.036611 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f' was properly closed.
[0m18:00:38.037912 [info ] [MainThread]: 
[0m18:00:38.038853 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m18:00:38.044066 [debug] [MainThread]: Command end result
[0m18:00:38.168519 [info ] [MainThread]: 
[0m18:00:38.168994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:38.169286 [info ] [MainThread]: 
[0m18:00:38.169668 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:00:38.171145 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.352818, "process_user_time": 4.91434, "process_kernel_time": 1.968001, "process_mem_max_rss": "268992", "process_out_blocks": "2223", "process_in_blocks": "0"}
[0m18:00:38.172069 [debug] [MainThread]: Command `dbt test` succeeded at 18:00:38.171871 after 9.35 seconds
[0m18:00:38.172764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb351b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd84d2de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd808a420>]}
[0m18:00:38.173144 [debug] [MainThread]: Flushing usage events
[0m18:15:02.553095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbace240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb170f20>]}


============================== 18:15:02.562189 | 5365ddb8-666e-499a-bd8f-3d4af19ac14b ==============================
[0m18:15:02.562189 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:15:02.563054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:15:03.453418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8849df0>]}
[0m18:15:03.485388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabcaf00>]}
[0m18:15:03.486054 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:15:03.501961 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:15:03.588343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:03.588828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:03.617796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8206e40>]}
[0m18:15:03.701594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e88890>]}
[0m18:15:03.702236 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m18:15:03.703124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffda26d850>]}
[0m18:15:03.706079 [info ] [MainThread]: 
[0m18:15:03.707726 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:15:03.711981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m18:15:03.723714 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m18:15:03.724130 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m18:15:03.724433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:04.923971 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.199 seconds
[0m18:15:04.928158 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m18:15:05.168783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now list_USER_DB_PLATYPUS_ANALYTICS)
[0m18:15:05.188244 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m18:15:05.189114 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m18:15:05.189654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:05.941030 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.751 seconds
[0m18:15:05.945924 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m18:15:06.245379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffabca990>]}
[0m18:15:06.248428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:06.253059 [info ] [MainThread]: 
[0m18:15:06.269580 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m18:15:06.270719 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m18:15:06.271783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m18:15:06.272301 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m18:15:06.282389 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m18:15:06.283841 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m18:15:06.307878 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m18:15:06.310940 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m18:15:06.311385 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m18:15:06.311994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:07.641248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.330 seconds
[0m18:15:07.667055 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m18:15:07.948354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8398f80>]}
[0m18:15:07.951294 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.67s]
[0m18:15:07.955490 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m18:15:07.959357 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m18:15:07.961319 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m18:15:07.963090 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m18:15:07.963863 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m18:15:07.977753 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m18:15:07.979453 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m18:15:08.009570 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:08.010047 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m18:15:08.010488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:15:09.317556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m18:15:09.338178 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:09.339127 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:15:09.588601 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.248 seconds
[0m18:15:09.601535 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:09.604392 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m18:15:09.745242 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.138 seconds
[0m18:15:09.775055 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:09.776187 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:15:09.900175 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.123 seconds
[0m18:15:09.910233 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:09.911076 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m18:15:10.077137 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.165 seconds
[0m18:15:10.103046 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:15:10.134959 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m18:15:10.137412 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:10.137864 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m18:15:10.356989 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m18:15:10.358281 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:10.359306 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m18:15:12.497063 [debug] [Thread-3 (]: SQL status: SUCCESS 2 in 2.136 seconds
[0m18:15:12.499269 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:12.500609 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m18:15:12.895648 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m18:15:12.903157 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:15:12.908141 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:15:12.908613 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m18:15:13.224915 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m18:15:13.228358 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m18:15:13.422719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd332dd90>]}
[0m18:15:13.423849 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 2[0m in 5.46s]
[0m18:15:13.425285 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m18:15:13.426584 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m18:15:13.427128 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m18:15:13.427611 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m18:15:13.428147 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m18:15:13.428983 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m18:15:13.429626 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m18:15:13.430383 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_daily_summary'
[0m18:15:13.431026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m18:15:13.431715 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m18:15:13.432239 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m18:15:13.432718 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m18:15:13.433214 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m18:15:13.437520 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m18:15:13.440420 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:15:13.444362 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m18:15:13.446620 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m18:15:13.450998 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:13.451400 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m18:15:13.451844 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m18:15:13.452257 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m18:15:13.464296 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:15:13.468999 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:15:13.470951 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m18:15:13.474204 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:15:13.476255 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m18:15:13.476617 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m18:15:13.477209 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m18:15:13.477643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:13.477998 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:15:14.332210 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.867 seconds
[0m18:15:14.341939 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:14.343078 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:15:14.468462 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.124 seconds
[0m18:15:14.480605 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:14.481626 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m18:15:14.591714 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.109 seconds
[0m18:15:14.598833 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:14.599577 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:15:14.742450 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.142 seconds
[0m18:15:14.755944 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:14.758019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m18:15:14.758957 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m18:15:14.762942 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m18:15:14.865796 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.102 seconds
[0m18:15:14.876683 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:15:14.881478 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m18:15:14.885957 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:14.886600 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m18:15:14.965465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34de870>]}
[0m18:15:14.967113 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.53s]
[0m18:15:14.969184 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m18:15:15.083432 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m18:15:15.085206 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:15.086647 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m18:15:15.344927 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.867 seconds
[0m18:15:15.348596 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m18:15:15.526553 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34fb1d0>]}
[0m18:15:15.529057 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.09s]
[0m18:15:15.532818 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m18:15:16.381696 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.293 seconds
[0m18:15:16.384130 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:16.385580 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m18:15:16.792467 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m18:15:16.800998 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:15:16.802682 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:15:16.803307 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m18:15:17.000116 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m18:15:17.006180 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m18:15:17.421144 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5365ddb8-666e-499a-bd8f-3d4af19ac14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0206510>]}
[0m18:15:17.422390 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 3.99s]
[0m18:15:17.424053 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m18:15:17.426459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:17.427122 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m18:15:17.427618 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m18:15:17.428095 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m18:15:17.428530 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m18:15:17.429349 [info ] [MainThread]: 
[0m18:15:17.430117 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 13.72 seconds (13.72s).
[0m18:15:17.431798 [debug] [MainThread]: Command end result
[0m18:15:17.463853 [info ] [MainThread]: 
[0m18:15:17.464647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:17.465000 [info ] [MainThread]: 
[0m18:15:17.465547 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:15:17.466976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.961356, "process_user_time": 4.467963, "process_kernel_time": 1.936117, "process_mem_max_rss": "267980", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m18:15:17.467652 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:17.467539 after 14.96 seconds
[0m18:15:17.468124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb78f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf83b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>]}
[0m18:15:17.468456 [debug] [MainThread]: Flushing usage events
[0m18:15:20.773927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc7058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb000da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb2def60>]}


============================== 18:15:20.782743 | 00310bd8-f174-45e0-b523-86d9e8e47166 ==============================
[0m18:15:20.782743 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:15:20.783767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:15:21.663831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00310bd8-f174-45e0-b523-86d9e8e47166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd83e9df0>]}
[0m18:15:21.694787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00310bd8-f174-45e0-b523-86d9e8e47166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd87d0410>]}
[0m18:15:21.695367 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:15:21.707380 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:15:21.789796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:21.790226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:21.818973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00310bd8-f174-45e0-b523-86d9e8e47166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8216d80>]}
[0m18:15:21.895963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00310bd8-f174-45e0-b523-86d9e8e47166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d396a0>]}
[0m18:15:21.896445 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m18:15:21.897133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00310bd8-f174-45e0-b523-86d9e8e47166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8197950>]}
[0m18:15:21.899280 [info ] [MainThread]: 
[0m18:15:21.899993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:15:21.903868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m18:15:21.915377 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m18:15:21.915736 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m18:15:21.916038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:23.130157 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.213 seconds
[0m18:15:23.137483 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m18:15:23.329472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00310bd8-f174-45e0-b523-86d9e8e47166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e70e00>]}
[0m18:15:23.331079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:23.332548 [info ] [MainThread]: 
[0m18:15:23.347203 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:15:23.347920 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:15:23.348550 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:15:23.349266 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m18:15:23.349862 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:15:23.350333 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m18:15:23.350923 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m18:15:23.351578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m18:15:23.352159 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m18:15:23.353003 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m18:15:23.353633 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m18:15:23.354165 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:15:23.354889 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m18:15:23.355454 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:15:23.355951 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:15:23.370356 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:15:23.372094 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:15:23.375510 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:15:23.378723 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:15:23.382471 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:15:23.385365 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:15:23.385754 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:15:23.400075 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:15:23.401780 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:15:23.402199 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:15:23.402503 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:15:23.404609 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:15:23.406372 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:15:23.407108 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:15:23.407661 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:15:23.408126 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m18:15:23.408688 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:15:23.409000 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m18:15:23.409359 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:15:23.409871 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:15:23.410146 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m18:15:23.410446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:23.411828 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:15:23.412359 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:15:23.413826 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:15:23.920419 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m18:15:23.922884 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m18:15:23.954687 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m18:15:23.952104 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m18:15:24.031374 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m18:15:24.035497 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m18:15:24.082032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m18:15:24.085658 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m18:15:24.160945 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.81s]
[0m18:15:24.162306 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.81s]
[0m18:15:24.163455 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:15:24.164348 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:15:24.165019 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:15:24.165859 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:15:24.168097 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m18:15:24.168889 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m18:15:24.169577 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m18:15:24.170179 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m18:15:24.170721 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:15:24.171234 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:15:24.175853 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:15:24.179713 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:15:24.181625 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:15:24.182036 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:15:24.184146 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:15:24.187299 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:15:24.188884 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:15:24.189361 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m18:15:24.189985 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:15:24.190321 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:24.190730 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m18:15:24.192432 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:15:24.233892 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.88s]
[0m18:15:24.234714 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:15:24.235101 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:15:24.235436 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m18:15:24.235940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m18:15:24.236246 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:15:24.239676 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:15:24.240732 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:15:24.242435 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:15:24.243322 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:15:24.243677 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m18:15:24.244005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:24.273599 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.92s]
[0m18:15:24.274322 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:15:24.274724 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:15:24.275101 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m18:15:24.275592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m18:15:24.275934 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:15:24.279125 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:15:24.280349 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:15:24.282086 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:15:24.283226 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:15:24.283556 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:15:24.283853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:24.781598 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m18:15:24.784027 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m18:15:24.789826 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m18:15:24.793784 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m18:15:24.854199 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m18:15:24.859643 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m18:15:24.902605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m18:15:24.908057 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m18:15:25.010468 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.77s]
[0m18:15:25.012718 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.84s]
[0m18:15:25.014351 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:15:25.015652 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:15:25.016638 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:15:25.017577 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:15:25.018401 [info ] [Thread-2 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m18:15:25.019429 [info ] [Thread-4 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m18:15:25.020359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m18:15:25.021178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m18:15:25.021871 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:15:25.022500 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:15:25.029431 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:15:25.034059 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:15:25.037394 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:15:25.037978 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:15:25.040535 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:15:25.042926 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:15:25.043775 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.87s]
[0m18:15:25.044855 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:15:25.045401 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:15:25.045881 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m18:15:25.046718 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:15:25.047201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m18:15:25.047700 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m18:15:25.048351 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:15:25.048763 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:15:25.049182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:25.049593 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m18:15:25.053177 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:15:25.054202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:15:25.056982 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:15:25.060351 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:15:25.061362 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:15:25.061783 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m18:15:25.062585 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:25.098005 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 0.82s]
[0m18:15:25.098791 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:15:25.099308 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:15:25.099741 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m18:15:25.100389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m18:15:25.100822 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:15:25.104511 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:15:25.105432 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:15:25.107486 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:15:25.108394 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:15:25.108743 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m18:15:25.109063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:25.593692 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m18:15:25.601000 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m18:15:25.617989 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m18:15:25.622186 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m18:15:25.717187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m18:15:25.720391 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m18:15:25.794709 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m18:15:25.796249 [info ] [Thread-4 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.77s]
[0m18:15:25.799533 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m18:15:25.800683 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:15:25.803096 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:15:25.804740 [info ] [Thread-4 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m18:15:25.805933 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m18:15:25.806653 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:15:25.812672 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:15:25.814496 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:15:25.817371 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:15:25.818867 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:15:25.819339 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:15:25.819796 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:15:25.863641 [info ] [Thread-2 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.84s]
[0m18:15:25.864987 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:15:25.865623 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:15:25.866184 [info ] [Thread-2 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m18:15:25.866928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m18:15:25.867484 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:15:25.874491 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:15:25.875590 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:15:25.877994 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:15:25.879229 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:15:25.879676 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:25.880070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:25.931860 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.83s]
[0m18:15:25.933083 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:15:25.933605 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:15:25.934087 [info ] [Thread-1 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m18:15:25.934704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m18:15:25.935150 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:15:25.939073 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:15:25.940063 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:15:25.942227 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:15:25.943378 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:15:25.943809 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:25.944236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:26.302217 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m18:15:26.308693 [debug] [Thread-4 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m18:15:26.475577 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 1.43s]
[0m18:15:26.479629 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:15:26.480987 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:15:26.481983 [info ] [Thread-3 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m18:15:26.483689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m18:15:26.484785 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:15:26.495233 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:15:26.497073 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:15:26.500527 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:15:26.502411 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:15:26.502994 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:26.503640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:26.527973 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m18:15:26.529704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m18:15:26.533068 [debug] [Thread-2 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m18:15:26.535421 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m18:15:26.536366 [info ] [Thread-4 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.73s]
[0m18:15:26.540137 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:15:26.542777 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:15:26.549351 [info ] [Thread-4 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m18:15:26.553952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m18:15:26.554404 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:15:26.558463 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:15:26.559485 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:15:26.561672 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:15:26.562754 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:15:26.563162 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:26.563528 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:15:26.721734 [info ] [Thread-1 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.79s]
[0m18:15:26.722775 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:15:26.723233 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:15:26.723683 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m18:15:26.724318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m18:15:26.724703 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:15:26.728319 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:15:26.729265 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:15:26.731298 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:15:26.732296 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:15:26.732655 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:26.732990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:26.751368 [info ] [Thread-2 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.88s]
[0m18:15:26.752253 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:15:27.199310 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m18:15:27.205966 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m18:15:27.211405 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m18:15:27.216575 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m18:15:27.400454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m18:15:27.401464 [info ] [Thread-4 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.85s]
[0m18:15:27.403264 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m18:15:27.403898 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:15:27.406973 [info ] [Thread-3 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.92s]
[0m18:15:27.407650 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:15:27.707643 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.98s]
[0m18:15:27.709531 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:15:27.712392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:27.712782 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m18:15:27.713334 [debug] [MainThread]: Connection 'test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6' was properly closed.
[0m18:15:27.713938 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m18:15:27.714490 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m18:15:27.715421 [info ] [MainThread]: 
[0m18:15:27.716666 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m18:15:27.720833 [debug] [MainThread]: Command end result
[0m18:15:27.808317 [info ] [MainThread]: 
[0m18:15:27.809281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:27.809586 [info ] [MainThread]: 
[0m18:15:27.809985 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:15:27.811277 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.07945, "process_user_time": 4.316264, "process_kernel_time": 1.747496, "process_mem_max_rss": "268624", "process_out_blocks": "2222", "process_in_blocks": "0"}
[0m18:15:27.811731 [debug] [MainThread]: Command `dbt test` succeeded at 18:15:27.811639 after 7.08 seconds
[0m18:15:27.812107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1e7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e70e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe9ca150>]}
[0m18:15:27.812423 [debug] [MainThread]: Flushing usage events
[0m18:30:02.219583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe0a13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb249a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb24b320>]}


============================== 18:30:02.228873 | e30fe432-4c25-4cf6-a748-bf20cc7a2d8a ==============================
[0m18:30:02.228873 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:30:02.230061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:03.081569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb93cb90>]}
[0m18:30:03.115690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf25df0>]}
[0m18:30:03.116555 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:30:03.131252 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:30:03.215217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:03.215628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:03.243657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8224b90>]}
[0m18:30:03.316359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e21580>]}
[0m18:30:03.316830 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m18:30:03.317559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffdb98d790>]}
[0m18:30:03.319259 [info ] [MainThread]: 
[0m18:30:03.319967 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:03.323368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS'
[0m18:30:03.333838 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS"
[0m18:30:03.334188 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS"} */
show terse schemas in database USER_DB_PLATYPUS
    limit 10000
[0m18:30:03.334463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:04.462264 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.127 seconds
[0m18:30:04.466474 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS: Close
[0m18:30:04.664077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m18:30:04.681912 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m18:30:04.682706 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m18:30:04.683278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:05.356642 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.673 seconds
[0m18:30:05.359821 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m18:30:05.550556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3f44770>]}
[0m18:30:05.552395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:05.554745 [info ] [MainThread]: 
[0m18:30:05.570279 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.stg_earthquakes
[0m18:30:05.571320 [info ] [Thread-1 (]: 1 of 5 START sql view model ANALYTICS.stg_earthquakes .......................... [RUN]
[0m18:30:05.572379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now model.earthquake_analytics.stg_earthquakes)
[0m18:30:05.572950 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.stg_earthquakes
[0m18:30:05.582343 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.stg_earthquakes"
[0m18:30:05.584367 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.stg_earthquakes
[0m18:30:05.608361 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.stg_earthquakes"
[0m18:30:05.611255 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.stg_earthquakes"
[0m18:30:05.611676 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.stg_earthquakes"} */
create or replace   view USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
  
   as (
    

/*
    Staging model for earthquake data
    Transforms raw earthquake data with proper data types and cleaning
*/

WITH source AS (
    SELECT * FROM USER_DB_PLATYPUS.RAW.raw_earthquakes
),

cleaned AS (
    SELECT
        -- Primary key
        event_id,
        
        -- Magnitude info
        magnitude,
        mag_type,
        CASE 
            WHEN magnitude < 2.0 THEN 'micro'
            WHEN magnitude >= 2.0 AND magnitude < 4.0 THEN 'minor'
            WHEN magnitude >= 4.0 AND magnitude < 5.0 THEN 'light'
            WHEN magnitude >= 5.0 AND magnitude < 6.0 THEN 'moderate'
            WHEN magnitude >= 6.0 AND magnitude < 7.0 THEN 'strong'
            WHEN magnitude >= 7.0 AND magnitude < 8.0 THEN 'major'
            WHEN magnitude >= 8.0 THEN 'great'
            ELSE 'unknown'
        END AS magnitude_category,
        
        -- Location info
        place,
        longitude,
        latitude,
        depth_km,
        CASE 
            WHEN depth_km < 70 THEN 'shallow'
            WHEN depth_km >= 70 AND depth_km < 300 THEN 'intermediate'
            WHEN depth_km >= 300 THEN 'deep'
            ELSE 'unknown'
        END AS depth_category,
        
        -- Extract region from place (text after "of" or full place)
        CASE 
            WHEN POSITION(' of ' IN place) > 0 
            THEN TRIM(SUBSTRING(place, POSITION(' of ' IN place) + 4))
            ELSE place
        END AS region,
        
        -- Time info - convert Unix ms to timestamp
        TO_TIMESTAMP_NTZ(event_time / 1000) AS event_timestamp,
        DATE(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_date,
        HOUR(TO_TIMESTAMP_NTZ(event_time / 1000)) AS event_hour,
        DAYOFWEEK(TO_TIMESTAMP_NTZ(event_time / 1000)) AS day_of_week,
        TO_TIMESTAMP_NTZ(updated_time / 1000) AS updated_timestamp,
        
        -- Quality metrics
        status,
        significance,
        num_stations AS station_count,
        rms AS travel_time_residual,
        gap AS azimuthal_gap,
        distance AS nearest_station_distance,
        
        -- Impact metrics
        felt_reports,
        cdi AS community_intensity,
        mmi AS mercalli_intensity,
        alert_level,
        tsunami_flag,
        CASE WHEN tsunami_flag = 1 THEN TRUE ELSE FALSE END AS has_tsunami_warning,
        
        -- Metadata
        network AS source_network,
        event_type,
        event_code,
        title,
        detail_url,
        
        -- Audit fields
        ingested_at,
        created_at,
        updated_at,
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM source
    WHERE event_id IS NOT NULL
      AND magnitude IS NOT NULL
      AND latitude IS NOT NULL
      AND longitude IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m18:30:05.612086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:06.415902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m18:30:06.431755 [debug] [Thread-1 (]: On model.earthquake_analytics.stg_earthquakes: Close
[0m18:30:06.661477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd8328e30>]}
[0m18:30:06.663232 [info ] [Thread-1 (]: 1 of 5 OK created sql view model ANALYTICS.stg_earthquakes ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m18:30:06.665719 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.stg_earthquakes
[0m18:30:06.667605 [debug] [Thread-3 (]: Began running node model.earthquake_analytics.fct_earthquakes
[0m18:30:06.668850 [info ] [Thread-3 (]: 2 of 5 START sql incremental model ANALYTICS.fct_earthquakes ................... [RUN]
[0m18:30:06.670021 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.earthquake_analytics.fct_earthquakes'
[0m18:30:06.670636 [debug] [Thread-3 (]: Began compiling node model.earthquake_analytics.fct_earthquakes
[0m18:30:06.682592 [debug] [Thread-3 (]: Writing injected SQL for node "model.earthquake_analytics.fct_earthquakes"
[0m18:30:06.683914 [debug] [Thread-3 (]: Began executing node model.earthquake_analytics.fct_earthquakes
[0m18:30:06.713286 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:06.713793 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
  
   as (
    

/*
    Fact table for earthquake events
    Incremental load - only processes new or updated events
*/

WITH staged AS (
    SELECT * FROM USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
    
    WHERE updated_timestamp > (SELECT MAX(updated_timestamp) FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
       OR event_id NOT IN (SELECT event_id FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes)
    
)

SELECT
    -- Keys
    event_id,
    event_date,
    
    -- Dimensions
    region,
    magnitude_category,
    depth_category,
    source_network,
    event_type,
    status,
    
    -- Facts/Measures
    magnitude,
    depth_km,
    latitude,
    longitude,
    
    -- Quality scores
    significance,
    station_count,
    travel_time_residual,
    azimuthal_gap,
    nearest_station_distance,
    
    -- Impact
    felt_reports,
    community_intensity,
    mercalli_intensity,
    alert_level,
    has_tsunami_warning,
    
    -- Time dimensions
    event_timestamp,
    event_hour,
    day_of_week,
    updated_timestamp,
    
    -- Metadata
    place,
    title,
    detail_url,
    
    -- Audit
    ingested_at,
    dbt_updated_at
    
FROM staged
  );
[0m18:30:06.714244 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:30:07.744415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m18:30:07.757719 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:07.758452 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:30:07.933880 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.175 seconds
[0m18:30:07.939501 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:07.939978 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
[0m18:30:08.107058 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.166 seconds
[0m18:30:08.135187 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:08.136413 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:30:08.335802 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.198 seconds
[0m18:30:08.347120 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:08.348158 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES"
[0m18:30:08.496163 [debug] [Thread-3 (]: SQL status: SUCCESS 31 in 0.147 seconds
[0m18:30:08.521860 [debug] [Thread-3 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."FCT_EARTHQUAKES":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:30:08.550668 [debug] [Thread-3 (]: Writing runtime sql for node "model.earthquake_analytics.fct_earthquakes"
[0m18:30:08.552692 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:08.553076 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
-- back compat for old kwarg name
  
  begin;
[0m18:30:08.746086 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m18:30:08.748217 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:08.750141 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
merge into USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        magnitude = DBT_INTERNAL_SOURCE.magnitude,updated_timestamp = DBT_INTERNAL_SOURCE.updated_timestamp,status = DBT_INTERNAL_SOURCE.status,felt_reports = DBT_INTERNAL_SOURCE.felt_reports,community_intensity = DBT_INTERNAL_SOURCE.community_intensity,alert_level = DBT_INTERNAL_SOURCE.alert_level,dbt_updated_at = DBT_INTERNAL_SOURCE.dbt_updated_at
    

    when not matched then insert
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")
    values
        ("EVENT_ID", "EVENT_DATE", "REGION", "MAGNITUDE_CATEGORY", "DEPTH_CATEGORY", "SOURCE_NETWORK", "EVENT_TYPE", "STATUS", "MAGNITUDE", "DEPTH_KM", "LATITUDE", "LONGITUDE", "SIGNIFICANCE", "STATION_COUNT", "TRAVEL_TIME_RESIDUAL", "AZIMUTHAL_GAP", "NEAREST_STATION_DISTANCE", "FELT_REPORTS", "COMMUNITY_INTENSITY", "MERCALLI_INTENSITY", "ALERT_LEVEL", "HAS_TSUNAMI_WARNING", "EVENT_TIMESTAMP", "EVENT_HOUR", "DAY_OF_WEEK", "UPDATED_TIMESTAMP", "PLACE", "TITLE", "DETAIL_URL", "INGESTED_AT", "DBT_UPDATED_AT")

;
[0m18:30:11.656508 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.905 seconds
[0m18:30:11.658422 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:11.659520 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
COMMIT
[0m18:30:12.805471 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.145 seconds
[0m18:30:12.827021 [debug] [Thread-3 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp
[0m18:30:12.837146 [debug] [Thread-3 (]: Using snowflake connection "model.earthquake_analytics.fct_earthquakes"
[0m18:30:12.837869 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.fct_earthquakes"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes__dbt_tmp cascade
[0m18:30:13.062554 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m18:30:13.068470 [debug] [Thread-3 (]: On model.earthquake_analytics.fct_earthquakes: Close
[0m18:30:13.297305 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd35f8230>]}
[0m18:30:13.298913 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model ANALYTICS.fct_earthquakes .............. [[32mSUCCESS 0[0m in 6.63s]
[0m18:30:13.301540 [debug] [Thread-3 (]: Finished running node model.earthquake_analytics.fct_earthquakes
[0m18:30:13.303801 [debug] [Thread-2 (]: Began running node model.earthquake_analytics.agg_daily_summary
[0m18:30:13.304632 [debug] [Thread-1 (]: Began running node model.earthquake_analytics.agg_hourly_heatmap
[0m18:30:13.305484 [debug] [Thread-4 (]: Began running node model.earthquake_analytics.agg_regional_risk
[0m18:30:13.306330 [info ] [Thread-2 (]: 3 of 5 START sql incremental model ANALYTICS.agg_daily_summary ................. [RUN]
[0m18:30:13.307453 [info ] [Thread-1 (]: 4 of 5 START sql table model ANALYTICS.agg_hourly_heatmap ...................... [RUN]
[0m18:30:13.308468 [info ] [Thread-4 (]: 5 of 5 START sql table model ANALYTICS.agg_regional_risk ....................... [RUN]
[0m18:30:13.309431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS, now model.earthquake_analytics.agg_daily_summary)
[0m18:30:13.310285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.earthquake_analytics.stg_earthquakes, now model.earthquake_analytics.agg_hourly_heatmap)
[0m18:30:13.311179 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.earthquake_analytics.agg_regional_risk'
[0m18:30:13.311810 [debug] [Thread-2 (]: Began compiling node model.earthquake_analytics.agg_daily_summary
[0m18:30:13.312387 [debug] [Thread-1 (]: Began compiling node model.earthquake_analytics.agg_hourly_heatmap
[0m18:30:13.312963 [debug] [Thread-4 (]: Began compiling node model.earthquake_analytics.agg_regional_risk
[0m18:30:13.318456 [debug] [Thread-2 (]: Writing injected SQL for node "model.earthquake_analytics.agg_daily_summary"
[0m18:30:13.321877 [debug] [Thread-1 (]: Writing injected SQL for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:30:13.326420 [debug] [Thread-4 (]: Writing injected SQL for node "model.earthquake_analytics.agg_regional_risk"
[0m18:30:13.328342 [debug] [Thread-2 (]: Began executing node model.earthquake_analytics.agg_daily_summary
[0m18:30:13.328818 [debug] [Thread-1 (]: Began executing node model.earthquake_analytics.agg_hourly_heatmap
[0m18:30:13.333300 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:13.333686 [debug] [Thread-4 (]: Began executing node model.earthquake_analytics.agg_regional_risk
[0m18:30:13.350777 [debug] [Thread-1 (]: Writing runtime sql for node "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:30:13.351228 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
create or replace  temporary view USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
  
   as (
    

/*
    Daily summary aggregation for dashboard KPIs
    Pre-computes daily metrics for fast dashboard loading
*/

WITH daily_stats AS (
    SELECT
        event_date AS summary_date,
        
        -- Counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_earthquakes,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_earthquakes,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        MIN(magnitude) AS min_magnitude,
        STDDEV(magnitude) AS stddev_magnitude,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY magnitude) AS median_magnitude,
        
        -- Depth stats
        AVG(depth_km) AS avg_depth_km,
        MAX(depth_km) AS max_depth_km,
        
        -- Impact stats
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        AVG(COALESCE(significance, 0)) AS avg_significance,
        
        -- Category breakdowns
        COUNT(CASE WHEN magnitude_category = 'micro' THEN 1 END) AS micro_count,
        COUNT(CASE WHEN magnitude_category = 'minor' THEN 1 END) AS minor_count,
        COUNT(CASE WHEN magnitude_category = 'light' THEN 1 END) AS light_count,
        COUNT(CASE WHEN magnitude_category = 'moderate' THEN 1 END) AS moderate_count,
        COUNT(CASE WHEN magnitude_category = 'strong' THEN 1 END) AS strong_count,
        COUNT(CASE WHEN magnitude_category = 'major' THEN 1 END) AS major_count,
        COUNT(CASE WHEN magnitude_category = 'great' THEN 1 END) AS great_count,
        
        -- Depth category breakdown
        COUNT(CASE WHEN depth_category = 'shallow' THEN 1 END) AS shallow_count,
        COUNT(CASE WHEN depth_category = 'intermediate' THEN 1 END) AS intermediate_count,
        COUNT(CASE WHEN depth_category = 'deep' THEN 1 END) AS deep_count,
        
        -- Quality
        AVG(station_count) AS avg_station_count,
        COUNT(CASE WHEN status = 'reviewed' THEN 1 END) AS reviewed_count,
        
        -- Audit
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    
    WHERE event_date >= (SELECT MAX(summary_date) - INTERVAL '1 day' FROM USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary)
    
    GROUP BY event_date
)

SELECT * FROM daily_stats
  );
[0m18:30:13.353292 [debug] [Thread-4 (]: Writing runtime sql for node "model.earthquake_analytics.agg_regional_risk"
[0m18:30:13.354188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:13.355465 [debug] [Thread-1 (]: Using snowflake connection "model.earthquake_analytics.agg_hourly_heatmap"
[0m18:30:13.357177 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_hourly_heatmap"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_hourly_heatmap
         as
        (

/*
    Hourly Heatmap Aggregation
    Pre-computes earthquake patterns by hour and day of week
    Useful for temporal pattern visualization
*/

WITH hourly_patterns AS (
    SELECT
        day_of_week,
        event_hour,
        
        -- Day names for display
        CASE day_of_week
            WHEN 0 THEN 'Sunday'
            WHEN 1 THEN 'Monday'
            WHEN 2 THEN 'Tuesday'
            WHEN 3 THEN 'Wednesday'
            WHEN 4 THEN 'Thursday'
            WHEN 5 THEN 'Friday'
            WHEN 6 THEN 'Saturday'
        END AS day_name,
        
        -- Counts
        COUNT(*) AS earthquake_count,
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        
        -- Significant events
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_count,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    GROUP BY day_of_week, event_hour
)

SELECT * FROM hourly_patterns
ORDER BY day_of_week, event_hour
        );
[0m18:30:13.357754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:13.360289 [debug] [Thread-4 (]: Using snowflake connection "model.earthquake_analytics.agg_regional_risk"
[0m18:30:13.361547 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_regional_risk"} */
create or replace transient table USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
         as
        (

/*
    Regional Risk Analysis
    Aggregates earthquake data by region to calculate risk scores
*/

WITH regional_stats AS (
    SELECT
        region,
        
        -- Basic counts
        COUNT(*) AS total_earthquakes,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 30 THEN 1 END) AS earthquakes_last_30_days,
        COUNT(CASE WHEN event_date >= CURRENT_DATE - 7 THEN 1 END) AS earthquakes_last_7_days,
        
        -- Magnitude stats
        AVG(magnitude) AS avg_magnitude,
        MAX(magnitude) AS max_magnitude,
        PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY magnitude) AS p95_magnitude,
        
        -- Significant event counts
        COUNT(CASE WHEN magnitude >= 4.0 THEN 1 END) AS significant_events,
        COUNT(CASE WHEN magnitude >= 5.0 THEN 1 END) AS strong_events,
        COUNT(CASE WHEN magnitude >= 6.0 THEN 1 END) AS major_events,
        
        -- Depth
        AVG(depth_km) AS avg_depth_km,
        
        -- Impact
        SUM(COALESCE(felt_reports, 0)) AS total_felt_reports,
        COUNT(CASE WHEN has_tsunami_warning THEN 1 END) AS tsunami_warnings,
        
        -- Time range
        MIN(event_date) AS first_event_date,
        MAX(event_date) AS last_event_date,
        DATEDIFF('day', MIN(event_date), MAX(event_date)) + 1 AS days_with_data,
        
        -- Representative coordinates (centroid)
        AVG(latitude) AS centroid_latitude,
        AVG(longitude) AS centroid_longitude
        
    FROM USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
    WHERE region IS NOT NULL
    GROUP BY region
),

risk_scored AS (
    SELECT
        *,
        
        -- Calculate daily frequency
        total_earthquakes::FLOAT / NULLIF(days_with_data, 0) AS daily_frequency,
        
        -- Risk score calculation (weighted factors)
        (
            -- Frequency component (normalized by 365 days)
            (total_earthquakes::FLOAT / NULLIF(days_with_data, 0)) * 10 +
            -- Magnitude component
            avg_magnitude * 5 +
            -- Max magnitude impact
            CASE WHEN max_magnitude >= 6.0 THEN 20
                 WHEN max_magnitude >= 5.0 THEN 10
                 WHEN max_magnitude >= 4.0 THEN 5
                 ELSE 1 END +
            -- Recent activity boost
            earthquakes_last_30_days * 0.5 +
            -- Tsunami risk
            tsunami_warnings * 15
        ) AS raw_risk_score
        
    FROM regional_stats
),

risk_categorized AS (
    SELECT
        *,
        -- Normalize risk score to 0-100 scale
        LEAST(100, raw_risk_score) AS risk_score,
        
        -- Risk category
        CASE 
            WHEN raw_risk_score >= 50 THEN 'high'
            WHEN raw_risk_score >= 25 THEN 'moderate'
            WHEN raw_risk_score >= 10 THEN 'low'
            ELSE 'minimal'
        END AS risk_category,
        
        CURRENT_TIMESTAMP() AS dbt_updated_at
        
    FROM risk_scored
)

SELECT * FROM risk_categorized
ORDER BY risk_score DESC
        );
[0m18:30:13.362374 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:30:14.215130 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m18:30:14.224870 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:14.226718 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:30:14.366610 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.138 seconds
[0m18:30:14.374264 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:14.375024 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
[0m18:30:14.505485 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.129 seconds
[0m18:30:14.516894 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:14.517983 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:30:14.645235 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.126 seconds
[0m18:30:14.652406 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:14.653087 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
describe table "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY"
[0m18:30:14.705995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.348 seconds
[0m18:30:14.710114 [debug] [Thread-1 (]: On model.earthquake_analytics.agg_hourly_heatmap: Close
[0m18:30:14.914387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3474470>]}
[0m18:30:14.916024 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ANALYTICS.agg_hourly_heatmap ................. [[32mSUCCESS 1[0m in 1.60s]
[0m18:30:14.917695 [debug] [Thread-1 (]: Finished running node model.earthquake_analytics.agg_hourly_heatmap
[0m18:30:15.106418 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.744 seconds
[0m18:30:15.113090 [debug] [Thread-4 (]: On model.earthquake_analytics.agg_regional_risk: Close
[0m18:30:15.310862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd34a8680>]}
[0m18:30:15.313324 [info ] [Thread-4 (]: 5 of 5 OK created sql table model ANALYTICS.agg_regional_risk .................. [[32mSUCCESS 1[0m in 2.00s]
[0m18:30:15.316178 [debug] [Thread-4 (]: Finished running node model.earthquake_analytics.agg_regional_risk
[0m18:30:15.355995 [debug] [Thread-2 (]: SQL status: SUCCESS 27 in 0.702 seconds
[0m18:30:15.368871 [debug] [Thread-2 (]: 
    In "USER_DB_PLATYPUS"."ANALYTICS"."AGG_DAILY_SUMMARY":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:30:15.372976 [debug] [Thread-2 (]: Writing runtime sql for node "model.earthquake_analytics.agg_daily_summary"
[0m18:30:15.377558 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:15.378208 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
-- back compat for old kwarg name
  
  begin;
[0m18:30:15.604302 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m18:30:15.604795 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:15.605223 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
[0m18:30:17.311747 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.706 seconds
[0m18:30:17.313641 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:17.314830 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
COMMIT
[0m18:30:17.743209 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m18:30:17.754626 [debug] [Thread-2 (]: Applying DROP to: USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp
[0m18:30:17.760133 [debug] [Thread-2 (]: Using snowflake connection "model.earthquake_analytics.agg_daily_summary"
[0m18:30:17.761217 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "model.earthquake_analytics.agg_daily_summary"} */
drop view if exists USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp cascade
[0m18:30:17.924679 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m18:30:17.931431 [debug] [Thread-2 (]: On model.earthquake_analytics.agg_daily_summary: Close
[0m18:30:18.151798 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30fe432-4c25-4cf6-a748-bf20cc7a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd2bb9a60>]}
[0m18:30:18.154193 [info ] [Thread-2 (]: 3 of 5 OK created sql incremental model ANALYTICS.agg_daily_summary ............ [[32mSUCCESS 2[0m in 4.84s]
[0m18:30:18.157414 [debug] [Thread-2 (]: Finished running node model.earthquake_analytics.agg_daily_summary
[0m18:30:18.161261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:18.162166 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_daily_summary' was properly closed.
[0m18:30:18.162802 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_hourly_heatmap' was properly closed.
[0m18:30:18.163337 [debug] [MainThread]: Connection 'model.earthquake_analytics.fct_earthquakes' was properly closed.
[0m18:30:18.164333 [debug] [MainThread]: Connection 'model.earthquake_analytics.agg_regional_risk' was properly closed.
[0m18:30:18.165882 [info ] [MainThread]: 
[0m18:30:18.167529 [info ] [MainThread]: Finished running 1 view model, 2 incremental models, 2 table models in 0 hours 0 minutes and 14.85 seconds (14.85s).
[0m18:30:18.170423 [debug] [MainThread]: Command end result
[0m18:30:18.206738 [info ] [MainThread]: 
[0m18:30:18.207484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:18.208061 [info ] [MainThread]: 
[0m18:30:18.208702 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:30:18.210300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.036222, "process_user_time": 4.222097, "process_kernel_time": 1.907956, "process_mem_max_rss": "267552", "process_out_blocks": "2239", "process_in_blocks": "0"}
[0m18:30:18.210913 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:18.210813 after 16.04 seconds
[0m18:30:18.211342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb1a8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb2701d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb270ce0>]}
[0m18:30:18.211740 [debug] [MainThread]: Flushing usage events
[0m18:30:21.550557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7dff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc416b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb2f6930>]}


============================== 18:30:21.559189 | 873e0fc8-ed62-482f-bc96-1a1caf7164ef ==============================
[0m18:30:21.559189 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:30:21.560245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/earthquake_analytics/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:22.303950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873e0fc8-ed62-482f-bc96-1a1caf7164ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd835bd70>]}
[0m18:30:22.335708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873e0fc8-ed62-482f-bc96-1a1caf7164ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd82f1e80>]}
[0m18:30:22.336383 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:30:22.348028 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:30:22.427972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:22.428408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:22.456477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '873e0fc8-ed62-482f-bc96-1a1caf7164ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e1fec0>]}
[0m18:30:22.535617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '873e0fc8-ed62-482f-bc96-1a1caf7164ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3d388f0>]}
[0m18:30:22.536177 [info ] [MainThread]: Found 5 models, 18 data tests, 1 source, 454 macros
[0m18:30:22.536825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873e0fc8-ed62-482f-bc96-1a1caf7164ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd82128d0>]}
[0m18:30:22.539065 [info ] [MainThread]: 
[0m18:30:22.539753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:22.543895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PLATYPUS_ANALYTICS'
[0m18:30:22.556913 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PLATYPUS_ANALYTICS"
[0m18:30:22.557355 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "connection_name": "list_USER_DB_PLATYPUS_ANALYTICS"} */
show objects in USER_DB_PLATYPUS.ANALYTICS limit 10000
[0m18:30:22.557724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:23.651483 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.093 seconds
[0m18:30:23.655688 [debug] [ThreadPool]: On list_USER_DB_PLATYPUS_ANALYTICS: Close
[0m18:30:23.854837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873e0fc8-ed62-482f-bc96-1a1caf7164ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd3e59430>]}
[0m18:30:23.856766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:23.858813 [info ] [MainThread]: 
[0m18:30:23.873880 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:30:23.874624 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:30:23.875200 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:30:23.875875 [info ] [Thread-1 (]: 1 of 18 START test not_null_agg_daily_summary_summary_date ..................... [RUN]
[0m18:30:23.876552 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:30:23.877085 [info ] [Thread-2 (]: 2 of 18 START test not_null_agg_regional_risk_region ........................... [RUN]
[0m18:30:23.877740 [info ] [Thread-3 (]: 3 of 18 START test not_null_fct_earthquakes_event_date ......................... [RUN]
[0m18:30:23.878541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PLATYPUS_ANALYTICS, now test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b)
[0m18:30:23.879114 [info ] [Thread-4 (]: 4 of 18 START test not_null_fct_earthquakes_event_id ........................... [RUN]
[0m18:30:23.879957 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f'
[0m18:30:23.880611 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c'
[0m18:30:23.881125 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:30:23.881776 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec'
[0m18:30:23.882271 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:30:23.882743 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:30:23.899004 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:30:23.899400 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:30:23.902712 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:30:23.906140 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:30:23.910008 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:30:23.910746 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:30:23.923329 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:30:23.926204 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:30:23.927931 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:30:23.928328 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:30:23.928709 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:30:23.930662 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:30:23.932342 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:30:23.933111 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"
[0m18:30:23.933715 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"
[0m18:30:23.934070 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_date
from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is null



      
    ) dbt_internal_test
[0m18:30:23.934471 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is null



      
    ) dbt_internal_test
[0m18:30:23.935010 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"
[0m18:30:23.935373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:23.935886 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"
[0m18:30:23.936223 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:30:23.936548 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_date
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_date is null



      
    ) dbt_internal_test
[0m18:30:23.937959 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:30:23.939532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:30:23.940005 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:30:24.535276 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m18:30:24.561716 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c: Close
[0m18:30:24.563123 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m18:30:24.567872 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec: Close
[0m18:30:24.606964 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m18:30:24.609820 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f: Close
[0m18:30:24.635792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m18:30:24.637941 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b: Close
[0m18:30:24.726817 [info ] [Thread-3 (]: 3 of 18 PASS not_null_fct_earthquakes_event_date ............................... [[32mPASS[0m in 0.85s]
[0m18:30:24.728918 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c
[0m18:30:24.731636 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:30:24.732485 [info ] [Thread-3 (]: 5 of 18 START test not_null_fct_earthquakes_latitude ........................... [RUN]
[0m18:30:24.733432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_date.0478a55a1c, now test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83)
[0m18:30:24.734106 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:30:24.739803 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:30:24.741157 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:30:24.743862 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:30:24.745296 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"
[0m18:30:24.745887 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m18:30:24.746457 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:24.759934 [info ] [Thread-4 (]: 4 of 18 PASS not_null_fct_earthquakes_event_id ................................. [[32mPASS[0m in 0.88s]
[0m18:30:24.761061 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec
[0m18:30:24.761573 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:30:24.762065 [info ] [Thread-4 (]: 6 of 18 START test not_null_fct_earthquakes_longitude .......................... [RUN]
[0m18:30:24.762768 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_event_id.250e7890ec, now test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff)
[0m18:30:24.763186 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:30:24.767016 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:30:24.767992 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:30:24.771106 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:30:24.772269 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"
[0m18:30:24.772659 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m18:30:24.773014 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:24.790270 [info ] [Thread-2 (]: 2 of 18 PASS not_null_agg_regional_risk_region ................................. [[32mPASS[0m in 0.91s]
[0m18:30:24.790960 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f
[0m18:30:24.791411 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:30:24.791816 [info ] [Thread-2 (]: 7 of 18 START test not_null_fct_earthquakes_magnitude .......................... [RUN]
[0m18:30:24.792312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_regional_risk_region.3c1e26da2f, now test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0)
[0m18:30:24.792684 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:30:24.796383 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:30:24.797367 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:30:24.799390 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:30:24.800486 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"
[0m18:30:24.800866 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m18:30:24.801188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:24.813825 [info ] [Thread-1 (]: 1 of 18 PASS not_null_agg_daily_summary_summary_date ........................... [[32mPASS[0m in 0.94s]
[0m18:30:24.814664 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b
[0m18:30:24.815126 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:30:24.815492 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_earthquakes_event_id ........................... [RUN]
[0m18:30:24.815938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_agg_daily_summary_summary_date.132daff73b, now test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419)
[0m18:30:24.816272 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:30:24.819367 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:30:24.820231 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:30:24.821914 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:30:24.822928 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"
[0m18:30:24.823245 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:30:24.823542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:25.239502 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m18:30:25.243390 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83: Close
[0m18:30:25.261788 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m18:30:25.264918 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff: Close
[0m18:30:25.296419 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m18:30:25.299779 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0: Close
[0m18:30:25.408510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m18:30:25.415095 [debug] [Thread-1 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419: Close
[0m18:30:25.417404 [info ] [Thread-3 (]: 5 of 18 PASS not_null_fct_earthquakes_latitude ................................. [[32mPASS[0m in 0.68s]
[0m18:30:25.423131 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83
[0m18:30:25.424943 [info ] [Thread-4 (]: 6 of 18 PASS not_null_fct_earthquakes_longitude ................................ [[32mPASS[0m in 0.66s]
[0m18:30:25.425877 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:30:25.427184 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff
[0m18:30:25.427983 [info ] [Thread-3 (]: 9 of 18 START test not_null_stg_earthquakes_event_timestamp .................... [RUN]
[0m18:30:25.429083 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:30:25.429933 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_latitude.21623b0a83, now test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8)
[0m18:30:25.430763 [info ] [Thread-4 (]: 10 of 18 START test not_null_stg_earthquakes_latitude .......................... [RUN]
[0m18:30:25.431627 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:30:25.432405 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_longitude.39a1d503ff, now test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c)
[0m18:30:25.439095 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:30:25.439637 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:30:25.444386 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:30:25.445388 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:30:25.448113 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:30:25.448806 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:30:25.451239 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:30:25.452184 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"
[0m18:30:25.452699 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_timestamp
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_timestamp is null



      
    ) dbt_internal_test
[0m18:30:25.453165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:25.454517 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"
[0m18:30:25.455374 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where latitude is null



      
    ) dbt_internal_test
[0m18:30:25.455944 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:25.466766 [info ] [Thread-2 (]: 7 of 18 PASS not_null_fct_earthquakes_magnitude ................................ [[32mPASS[0m in 0.67s]
[0m18:30:25.467884 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0
[0m18:30:25.468370 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:30:25.468820 [info ] [Thread-2 (]: 11 of 18 START test not_null_stg_earthquakes_longitude ......................... [RUN]
[0m18:30:25.469381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_fct_earthquakes_magnitude.c9e74345c0, now test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918)
[0m18:30:25.469801 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:30:25.473417 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:30:25.474348 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:30:25.476316 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:30:25.477205 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"
[0m18:30:25.477546 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where longitude is null



      
    ) dbt_internal_test
[0m18:30:25.477874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:25.930016 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m18:30:25.937016 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8: Close
[0m18:30:25.955415 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m18:30:25.959820 [debug] [Thread-4 (]: On test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c: Close
[0m18:30:26.139814 [info ] [Thread-3 (]: 9 of 18 PASS not_null_stg_earthquakes_event_timestamp .......................... [[32mPASS[0m in 0.71s]
[0m18:30:26.142735 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8
[0m18:30:26.143978 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:30:26.145873 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m18:30:26.147029 [info ] [Thread-3 (]: 12 of 18 START test not_null_stg_earthquakes_magnitude ......................... [RUN]
[0m18:30:26.151608 [debug] [Thread-2 (]: On test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918: Close
[0m18:30:26.152646 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_timestamp.c1564366e8, now test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9)
[0m18:30:26.155271 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:30:26.162861 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:30:26.164714 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:30:26.167729 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:30:26.169241 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"
[0m18:30:26.169797 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select magnitude
from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where magnitude is null



      
    ) dbt_internal_test
[0m18:30:26.170312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:26.208229 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_earthquakes_event_id ................................. [[32mPASS[0m in 1.39s]
[0m18:30:26.209946 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419
[0m18:30:26.210640 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:30:26.211192 [info ] [Thread-1 (]: 13 of 18 START test source_not_null_raw_raw_earthquakes_event_id ............... [RUN]
[0m18:30:26.212001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_event_id.f40b4b1419, now test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f)
[0m18:30:26.212487 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:30:26.217504 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:30:26.218837 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:30:26.221151 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:30:26.222277 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"
[0m18:30:26.222679 [debug] [Thread-1 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is null



      
    ) dbt_internal_test
[0m18:30:26.223029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:26.250393 [info ] [Thread-4 (]: 10 of 18 PASS not_null_stg_earthquakes_latitude ................................ [[32mPASS[0m in 0.82s]
[0m18:30:26.252163 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c
[0m18:30:26.252761 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:30:26.253243 [info ] [Thread-4 (]: 14 of 18 START test source_unique_raw_raw_earthquakes_event_id ................. [RUN]
[0m18:30:26.254009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_latitude.d038d4494c, now test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6)
[0m18:30:26.254474 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:30:26.260147 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:30:26.261224 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:30:26.263282 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:30:26.264461 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"
[0m18:30:26.264865 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.RAW.raw_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:30:26.265250 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:26.325434 [info ] [Thread-2 (]: 11 of 18 PASS not_null_stg_earthquakes_longitude ............................... [[32mPASS[0m in 0.86s]
[0m18:30:26.326533 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918
[0m18:30:26.327026 [debug] [Thread-2 (]: Began running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:30:26.327421 [info ] [Thread-2 (]: 15 of 18 START test unique_agg_daily_summary_summary_date ...................... [RUN]
[0m18:30:26.327950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_longitude.430dc9d918, now test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d)
[0m18:30:26.328313 [debug] [Thread-2 (]: Began compiling node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:30:26.331644 [debug] [Thread-2 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:30:26.332591 [debug] [Thread-2 (]: Began executing node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:30:26.334649 [debug] [Thread-2 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:30:26.335880 [debug] [Thread-2 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"
[0m18:30:26.336253 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_date as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary
where summary_date is not null
group by summary_date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:30:26.336643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:26.795415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m18:30:26.797659 [debug] [Thread-3 (]: On test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9: Close
[0m18:30:26.800474 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m18:30:26.802223 [debug] [Thread-4 (]: On test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6: Close
[0m18:30:26.820050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m18:30:26.821626 [debug] [Thread-1 (]: On test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f: Close
[0m18:30:26.903185 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m18:30:26.905306 [debug] [Thread-2 (]: On test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d: Close
[0m18:30:26.988907 [info ] [Thread-3 (]: 12 of 18 PASS not_null_stg_earthquakes_magnitude ............................... [[32mPASS[0m in 0.84s]
[0m18:30:26.990043 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9
[0m18:30:26.990549 [debug] [Thread-3 (]: Began running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:30:26.991008 [info ] [Thread-3 (]: 16 of 18 START test unique_agg_regional_risk_region ............................ [RUN]
[0m18:30:26.991577 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.not_null_stg_earthquakes_magnitude.5438d6bfc9, now test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0)
[0m18:30:26.992002 [debug] [Thread-3 (]: Began compiling node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:30:26.995956 [debug] [Thread-3 (]: Writing injected SQL for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:30:26.996940 [debug] [Thread-3 (]: Began executing node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:30:27.000069 [debug] [Thread-3 (]: Writing runtime sql for node "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:30:27.001227 [debug] [Thread-3 (]: Using snowflake connection "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"
[0m18:30:27.001665 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.agg_regional_risk
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m18:30:27.002025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:27.015168 [info ] [Thread-1 (]: 13 of 18 PASS source_not_null_raw_raw_earthquakes_event_id ..................... [[32mPASS[0m in 0.80s]
[0m18:30:27.015995 [info ] [Thread-4 (]: 14 of 18 PASS source_unique_raw_raw_earthquakes_event_id ....................... [[32mPASS[0m in 0.76s]
[0m18:30:27.016557 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f
[0m18:30:27.017106 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6
[0m18:30:27.017540 [debug] [Thread-1 (]: Began running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:30:27.017971 [debug] [Thread-4 (]: Began running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:30:27.018349 [info ] [Thread-1 (]: 17 of 18 START test unique_fct_earthquakes_event_id ............................ [RUN]
[0m18:30:27.018795 [info ] [Thread-4 (]: 18 of 18 START test unique_stg_earthquakes_event_id ............................ [RUN]
[0m18:30:27.019207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_not_null_raw_raw_earthquakes_event_id.9940e75f3f, now test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee)
[0m18:30:27.019593 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.earthquake_analytics.source_unique_raw_raw_earthquakes_event_id.5493c4ede6, now test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33)
[0m18:30:27.019959 [debug] [Thread-1 (]: Began compiling node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:30:27.020315 [debug] [Thread-4 (]: Began compiling node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:30:27.023670 [debug] [Thread-1 (]: Writing injected SQL for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:30:27.026579 [debug] [Thread-4 (]: Writing injected SQL for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:30:27.027601 [debug] [Thread-1 (]: Began executing node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:30:27.027959 [debug] [Thread-4 (]: Began executing node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:30:27.029785 [debug] [Thread-1 (]: Writing runtime sql for node "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:30:27.031481 [debug] [Thread-4 (]: Writing runtime sql for node "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:30:27.032682 [debug] [Thread-1 (]: Using snowflake connection "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"
[0m18:30:27.033266 [debug] [Thread-4 (]: Using snowflake connection "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"
[0m18:30:27.033594 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.fct_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:30:27.033920 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "earthquake_analytics", "target_name": "dev", "node_id": "test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from USER_DB_PLATYPUS.ANALYTICS.stg_earthquakes
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:30:27.034282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:27.034611 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:27.060048 [info ] [Thread-2 (]: 15 of 18 PASS unique_agg_daily_summary_summary_date ............................ [[32mPASS[0m in 0.73s]
[0m18:30:27.061032 [debug] [Thread-2 (]: Finished running node test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d
[0m18:30:27.643913 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m18:30:27.645694 [debug] [Thread-3 (]: On test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0: Close
[0m18:30:27.681230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m18:30:27.682954 [debug] [Thread-1 (]: On test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee: Close
[0m18:30:27.728421 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m18:30:27.730287 [debug] [Thread-4 (]: On test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33: Close
[0m18:30:27.833304 [info ] [Thread-3 (]: 16 of 18 PASS unique_agg_regional_risk_region .................................. [[32mPASS[0m in 0.84s]
[0m18:30:27.834881 [debug] [Thread-3 (]: Finished running node test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0
[0m18:30:27.857051 [info ] [Thread-1 (]: 17 of 18 PASS unique_fct_earthquakes_event_id .................................. [[32mPASS[0m in 0.84s]
[0m18:30:27.858044 [debug] [Thread-1 (]: Finished running node test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee
[0m18:30:27.950263 [info ] [Thread-4 (]: 18 of 18 PASS unique_stg_earthquakes_event_id .................................. [[32mPASS[0m in 0.93s]
[0m18:30:27.951689 [debug] [Thread-4 (]: Finished running node test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33
[0m18:30:27.954134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:27.954601 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_fct_earthquakes_event_id.f3fbde39ee' was properly closed.
[0m18:30:27.955081 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_daily_summary_summary_date.16a7abb71d' was properly closed.
[0m18:30:27.955472 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_agg_regional_risk_region.8c24a212e0' was properly closed.
[0m18:30:27.955934 [debug] [MainThread]: Connection 'test.earthquake_analytics.unique_stg_earthquakes_event_id.e354e03f33' was properly closed.
[0m18:30:27.956513 [info ] [MainThread]: 
[0m18:30:27.957191 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m18:30:27.960010 [debug] [MainThread]: Command end result
[0m18:30:28.034861 [info ] [MainThread]: 
[0m18:30:28.035715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:28.036021 [info ] [MainThread]: 
[0m18:30:28.036384 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:30:28.037489 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.530507, "process_user_time": 4.102613, "process_kernel_time": 1.943501, "process_mem_max_rss": "268848", "process_out_blocks": "2223", "process_in_blocks": "0"}
[0m18:30:28.037929 [debug] [MainThread]: Command `dbt test` succeeded at 18:30:28.037850 after 6.53 seconds
[0m18:30:28.038265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffec03080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd850d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe0455850>]}
[0m18:30:28.038571 [debug] [MainThread]: Flushing usage events
