-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary as DBT_INTERNAL_DEST
        using USER_DB_PLATYPUS.ANALYTICS.agg_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.summary_date = DBT_INTERNAL_DEST.summary_date
            )

    
    when matched then update set
        "SUMMARY_DATE" = DBT_INTERNAL_SOURCE."SUMMARY_DATE","TOTAL_EARTHQUAKES" = DBT_INTERNAL_SOURCE."TOTAL_EARTHQUAKES","SIGNIFICANT_EARTHQUAKES" = DBT_INTERNAL_SOURCE."SIGNIFICANT_EARTHQUAKES","STRONG_EARTHQUAKES" = DBT_INTERNAL_SOURCE."STRONG_EARTHQUAKES","TSUNAMI_WARNINGS" = DBT_INTERNAL_SOURCE."TSUNAMI_WARNINGS","AVG_MAGNITUDE" = DBT_INTERNAL_SOURCE."AVG_MAGNITUDE","MAX_MAGNITUDE" = DBT_INTERNAL_SOURCE."MAX_MAGNITUDE","MIN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MIN_MAGNITUDE","STDDEV_MAGNITUDE" = DBT_INTERNAL_SOURCE."STDDEV_MAGNITUDE","MEDIAN_MAGNITUDE" = DBT_INTERNAL_SOURCE."MEDIAN_MAGNITUDE","AVG_DEPTH_KM" = DBT_INTERNAL_SOURCE."AVG_DEPTH_KM","MAX_DEPTH_KM" = DBT_INTERNAL_SOURCE."MAX_DEPTH_KM","TOTAL_FELT_REPORTS" = DBT_INTERNAL_SOURCE."TOTAL_FELT_REPORTS","AVG_SIGNIFICANCE" = DBT_INTERNAL_SOURCE."AVG_SIGNIFICANCE","MICRO_COUNT" = DBT_INTERNAL_SOURCE."MICRO_COUNT","MINOR_COUNT" = DBT_INTERNAL_SOURCE."MINOR_COUNT","LIGHT_COUNT" = DBT_INTERNAL_SOURCE."LIGHT_COUNT","MODERATE_COUNT" = DBT_INTERNAL_SOURCE."MODERATE_COUNT","STRONG_COUNT" = DBT_INTERNAL_SOURCE."STRONG_COUNT","MAJOR_COUNT" = DBT_INTERNAL_SOURCE."MAJOR_COUNT","GREAT_COUNT" = DBT_INTERNAL_SOURCE."GREAT_COUNT","SHALLOW_COUNT" = DBT_INTERNAL_SOURCE."SHALLOW_COUNT","INTERMEDIATE_COUNT" = DBT_INTERNAL_SOURCE."INTERMEDIATE_COUNT","DEEP_COUNT" = DBT_INTERNAL_SOURCE."DEEP_COUNT","AVG_STATION_COUNT" = DBT_INTERNAL_SOURCE."AVG_STATION_COUNT","REVIEWED_COUNT" = DBT_INTERNAL_SOURCE."REVIEWED_COUNT","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")
    values
        ("SUMMARY_DATE", "TOTAL_EARTHQUAKES", "SIGNIFICANT_EARTHQUAKES", "STRONG_EARTHQUAKES", "TSUNAMI_WARNINGS", "AVG_MAGNITUDE", "MAX_MAGNITUDE", "MIN_MAGNITUDE", "STDDEV_MAGNITUDE", "MEDIAN_MAGNITUDE", "AVG_DEPTH_KM", "MAX_DEPTH_KM", "TOTAL_FELT_REPORTS", "AVG_SIGNIFICANCE", "MICRO_COUNT", "MINOR_COUNT", "LIGHT_COUNT", "MODERATE_COUNT", "STRONG_COUNT", "MAJOR_COUNT", "GREAT_COUNT", "SHALLOW_COUNT", "INTERMEDIATE_COUNT", "DEEP_COUNT", "AVG_STATION_COUNT", "REVIEWED_COUNT", "DBT_UPDATED_AT")

;
    commit;